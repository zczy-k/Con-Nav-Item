import{S as N}from"./Home-DDSSl9LD.js";import{_ as w,r as z,w as k,o as O,n as g,a as R,c,b as u,F as D,e as E,z as U,g as h,f as o,d as j,t as A}from"./index-NOITFrC_.js";import"./urlNormalizer-CnUIJWmn.js";const B=["data-card-id"],G=["href","target","title"],F=["src","onError"],L={class:"link-text"},V={key:0,class:"card-btns"},J=["checked","onClick"],T=["onClick"],P=["onClick"],q={__name:"CardGrid",props:{cards:Array,editMode:Boolean,selectedCards:Array,categoryId:Number,subCategoryId:[Number,null]},emits:["cardsReordered","editCard","deleteCard","toggleCardSelection"],setup(a,{emit:y}){const i=a,v=y,m=z(null);let l=null;function b(){if(!i.editMode||l)return;const e=m.value;e&&(l=new N(e,{animation:150,group:"cards",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",handle:".drag-handle",filter:".card-btn, .card-checkbox",preventOnFilter:!1,onEnd:t=>{const r=t.to,d=Array.from(r.children).map(n=>parseInt(n.getAttribute("data-card-id"))).filter(n=>!isNaN(n));v("cardsReordered",d,i.categoryId,i.subCategoryId)}}))}function f(){l&&(l.destroy(),l=null)}k(()=>i.editMode,e=>{e?g(()=>b()):f()}),O(()=>{i.editMode&&g(()=>b())}),R(()=>{f()}),k(()=>i.cards,(e,t)=>{e&&e.length>0&&(!t||t.length===0||JSON.stringify(e)!==JSON.stringify(t))&&g(()=>{i.editMode&&(f(),g(()=>b()))})},{deep:!0,immediate:!1});function x(e){return{background:C[e%C.length]}}function p(e){try{return new URL(e).origin}catch(t){return null}}function S(e){if(e.logo_url)return e.logo_url;const t=p(e.url);return t?`https://api.xinac.net/icon/?url=${t}&sz=128`:"/default-favicon.png"}const s=[e=>`https://api.xinac.net/icon/?url=${e}&sz=128`,e=>`https://api.afmax.cn/so/ico/index.php?r=${e}&sz=128`,e=>`https://icon.horse/icon/${e}`,e=>`https://www.google.com/s2/favicons?domain=${e}&sz=128`,e=>`https://favicon.im/${e}?larger=true`];function _(e,t){const r=e.target.src,d=p(t.url);if(!d){e.target.src="/default-favicon.png";return}e.target._cdnIndex===void 0&&(e.target._cdnIndex=0);for(let n=0;n<s.length;n++)if(s[n](d),r.includes("api.xinac.net")&&n===0||r.includes("api.afmax.cn")&&n===1||r.includes("icon.horse")&&n===2||r.includes("www.google.com/s2/favicons")&&n===3||r.includes("favicon.im")&&n===4){if(n+1<s.length){e.target._cdnIndex=n+1,e.target.src=s[n+1](d);return}break}e.target.src="/default-favicon.png"}function I(e){let t="";return e.desc&&(t+=e.desc+`
`),e.tags&&e.tags.length>0&&(t+="æ ‡ç­¾: "+e.tags.map(r=>r.name).join(", ")+`
`),t+=e.url,t}function M(e){return e?e.length>20?e.slice(0,20)+"...":e:""}function $(e){var t;return((t=i.selectedCards)==null?void 0:t.some(r=>r.id===e.id))||!1}const C=["linear-gradient(135deg, rgba(102, 126, 234, 0.45) 0%, rgba(118, 75, 162, 0.45) 100%)","linear-gradient(135deg, rgba(240, 147, 251, 0.45) 0%, rgba(245, 87, 108, 0.45) 100%)","linear-gradient(135deg, rgba(79, 172, 254, 0.45) 0%, rgba(0, 242, 254, 0.45) 100%)","linear-gradient(135deg, rgba(67, 233, 123, 0.45) 0%, rgba(56, 249, 215, 0.45) 100%)","linear-gradient(135deg, rgba(250, 112, 154, 0.45) 0%, rgba(254, 225, 64, 0.45) 100%)","linear-gradient(135deg, rgba(48, 207, 208, 0.45) 0%, rgba(51, 8, 103, 0.45) 100%)","linear-gradient(135deg, rgba(168, 237, 234, 0.45) 0%, rgba(254, 214, 227, 0.45) 100%)","linear-gradient(135deg, rgba(255, 154, 158, 0.45) 0%, rgba(254, 207, 239, 0.45) 100%)","linear-gradient(135deg, rgba(255, 236, 210, 0.45) 0%, rgba(252, 182, 159, 0.45) 100%)","linear-gradient(135deg, rgba(255, 110, 127, 0.45) 0%, rgba(191, 233, 255, 0.45) 100%)","linear-gradient(135deg, rgba(224, 195, 252, 0.45) 0%, rgba(142, 197, 252, 0.45) 100%)","linear-gradient(135deg, rgba(248, 177, 149, 0.45) 0%, rgba(246, 114, 128, 0.45) 100%)","linear-gradient(135deg, rgba(210, 153, 194, 0.45) 0%, rgba(254, 249, 215, 0.45) 100%)","linear-gradient(135deg, rgba(253, 219, 146, 0.45) 0%, rgba(209, 253, 255, 0.45) 100%)","linear-gradient(135deg, rgba(152, 144, 227, 0.45) 0%, rgba(177, 244, 207, 0.45) 100%)","linear-gradient(135deg, rgba(235, 192, 253, 0.45) 0%, rgba(217, 222, 216, 0.45) 100%)","linear-gradient(135deg, rgba(150, 251, 196, 0.45) 0%, rgba(249, 245, 134, 0.45) 100%)","linear-gradient(135deg, rgba(253, 160, 133, 0.45) 0%, rgba(246, 211, 101, 0.45) 100%)"];return(e,t)=>(u(),c("div",{ref_key:"cardGridRef",ref:m,class:h(["container card-grid",{"edit-mode":a.editMode}])},[(u(!0),c(D,null,E(a.cards,(r,d)=>(u(),c("div",{key:r.id,class:h(["link-item",{draggable:a.editMode}]),"data-card-id":r.id,style:U(x(d))},[o("a",{href:a.editMode?"javascript:void(0)":r.url,target:a.editMode?"":"_blank",title:I(r),onClick:t[0]||(t[0]=n=>a.editMode?n.preventDefault():null),class:h({"drag-handle":a.editMode})},[o("img",{class:"link-icon",src:S(r),alt:"",onError:n=>_(n,r),loading:"lazy"},null,40,F),o("span",L,A(M(r.title)),1)],10,G),a.editMode?(u(),c("div",V,[o("input",{type:"checkbox",class:"card-checkbox",checked:$(r),onClick:n=>e.$emit("toggleCardSelection",r),title:"é€‰ä¸­"},null,8,J),o("button",{onClick:n=>e.$emit("editCard",r),class:"card-btn edit-btn",title:"ç¼–è¾‘"},"âœï¸",8,T),o("button",{onClick:n=>e.$emit("deleteCard",r),class:"card-btn del-btn",title:"åˆ é™¤"},"ğŸ—‘ï¸",8,P)])):j("",!0)],14,B))),128))],2))}},W=w(q,[["__scopeId","data-v-41e50b2a"]]);export{W as default};
