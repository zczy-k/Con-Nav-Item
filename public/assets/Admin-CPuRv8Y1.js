var Ue=Object.defineProperty,Ae=Object.defineProperties;var De=Object.getOwnPropertyDescriptors;var ke=Object.getOwnPropertySymbols;var Se=Object.prototype.hasOwnProperty,Te=Object.prototype.propertyIsEnumerable;var ye=(L,o,g)=>o in L?Ue(L,o,{enumerable:!0,configurable:!0,writable:!0,value:g}):L[o]=g,se=(L,o)=>{for(var g in o||(o={}))Se.call(o,g)&&ye(L,g,o[g]);if(ke)for(var g of ke(o))Te.call(o,g)&&ye(L,g,o[g]);return L},ue=(L,o)=>Ae(L,De(o));var C=(L,o,g)=>new Promise(($,M)=>{var A=i=>{try{B(g.next(i))}catch(v){M(v)}},D=i=>{try{B(g.throw(i))}catch(v){M(v)}},B=i=>i.done?$(i.value):Promise.resolve(i.value).then(A,D);B((g=g.apply(L,o)).next())});import{_ as q,c,o as u,b as e,t as h,z as le,r as w,g as Q,w as _,v as U,q as N,F as H,a as O,n as z,e as ce,A as _e,d as W,B as he,x as we,j as ve,C as Z,y as ge,p as ee,l as $e,D as Ie,i as Le,k as We,T as Ne,E as ze,G as Pe,H as He}from"./index-tM3rW0L1.js";import{g as Me,q as Oe,r as Fe,s as Re,t as je,w as Ee,x as qe,c as Ve,i as Je,u as Ce,n as xe,e as Ge,y as Ke,z as Qe,A as fe,B as Xe,C as Ye,D as Ze,E as et,a as tt,F as st,G as lt,H as at,b as ot,I as nt,J as it,K as dt,L as rt,M as ut,N as ct,O as vt}from"./urlNormalizer-DhXlwbMD.js";const pt={class:"welcome-page"},mt={class:"welcome-title"},bt={class:"welcome-cards"},gt={class:"welcome-card"},ft={class:"welcome-value"},ht={class:"welcome-card"},wt={class:"welcome-value"},kt={__name:"WelcomePage",props:{lastLoginTime:String,lastLoginIp:String,currentUsername:String},setup(L){return(o,g)=>(u(),c("div",pt,[e("h2",mt,"æ¬¢è¿æ‚¨ï¼Œ"+h(L.currentUsername||"admin")+"ï¼",1),e("div",bt,[e("div",gt,[g[0]||(g[0]=le('<div class="welcome-icon time-icon" data-v-5cc4f846><svg width="32" height="32" viewBox="0 0 24 24" fill="none" data-v-5cc4f846><circle cx="12" cy="12" r="10" stroke="#1abc9c" stroke-width="2" data-v-5cc4f846></circle><path d="M12 6v6l4 2" stroke="#1abc9c" stroke-width="2" stroke-linecap="round" data-v-5cc4f846></path></svg></div><div class="welcome-label" data-v-5cc4f846>ä¸Šæ¬¡ç™»å½•æ—¶é—´</div>',2)),e("div",ft,h(L.lastLoginTime||"--"),1)]),e("div",ht,[g[1]||(g[1]=le('<div class="welcome-icon ip-icon" data-v-5cc4f846><svg width="32" height="32" viewBox="0 0 24 24" fill="none" data-v-5cc4f846><circle cx="12" cy="12" r="10" stroke="#1abc9c" stroke-width="2" data-v-5cc4f846></circle><path d="M12 8a4 4 0 1 1 0 8 4 4 0 0 1 0-8z" stroke="#1abc9c" stroke-width="2" data-v-5cc4f846></path><circle cx="12" cy="12" r="2" fill="#1abc9c" data-v-5cc4f846></circle></svg></div><div class="welcome-label" data-v-5cc4f846>ä¸Šæ¬¡ç™»å½•IP</div>',2)),e("div",wt,h(L.lastLoginIp||"--"),1)])])]))}},yt=q(kt,[["__scopeId","data-v-5cc4f846"]]),_t={class:"menu-manage"},$t={class:"menu-header"},Ct={class:"menu-add"},xt={class:"menu-content"},Mt={class:"menu-list"},Vt={class:"main-menu"},Bt={class:"menu-info"},Ut=["onUpdate:modelValue","onBlur"],At={class:"menu-order"},Dt=["onUpdate:modelValue","onBlur"],St={class:"menu-actions"},Tt=["onClick","title"],It=["onClick"],Lt={class:"sub-menu-header"},Wt={class:"sub-menu-title"},Nt=["onClick"],zt={key:0,class:"sub-menu-list"},Pt={class:"sub-menu-info"},Ht=["onUpdate:modelValue","onBlur"],Ot={class:"sub-menu-order"},Ft=["onUpdate:modelValue","onBlur"],Rt={class:"sub-menu-actions"},jt=["onClick"],Et={key:1,class:"empty-sub-menu"},qt=["onClick"],Jt={__name:"MenuManage",setup(L){const o=w([]),g=w("");Q($);function $(){return C(this,null,function*(){const a=yield Me();o.value=a.data.map(s=>ue(se({},s),{subMenus:s.subMenus||[],showSubMenu:!1}))})}function M(){return C(this,null,function*(){if(!g.value.trim())return;const a=o.value.length?Math.max(...o.value.map(s=>s.order||0)):0;yield Oe({name:g.value.trim(),order:a+1}),g.value="",$()})}function A(a){return C(this,null,function*(){var s,l;try{yield Fe(a.id,{name:a.name,order:a.order})}catch(d){console.error("æ›´æ–°èœå•å¤±è´¥:",d),alert("ä¿å­˜å¤±è´¥ï¼š"+(((l=(s=d.response)==null?void 0:s.data)==null?void 0:l.error)||d.message)),yield $()}})}function D(a){return C(this,null,function*(){if(!confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªä¸»èœå•å—ï¼Ÿåˆ é™¤åå°†åŒæ—¶åˆ é™¤å…¶ä¸‹çš„æ‰€æœ‰å­èœå•å’Œå¡ç‰‡ã€‚"))return;const s=o.value.findIndex(l=>l.id===a);s>-1&&o.value.splice(s,1);try{yield Re(a)}catch(l){console.error("åˆ é™¤èœå•å¤±è´¥:",l),yield $()}})}function B(a){return C(this,null,function*(){const s=o.value.find(y=>y.id===a),l=prompt("è¯·è¾“å…¥å­èœå•åç§°ï¼š");if(!(l!=null&&l.trim()))return;const d=(s==null?void 0:s.subMenus)||[],p=d.length?Math.max(...d.map(y=>y.order||0)):0;yield je(a,{name:l.trim(),order:p+1}),$()})}function i(a){return C(this,null,function*(){var s,l;try{yield Ee(a.id,{name:a.name,order:a.order})}catch(d){console.error("æ›´æ–°å­èœå•å¤±è´¥:",d),alert("ä¿å­˜å¤±è´¥ï¼š"+(((l=(s=d.response)==null?void 0:s.data)==null?void 0:l.error)||d.message)),yield $()}})}function v(a){return C(this,null,function*(){var s,l;if(confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå­èœå•å—ï¼Ÿåˆ é™¤åå°†åŒæ—¶åˆ é™¤å…¶ä¸‹çš„æ‰€æœ‰å¡ç‰‡ã€‚"))try{yield qe(a),yield $()}catch(d){console.error("åˆ é™¤å­èœå•å¤±è´¥:",d),alert("åˆ é™¤å¤±è´¥ï¼š"+(((l=(s=d.response)==null?void 0:s.data)==null?void 0:l.error)||d.message))}})}function n(a){const s=o.value.find(l=>l.id===a);s&&(s.showSubMenu=!s.showSubMenu)}return(a,s)=>(u(),c("div",_t,[e("div",$t,[s[2]||(s[2]=e("div",{class:"header-content"},[e("h2",{class:"page-title"},"ç®¡ç†ä¸»èœå•å’Œå­èœå•")],-1)),e("div",Ct,[_(e("input",{"onUpdate:modelValue":s[0]||(s[0]=l=>g.value=l),placeholder:"è¯·è¾“å…¥ä¸»èœå•åç§°",class:"input"},null,512),[[U,g.value]]),e("button",{class:"btn btn-primary",onClick:M},[...s[1]||(s[1]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),N(" æ·»åŠ ä¸»èœå• ",-1)])])])]),e("div",xt,[e("div",Mt,[(u(!0),c(H,null,O(o.value,l=>{var d;return u(),c("div",{key:l.id,class:"menu-item"},[e("div",Vt,[e("div",Bt,[s[4]||(s[4]=e("div",{class:"menu-icon"},[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 3h18v18H3zM9 9h6v6H9z"})])],-1)),_(e("input",{"onUpdate:modelValue":p=>l.name=p,onBlur:p=>A(l),class:"menu-name-input"},null,40,Ut),[[U,l.name]]),e("div",At,[s[3]||(s[3]=e("span",{class:"order-label"},"æ’åº",-1)),_(e("input",{"onUpdate:modelValue":p=>l.order=p,type:"number",onBlur:p=>A(l),class:"order-input"},null,40,Dt),[[U,l.order,void 0,{number:!0}]])])]),e("div",St,[e("button",{class:"btn btn-icon expand-btn",onClick:p=>n(l.id),title:l.showSubMenu?"æ”¶èµ·å­èœå•":"å±•å¼€å­èœå•"},[...s[5]||(s[5]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"m6 9 6 6 6-6"})],-1)])],8,Tt),e("button",{class:"btn btn-danger btn-icon",onClick:p=>D(l.id),title:"åˆ é™¤ä¸»èœå•"},[...s[6]||(s[6]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)])],8,It)])]),e("div",{class:z(["sub-menu-section",{expanded:l.showSubMenu}])},[e("div",Lt,[e("div",Wt,[s[7]||(s[7]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 11H1l8-8 8 8h-8v8z"})],-1)),N(" å­èœå• ("+h(((d=l.subMenus)==null?void 0:d.length)||0)+") ",1)]),e("button",{class:"btn btn-sm btn-outline",onClick:p=>B(l.id)},[...s[8]||(s[8]=[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),N(" æ·»åŠ å­èœå• ",-1)])],8,Nt)]),l.subMenus&&l.subMenus.length>0?(u(),c("div",zt,[(u(!0),c(H,null,O(l.subMenus,p=>(u(),c("div",{key:p.id,class:"sub-menu-item"},[e("div",Pt,[s[9]||(s[9]=e("div",{class:"sub-menu-icon"},[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M4 6h16M4 12h16M4 18h16"})])],-1)),_(e("input",{"onUpdate:modelValue":y=>p.name=y,onBlur:y=>i(p),class:"sub-menu-name-input"},null,40,Ht),[[U,p.name]]),e("div",Ot,[_(e("input",{"onUpdate:modelValue":y=>p.order=y,type:"number",onBlur:y=>i(p),class:"order-input"},null,40,Ft),[[U,p.order,void 0,{number:!0}]])])]),e("div",Rt,[e("button",{class:"btn btn-danger btn-icon btn-sm",onClick:y=>v(p.id),title:"åˆ é™¤å­èœå•"},[...s[10]||(s[10]=[e("svg",{width:"14",height:"14",viewBox:"0 0 22 22",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)])],8,jt)])]))),128))])):(u(),c("div",Et,[s[11]||(s[11]=e("p",null,"æš‚æ— å­èœå•",-1)),e("button",{class:"btn btn-sm btn-outline",onClick:p=>B(l.id)},"æ·»åŠ ç¬¬ä¸€ä¸ªå­èœå•",8,qt)]))],2)])}),128))])])]))}},Gt=q(Jt,[["__scopeId","data-v-0b51f118"]]),Kt={class:"card-manage"},Qt={class:"card-header"},Xt={class:"card-add"},Yt=["value"],Zt=["value"],es={class:"card-card"},ts={class:"card-table"},ss=["onUpdate:modelValue","onBlur"],ls=["onUpdate:modelValue","onBlur"],as=["onUpdate:modelValue","onBlur"],os=["onUpdate:modelValue","onBlur"],ns=["onClick"],is={key:0,class:"selected-tags"},ds={key:1,class:"tag-placeholder"},rs=["onUpdate:modelValue","onBlur"],us=["onClick"],cs={class:"modal-body"},vs={key:0,class:"empty-tags"},ps={key:1,class:"tag-options"},ms=["checked","onChange"],bs={class:"modal-body"},gs={class:"duplicate-comparison"},fs={class:"card-info-box existing"},hs={class:"card-details"},ws={class:"detail-row"},ks={class:"detail-value"},ys={class:"detail-row"},_s={class:"detail-value url"},$s={key:0,class:"detail-row"},Cs={class:"detail-value url"},xs={class:"card-info-box pending"},Ms={class:"card-details"},Vs={class:"detail-row"},Bs={class:"detail-value"},Us={class:"detail-row"},As={class:"detail-value url"},Ds={key:0,class:"detail-row"},Ss={class:"detail-value url"},Ts={__name:"CardManage",setup(L){const o=w([]),g=w([]),$=w(),M=w(""),A=w(""),D=w(""),B=w(""),i=w([]),v=w(!1),n=w(null),a=w([]),s=w(!1),l=w(null),d=w(null),p=ce(()=>{if(!$.value)return[];const T=o.value.find(m=>m.id===$.value);return(T==null?void 0:T.subMenus)||[]});Q(()=>C(null,null,function*(){const T=yield Me();o.value=T.data,o.value.length&&($.value=o.value[0].id,M.value="");const m=yield Ve();i.value=m.data})),_e($,()=>{M.value="",f()}),_e(M,f);function y(){M.value=""}function S(){f()}function f(){return C(this,null,function*(){if(!$.value)return;const T=yield Ge($.value,M.value||null);g.value=T.data})}function k(){return C(this,null,function*(){if(!A.value||!D.value)return;const T=g.value.find(m=>Je({title:A.value,url:D.value},m));T?(l.value=T,d.value={menu_id:$.value,sub_menu_id:M.value||null,title:A.value,url:D.value,logo_url:B.value},s.value=!0):yield X({menu_id:$.value,sub_menu_id:M.value||null,title:A.value,url:D.value,logo_url:B.value})})}function J(T){return C(this,null,function*(){yield Ce(T.id,{menu_id:$.value,sub_menu_id:M.value||null,title:T.title,url:T.url,logo_url:T.logo_url,desc:T.desc,order:T.order,tagIds:T.tags?T.tags.map(m=>m.id):[]}),f()})}function F(T){return C(this,null,function*(){if(!confirm("ç¡®å®šè¦åˆ é™¤è¿™å¼ å¡ç‰‡å—ï¼Ÿ"))return;const m=g.value.findIndex(K=>K.id===T);m>-1&&g.value.splice(m,1);try{yield xe(T)}catch(K){console.error("åˆ é™¤å¡ç‰‡å¤±è´¥:",K),yield f()}})}function R(T){n.value=T,a.value=T.tags?T.tags.map(m=>m.id):[],v.value=!0}function x(){v.value=!1,n.value=null,a.value=[]}function I(T){const m=a.value.indexOf(T);m>-1?a.value.splice(m,1):a.value.push(T)}function pe(){return C(this,null,function*(){n.value&&(yield Ce(n.value.id,{menu_id:n.value.menu_id,sub_menu_id:n.value.sub_menu_id,title:n.value.title,url:n.value.url,logo_url:n.value.logo_url,desc:n.value.desc,order:n.value.order,tagIds:a.value}),x(),f())})}function X(T){return C(this,null,function*(){yield Ke(T),A.value="",D.value="",B.value="",f()})}function Y(){s.value=!1,l.value=null,d.value=null}function te(){Y(),A.value="",D.value="",B.value=""}function me(){return C(this,null,function*(){!d.value||!l.value||(yield xe(l.value.id),yield X(d.value),Y())})}function be(){d.value&&(A.value=d.value.title,D.value=d.value.url,B.value=d.value.logo_url||"",Y(),alert("è¯·ä¿®æ”¹å¡ç‰‡ä¿¡æ¯åå†æ¬¡ç‚¹å‡»â€œæ·»åŠ å¡ç‰‡â€æŒ‰é’®"))}return(T,m)=>{var K,ae,oe,E,ne,ie,G,de;return u(),c("div",Kt,[e("div",Qt,[m[9]||(m[9]=e("div",{class:"header-content"},[e("h2",{class:"page-title"},"ç®¡ç†ç½‘ç«™å¯¼èˆªå¡ç‰‡ï¼Œæ”¯æŒä¸»èœå•å’Œå­èœå•åˆ†ç±»")],-1)),e("div",Xt,[_(e("select",{"onUpdate:modelValue":m[0]||(m[0]=V=>$.value=V),class:"input narrow",onChange:y},[(u(!0),c(H,null,O(o.value,V=>(u(),c("option",{value:V.id,key:V.id},h(V.name),9,Yt))),128))],544),[[he,$.value]]),_(e("select",{"onUpdate:modelValue":m[1]||(m[1]=V=>M.value=V),class:"input narrow",onChange:S},[m[7]||(m[7]=e("option",{value:""},"ä¸»èœå•",-1)),(u(!0),c(H,null,O(p.value,V=>(u(),c("option",{value:V.id,key:V.id},h(V.name),9,Zt))),128))],544),[[he,M.value]]),_(e("input",{"onUpdate:modelValue":m[2]||(m[2]=V=>A.value=V),placeholder:"å¡ç‰‡æ ‡é¢˜",class:"input narrow"},null,512),[[U,A.value]]),_(e("input",{"onUpdate:modelValue":m[3]||(m[3]=V=>D.value=V),placeholder:"å¡ç‰‡é“¾æ¥",class:"input wide"},null,512),[[U,D.value]]),_(e("input",{"onUpdate:modelValue":m[4]||(m[4]=V=>B.value=V),placeholder:"logoé“¾æ¥(å¯é€‰)",class:"input wide"},null,512),[[U,B.value]]),e("button",{class:"btn",onClick:k},[...m[8]||(m[8]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),N(" æ·»åŠ å¡ç‰‡ ",-1)])])])]),e("div",es,[e("table",ts,[m[11]||(m[11]=e("thead",null,[e("tr",null,[e("th",null,"æ ‡é¢˜"),e("th",null,"ç½‘å€"),e("th",null,"Logoé“¾æ¥"),e("th",null,"æè¿°"),e("th",null,"æ ‡ç­¾"),e("th",null,"æ’åº"),e("th",null,"æ“ä½œ")])],-1)),e("tbody",null,[(u(!0),c(H,null,O(g.value,V=>(u(),c("tr",{key:V.id},[e("td",null,[_(e("input",{"onUpdate:modelValue":r=>V.title=r,onBlur:r=>J(V),class:"table-input"},null,40,ss),[[U,V.title]])]),e("td",null,[_(e("input",{"onUpdate:modelValue":r=>V.url=r,onBlur:r=>J(V),class:"table-input"},null,40,ls),[[U,V.url]])]),e("td",null,[_(e("input",{"onUpdate:modelValue":r=>V.logo_url=r,onBlur:r=>J(V),class:"table-input",placeholder:"logoé“¾æ¥(å¯é€‰)"},null,40,as),[[U,V.logo_url]])]),e("td",null,[_(e("input",{"onUpdate:modelValue":r=>V.desc=r,onBlur:r=>J(V),class:"table-input",placeholder:"æè¿°ï¼ˆå¯é€‰ï¼‰"},null,40,os),[[U,V.desc]])]),e("td",null,[e("div",{class:"tag-selector",onClick:r=>R(V)},[V.tags&&V.tags.length>0?(u(),c("div",is,[(u(!0),c(H,null,O(V.tags,r=>(u(),c("span",{key:r.id,class:"mini-tag",style:we({backgroundColor:r.color})},h(r.name),5))),128))])):(u(),c("span",ds,"é€‰æ‹©æ ‡ç­¾"))],8,ns)]),e("td",null,[_(e("input",{"onUpdate:modelValue":r=>V.order=r,type:"number",onBlur:r=>J(V),class:"table-input order-input"},null,40,rs),[[U,V.order,void 0,{number:!0}]])]),e("td",null,[e("button",{class:"btn btn-danger btn-icon",onClick:r=>F(V.id),title:"åˆ é™¤"},[...m[10]||(m[10]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)])],8,us)])]))),128))])])]),v.value?(u(),c("div",{key:0,class:"modal-overlay",onClick:x},[e("div",{class:"modal-content",onClick:m[5]||(m[5]=ve(()=>{},["stop"]))},[e("div",{class:"modal-header"},[m[12]||(m[12]=e("h3",null,"é€‰æ‹©æ ‡ç­¾",-1)),e("button",{class:"close-btn",onClick:x},"Ã—")]),e("div",cs,[i.value.length===0?(u(),c("div",vs,[...m[13]||(m[13]=[e("p",null,"æš‚æ— æ ‡ç­¾ï¼Œè¯·å…ˆåœ¨æ ‡ç­¾ç®¡ç†é¡µé¢åˆ›å»º",-1)])])):(u(),c("div",ps,[(u(!0),c(H,null,O(i.value,V=>(u(),c("label",{key:V.id,class:"tag-option"},[e("input",{type:"checkbox",checked:a.value.includes(V.id),onChange:r=>I(V.id)},null,40,ms),e("span",{class:"tag-label",style:we({backgroundColor:V.color})},h(V.name),5)]))),128))]))]),e("div",{class:"modal-footer"},[e("button",{class:"btn btn-secondary",onClick:x},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:pe},"ç¡®å®š")])])])):W("",!0),s.value?(u(),c("div",{key:1,class:"modal-overlay",onClick:Y},[e("div",{class:"modal-content duplicate-modal",onClick:m[6]||(m[6]=ve(()=>{},["stop"]))},[e("div",{class:"modal-header"},[m[14]||(m[14]=le('<div class="header-with-icon" data-v-edd548d5><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#dc2626" stroke-width="2" data-v-edd548d5><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z" data-v-edd548d5></path><line x1="12" y1="9" x2="12" y2="13" data-v-edd548d5></line><line x1="12" y1="17" x2="12.01" y2="17" data-v-edd548d5></line></svg><h3 data-v-edd548d5>æ£€æµ‹åˆ°é‡å¤å¡ç‰‡</h3></div>',1)),e("button",{class:"close-btn",onClick:Y},"Ã—")]),e("div",bs,[m[24]||(m[24]=e("div",{class:"duplicate-warning"},[e("p",{class:"warning-text"},"æ‚¨è¦æ·»åŠ çš„å¡ç‰‡ä¸ä»¥ä¸‹ç°æœ‰å¡ç‰‡é‡å¤ï¼š")],-1)),e("div",gs,[e("div",fs,[m[18]||(m[18]=e("div",{class:"box-header"},[e("span",{class:"box-label"},"ç°æœ‰å¡ç‰‡")],-1)),e("div",hs,[e("div",ws,[m[15]||(m[15]=e("span",{class:"detail-label"},"æ ‡é¢˜ï¼š",-1)),e("span",ks,h((K=l.value)==null?void 0:K.title),1)]),e("div",ys,[m[16]||(m[16]=e("span",{class:"detail-label"},"ç½‘å€ï¼š",-1)),e("span",_s,h((ae=l.value)==null?void 0:ae.url),1)]),(oe=l.value)!=null&&oe.logo_url?(u(),c("div",$s,[m[17]||(m[17]=e("span",{class:"detail-label"},"Logoï¼š",-1)),e("span",Cs,h((E=l.value)==null?void 0:E.logo_url),1)])):W("",!0)])]),m[23]||(m[23]=e("div",{class:"arrow-divider"},[e("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"#9ca3af","stroke-width":"2"},[e("path",{d:"M5 12h14M12 5l7 7-7 7"})])],-1)),e("div",xs,[m[22]||(m[22]=e("div",{class:"box-header"},[e("span",{class:"box-label"},"å¾…æ·»åŠ å¡ç‰‡")],-1)),e("div",Ms,[e("div",Vs,[m[19]||(m[19]=e("span",{class:"detail-label"},"æ ‡é¢˜ï¼š",-1)),e("span",Bs,h((ne=d.value)==null?void 0:ne.title),1)]),e("div",Us,[m[20]||(m[20]=e("span",{class:"detail-label"},"ç½‘å€ï¼š",-1)),e("span",As,h((ie=d.value)==null?void 0:ie.url),1)]),(G=d.value)!=null&&G.logo_url?(u(),c("div",Ds,[m[21]||(m[21]=e("span",{class:"detail-label"},"Logoï¼š",-1)),e("span",Ss,h((de=d.value)==null?void 0:de.logo_url),1)])):W("",!0)])])]),m[25]||(m[25]=e("div",{class:"duplicate-actions-info"},[e("p",null,"è¯·é€‰æ‹©å¦‚ä½•å¤„ç†ï¼š")],-1))]),e("div",{class:"modal-footer duplicate-footer"},[e("button",{class:"btn btn-secondary",onClick:te},[...m[26]||(m[26]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M18 6L6 18M6 6l12 12"})],-1),N(" è·³è¿‡ ",-1)])]),e("button",{class:"btn btn-warning",onClick:me},[...m[27]||(m[27]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 12a9 9 0 11-9-9c2.52 0 4.93 1 6.74 2.74L21 8"}),e("path",{d:"M21 3v5h-5"})],-1),N(" æ›¿æ¢ ",-1)])]),e("button",{class:"btn btn-primary",onClick:be},[...m[28]||(m[28]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1),N(" ç¼–è¾‘åæ·»åŠ  ",-1)])])])])])):W("",!0)])}}},Is=q(Ts,[["__scopeId","data-v-edd548d5"]]),Ls={class:"duplicate-manage"},Ws={class:"section-header"},Ns=["disabled"],zs={key:0,class:"duplicate-results"},Ps={class:"result-summary"},Hs={class:"summary-card"},Os={class:"summary-value"},Fs={class:"summary-card warning"},Rs={class:"summary-value"},js={class:"summary-card danger"},Es={class:"summary-value"},qs={class:"duplicate-groups"},Js={class:"group-header"},Gs={class:"group-count"},Ks={class:"card-item original"},Qs={class:"card-info"},Xs={class:"card-title"},Ys={class:"card-url"},Zs={key:0,class:"card-desc"},el={class:"card-id"},tl={class:"duplicates-list"},sl={class:"card-info"},ll={class:"card-title"},al={class:"card-url"},ol={key:0,class:"card-desc"},nl={class:"card-actions"},il={class:"card-id"},dl=["onClick","disabled"],rl={class:"group-actions"},ul=["onClick","disabled"],cl={class:"global-actions"},vl=["disabled"],pl={key:1,class:"no-duplicates"},ml={key:2,class:"initial-hint"},bl={key:3,class:"error"},gl={__name:"DuplicateManage",setup(L){const o=w(!1),g=w(!1),$=w(!1),M=w([]),A=w(0),D=w(0),B=w("");function i(){return C(this,null,function*(){var s,l;o.value=!0,B.value="";try{const d=yield Qe();A.value=d.data.total,M.value=d.data.duplicateGroups,D.value=d.data.duplicateCount,$.value=!0}catch(d){B.value=((l=(s=d.response)==null?void 0:s.data)==null?void 0:l.error)||"æ£€æµ‹å¤±è´¥",console.error("æ£€æµ‹é‡å¤å¤±è´¥:",d)}finally{o.value=!1}})}function v(s){return C(this,null,function*(){var l,d,p;if(confirm("ç¡®å®šè¦åˆ é™¤è¿™å¼ å¡ç‰‡å—ï¼Ÿ")){g.value=!0,B.value="";try{console.log("[å»é‡ç®¡ç†] åˆ é™¤å•ä¸ªå¡ç‰‡:",s);const y=yield fe([s]);console.log("[å»é‡ç®¡ç†] åˆ é™¤å“åº”:",y.data),y.data.success?(console.log("[å»é‡ç®¡ç†] åˆ é™¤æˆåŠŸï¼Œé‡æ–°æ£€æµ‹..."),yield i()):B.value="åˆ é™¤å¤±è´¥ï¼š"+(y.data.message||"æœªçŸ¥é”™è¯¯")}catch(y){console.error("[å»é‡ç®¡ç†] åˆ é™¤å¡ç‰‡å¤±è´¥:",y),console.error("[å»é‡ç®¡ç†] é”™è¯¯è¯¦æƒ…:",(l=y.response)==null?void 0:l.data),B.value=((p=(d=y.response)==null?void 0:d.data)==null?void 0:p.error)||y.message||"åˆ é™¤å¤±è´¥"}finally{g.value=!1}}})}function n(s){return C(this,null,function*(){var d,p,y;const l=s.duplicates.length;if(confirm(`ç¡®å®šè¦åˆ é™¤è¿™ ${l} å¼ é‡å¤å¡ç‰‡å—ï¼Ÿ

å°†ä¿ç•™ï¼š${s.original.title}`)){g.value=!0,B.value="";try{const S=s.duplicates.map(k=>k.id);console.log("[å»é‡ç®¡ç†] åˆ é™¤ä¸€ç»„é‡å¤å¡ç‰‡:",S);const f=yield fe(S);console.log("[å»é‡ç®¡ç†] åˆ é™¤å“åº”:",f.data),f.data.success?(console.log("[å»é‡ç®¡ç†] åˆ é™¤æˆåŠŸï¼Œé‡æ–°æ£€æµ‹..."),yield i()):B.value="åˆ é™¤å¤±è´¥ï¼š"+(f.data.message||"æœªçŸ¥é”™è¯¯")}catch(S){console.error("[å»é‡ç®¡ç†] åˆ é™¤é‡å¤å¡ç‰‡å¤±è´¥:",S),console.error("[å»é‡ç®¡ç†] é”™è¯¯è¯¦æƒ…:",(d=S.response)==null?void 0:d.data),B.value=((y=(p=S.response)==null?void 0:p.data)==null?void 0:y.error)||S.message||"åˆ é™¤å¤±è´¥"}finally{g.value=!1}}})}function a(){return C(this,null,function*(){var l,d,p;const s=D.value;if(confirm(`ç¡®å®šè¦åˆ é™¤æ‰€æœ‰ ${s} å¼ é‡å¤å¡ç‰‡å—ï¼Ÿ

æ­¤æ“ä½œä¸å¯æ’¤é”€ï¼`)){g.value=!0,B.value="";try{const y=M.value.flatMap(f=>f.duplicates.map(k=>k.id));console.log("[å»é‡ç®¡ç†] åˆ é™¤æ‰€æœ‰é‡å¤å¡ç‰‡:",y);const S=yield fe(y);console.log("[å»é‡ç®¡ç†] åˆ é™¤å“åº”:",S.data),S.data.success?(console.log("[å»é‡ç®¡ç†] åˆ é™¤æˆåŠŸï¼Œé‡æ–°æ£€æµ‹..."),yield i()):B.value="åˆ é™¤å¤±è´¥ï¼š"+(S.data.message||"æœªçŸ¥é”™è¯¯")}catch(y){console.error("[å»é‡ç®¡ç†] åˆ é™¤æ‰€æœ‰é‡å¤å¤±è´¥:",y),console.error("[å»é‡ç®¡ç†] é”™è¯¯è¯¦æƒ…:",(l=y.response)==null?void 0:l.data),B.value=((p=(d=y.response)==null?void 0:d.data)==null?void 0:p.error)||y.message||"åˆ é™¤å¤±è´¥"}finally{g.value=!1}}})}return(s,l)=>(u(),c("div",Ls,[e("div",Ws,[l[0]||(l[0]=e("h3",null,"å¡ç‰‡å»é‡ç®¡ç†",-1)),e("button",{onClick:i,class:"btn btn-primary",disabled:o.value},h(o.value?"æ£€æµ‹ä¸­...":"ğŸ” ä¸€é”®æ£€æµ‹é‡å¤"),9,Ns)]),M.value.length>0?(u(),c("div",zs,[e("div",Ps,[e("div",Hs,[l[1]||(l[1]=e("div",{class:"summary-label"},"æ€»å¡ç‰‡æ•°",-1)),e("div",Os,h(A.value),1)]),e("div",Fs,[l[2]||(l[2]=e("div",{class:"summary-label"},"é‡å¤ç»„æ•°",-1)),e("div",Rs,h(M.value.length),1)]),e("div",js,[l[3]||(l[3]=e("div",{class:"summary-label"},"é‡å¤å¡ç‰‡",-1)),e("div",Es,h(D.value),1)])]),e("div",qs,[(u(!0),c(H,null,O(M.value,(d,p)=>(u(),c("div",{key:p,class:"duplicate-group"},[e("div",Js,[e("h4",null,"é‡å¤ç»„ "+h(p+1),1),e("span",Gs,h(d.totalCount)+" å¼ å¡ç‰‡",1)]),e("div",Ks,[l[4]||(l[4]=e("div",{class:"card-badge"},"ä¿ç•™",-1)),e("div",Qs,[e("div",Xs,h(d.original.title),1),e("div",Ys,h(d.original.url),1),d.original.desc?(u(),c("div",Zs,h(d.original.desc),1)):W("",!0)]),e("div",el,"ID: "+h(d.original.id),1)]),e("div",tl,[(u(!0),c(H,null,O(d.duplicates,y=>(u(),c("div",{key:y.id,class:"card-item duplicate"},[l[5]||(l[5]=e("div",{class:"card-badge danger"},"é‡å¤",-1)),e("div",sl,[e("div",ll,h(y.title),1),e("div",al,h(y.url),1),y.desc?(u(),c("div",ol,h(y.desc),1)):W("",!0)]),e("div",nl,[e("span",il,"ID: "+h(y.id),1),e("button",{onClick:S=>v(y.id),class:"btn-remove",disabled:g.value,title:"åˆ é™¤æ­¤å¡ç‰‡"}," åˆ é™¤ ",8,dl)])]))),128))]),e("div",rl,[e("button",{onClick:y=>n(d),class:"btn btn-danger",disabled:g.value}," åˆ é™¤æ­¤ç»„æ‰€æœ‰é‡å¤å¡ç‰‡ ("+h(d.duplicates.length)+" å¼ ) ",9,ul)])]))),128))]),e("div",cl,[e("button",{onClick:a,class:"btn btn-danger btn-large",disabled:g.value},h(g.value?"åˆ é™¤ä¸­...":`åˆ é™¤æ‰€æœ‰é‡å¤å¡ç‰‡ (${D.value} å¼ )`),9,vl)])])):$.value&&M.value.length===0?(u(),c("div",pl,[...l[6]||(l[6]=[e("svg",{width:"80",height:"80",viewBox:"0 0 24 24",fill:"none",stroke:"#1abc9c","stroke-width":"2"},[e("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e("polyline",{points:"22 4 12 14.01 9 11.01"})],-1),e("h3",null,"å¤ªæ£’äº†ï¼æ²¡æœ‰å‘ç°é‡å¤å¡ç‰‡",-1),e("p",null,"æ‚¨çš„å¯¼èˆªå¡ç‰‡éƒ½æ˜¯å”¯ä¸€çš„",-1)])])):$.value?W("",!0):(u(),c("div",ml,[...l[7]||(l[7]=[le('<svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="#666" stroke-width="2" data-v-62bbc778><circle cx="12" cy="12" r="10" data-v-62bbc778></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" data-v-62bbc778></path><line x1="12" y1="17" x2="12.01" y2="17" data-v-62bbc778></line></svg><h3 data-v-62bbc778>ç‚¹å‡»&quot;ä¸€é”®æ£€æµ‹é‡å¤&quot;å¼€å§‹æ‰«æ</h3><p data-v-62bbc778>ç³»ç»Ÿå°†æ£€æµ‹æ‰€æœ‰é‡å¤çš„å¯¼èˆªå¡ç‰‡</p><ul class="hint-list" data-v-62bbc778><li data-v-62bbc778>ğŸ“Œ URL ç›¸åŒçš„å¡ç‰‡</li><li data-v-62bbc778>ğŸ“Œ æ ‡é¢˜ç›¸åŒä¸”åŸŸåç›¸åŒçš„å¡ç‰‡</li></ul>',4)])])),B.value?(u(),c("p",bl,h(B.value),1)):W("",!0)]))}},fl=q(gl,[["__scopeId","data-v-62bbc778"]]),hl={class:"tag-manage"},wl={class:"tag-header"},kl={class:"tag-add"},yl={class:"tag-content"},_l={key:0,class:"empty-state"},$l={key:1,class:"tag-list"},Cl={class:"tag-info"},xl=["onUpdate:modelValue","onBlur"],Ml={class:"tag-stats"},Vl={class:"card-count"},Bl={class:"tag-controls"},Ul=["onUpdate:modelValue","onChange"],Al={class:"tag-order"},Dl=["onUpdate:modelValue","onBlur"],Sl={class:"tag-actions"},Tl=["onClick"],Il={__name:"TagManage",setup(L){const o=w([]),g=w(""),$=w("#2566d8");Q(M);function M(){return C(this,null,function*(){const i=yield Ve();o.value=i.data;for(const v of o.value)try{const n=yield Xe(v.id);v.cardCount=n.data.count}catch(n){v.cardCount=0}})}function A(){return C(this,null,function*(){var s,l;if(!g.value.trim())return;const i=o.value.length?Math.max(...o.value.map(d=>d.order||0)):0,v=g.value.trim(),n=$.value,a={id:Date.now(),name:v,color:n,order:i+1,cardCount:0,_temp:!0};o.value.push(a),g.value="",$.value="#2566d8";try{const d=yield Ye({name:v,color:n,order:i+1}),p=o.value.findIndex(y=>y.id===a.id);p>-1&&(o.value[p]=ue(se({},d.data),{cardCount:0}))}catch(d){const p=o.value.findIndex(y=>y.id===a.id);p>-1&&o.value.splice(p,1),alert("æ·»åŠ æ ‡ç­¾å¤±è´¥ï¼š"+(((l=(s=d.response)==null?void 0:s.data)==null?void 0:l.error)||d.message))}})}function D(i){return C(this,null,function*(){var v,n;if(!i._temp)try{yield Ze(i.id,{name:i.name,color:i.color,order:i.order})}catch(a){alert("æ›´æ–°æ ‡ç­¾å¤±è´¥ï¼š"+(((n=(v=a.response)==null?void 0:v.data)==null?void 0:n.error)||a.message)),M()}})}function B(i){return C(this,null,function*(){var s,l;const v=o.value.find(d=>d.id===i);if(!v)return;const n=v.cardCount>0?`ç¡®å®šè¦åˆ é™¤æ ‡ç­¾"${v.name}"å—ï¼Ÿè¿™å°†å–æ¶ˆ ${v.cardCount} å¼ å¡ç‰‡çš„å…³è”ã€‚`:`ç¡®å®šè¦åˆ é™¤æ ‡ç­¾"${v.name}"å—ï¼Ÿ`;if(!confirm(n))return;const a=o.value.findIndex(d=>d.id===i);a>-1&&o.value.splice(a,1);try{yield et(i)}catch(d){alert("åˆ é™¤æ ‡ç­¾å¤±è´¥ï¼š"+(((l=(s=d.response)==null?void 0:s.data)==null?void 0:l.error)||d.message)),M()}})}return(i,v)=>(u(),c("div",hl,[e("div",wl,[v[3]||(v[3]=e("div",{class:"header-content"},[e("h2",{class:"page-title"},"ç®¡ç†æ ‡ç­¾"),e("p",{class:"page-desc"},"ä¸ºå¡ç‰‡åˆ›å»ºå¤šç»´åº¦åˆ†ç±»æ ‡ç­¾")],-1)),e("div",kl,[_(e("input",{"onUpdate:modelValue":v[0]||(v[0]=n=>g.value=n),placeholder:"æ ‡ç­¾åç§°",class:"input",maxlength:"20"},null,512),[[U,g.value]]),_(e("input",{"onUpdate:modelValue":v[1]||(v[1]=n=>$.value=n),type:"color",class:"color-input",title:"é€‰æ‹©æ ‡ç­¾é¢œè‰²"},null,512),[[U,$.value]]),e("button",{class:"btn btn-primary",onClick:A},[...v[2]||(v[2]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),N(" æ·»åŠ æ ‡ç­¾ ",-1)])])])]),e("div",yl,[o.value.length===0?(u(),c("div",_l,[...v[4]||(v[4]=[e("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1"},[e("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"}),e("line",{x1:"7",y1:"7",x2:"7.01",y2:"7"})],-1),e("p",null,"æš‚æ— æ ‡ç­¾",-1),e("p",{class:"hint"},"åˆ›å»ºç¬¬ä¸€ä¸ªæ ‡ç­¾ï¼Œå¼€å§‹ä¸ºå¡ç‰‡æ·»åŠ å¤šç»´åº¦åˆ†ç±»",-1)])])):(u(),c("div",$l,[(u(!0),c(H,null,O(o.value,n=>(u(),c("div",{key:n.id,class:"tag-item"},[e("div",{class:"tag-preview",style:we({backgroundColor:n.color})},[...v[5]||(v[5]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"}),e("line",{x1:"7",y1:"7",x2:"7.01",y2:"7"})],-1)])],4),e("div",Cl,[_(e("input",{"onUpdate:modelValue":a=>n.name=a,onBlur:a=>D(n),class:"tag-name-input",maxlength:"20"},null,40,xl),[[U,n.name]]),e("div",Ml,[e("span",Vl,h(n.cardCount||0)+" å¼ å¡ç‰‡",1)])]),e("div",Bl,[_(e("input",{"onUpdate:modelValue":a=>n.color=a,type:"color",onChange:a=>D(n),class:"color-picker",title:"æ›´æ”¹é¢œè‰²"},null,40,Ul),[[U,n.color]]),e("div",Al,[v[6]||(v[6]=e("span",{class:"order-label"},"æ’åº",-1)),_(e("input",{"onUpdate:modelValue":a=>n.order=a,type:"number",onBlur:a=>D(n),class:"order-input"},null,40,Dl),[[U,n.order,void 0,{number:!0}]])])]),e("div",Sl,[e("button",{class:"btn btn-danger btn-icon",onClick:a=>B(n.id),title:"åˆ é™¤æ ‡ç­¾"},[...v[7]||(v[7]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)])],8,Tl)])]))),128))]))])]))}},Ll=q(Il,[["__scopeId","data-v-56efcb56"]]),Wl={class:"ad-manage"},Nl={class:"ad-header"},zl={class:"ad-section"},Pl={class:"ad-card"},Hl={class:"ad-table"},Ol=["onUpdate:modelValue","onBlur"],Fl=["onUpdate:modelValue","onBlur"],Rl=["onClick"],jl={class:"ad-section"},El={class:"ad-card"},ql={class:"ad-table"},Jl=["onUpdate:modelValue","onBlur"],Gl=["onUpdate:modelValue","onBlur"],Kl=["onClick"],Ql={__name:"AdManage",setup(L){const o=w([]),g=w([]),$=w(""),M=w(""),A=w("left");Q(D);function D(){return C(this,null,function*(){try{const n=yield tt();let a=[];Array.isArray(n.data)?a=n.data:n.data&&Array.isArray(n.data.data)&&(a=n.data.data),o.value=a.filter(s=>s.position==="left"),g.value=a.filter(s=>s.position==="right")}catch(n){console.error("åŠ è½½å¹¿å‘Šå¤±è´¥:",n),o.value=[],g.value=[]}})}function B(){return C(this,null,function*(){var n,a;if(!$.value||!M.value){alert("è¯·å¡«å†™å¹¿å‘Šå›¾ç‰‡é“¾æ¥å’Œè·³è½¬é“¾æ¥");return}try{yield st({position:A.value,img:$.value,url:M.value}),$.value="",M.value="",A.value="left",yield D()}catch(s){alert("æ·»åŠ å¹¿å‘Šå¤±è´¥ï¼š"+(((a=(n=s.response)==null?void 0:n.data)==null?void 0:a.error)||s.message))}})}function i(n){return C(this,null,function*(){var a,s;try{yield lt(n.id,{img:n.img,url:n.url})}catch(l){alert("æ›´æ–°å¹¿å‘Šå¤±è´¥ï¼š"+(((s=(a=l.response)==null?void 0:a.data)==null?void 0:s.error)||l.message)),yield D()}})}function v(n){return C(this,null,function*(){if(!confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå¹¿å‘Šå—ï¼Ÿ"))return;const a=o.value.findIndex(l=>l.id===n),s=g.value.findIndex(l=>l.id===n);a>-1&&o.value.splice(a,1),s>-1&&g.value.splice(s,1);try{yield at(n)}catch(l){console.error("åˆ é™¤å¹¿å‘Šå¤±è´¥:",l),yield D()}})}return(n,a)=>(u(),c("div",Wl,[e("div",Nl,[e("form",{class:"ad-add-row",onSubmit:ve(B,["prevent"])},[_(e("input",{"onUpdate:modelValue":a[0]||(a[0]=s=>$.value=s),placeholder:"å¹¿å‘Šå›¾ç‰‡é“¾æ¥",class:"input"},null,512),[[U,$.value]]),_(e("input",{"onUpdate:modelValue":a[1]||(a[1]=s=>M.value=s),placeholder:"å¹¿å‘Šè·³è½¬é“¾æ¥",class:"input"},null,512),[[U,M.value]]),_(e("select",{"onUpdate:modelValue":a[2]||(a[2]=s=>A.value=s),class:"input select-input"},[...a[3]||(a[3]=[e("option",{value:"left"},"å·¦ä¾§å¹¿å‘Š",-1),e("option",{value:"right"},"å³ä¾§å¹¿å‘Š",-1)])],512),[[he,A.value]]),a[4]||(a[4]=e("button",{class:"btn",type:"submit"},"æ·»åŠ å¹¿å‘Š",-1))],32)]),e("div",zl,[a[6]||(a[6]=e("h3",{class:"section-title"},"å·¦ä¾§å¹¿å‘Šåˆ—è¡¨",-1)),e("div",Pl,[e("table",Hl,[a[5]||(a[5]=e("thead",null,[e("tr",null,[e("th",null,"å›¾ç‰‡"),e("th",null,"è·³è½¬é“¾æ¥"),e("th",null,"æ“ä½œ")])],-1)),e("tbody",null,[(u(!0),c(H,null,O(o.value,s=>(u(),c("tr",{key:s.id},[e("td",null,[_(e("input",{"onUpdate:modelValue":l=>s.img=l,onBlur:l=>i(s),class:"input"},null,40,Ol),[[U,s.img]])]),e("td",null,[_(e("input",{"onUpdate:modelValue":l=>s.url=l,onBlur:l=>i(s),class:"input"},null,40,Fl),[[U,s.url]])]),e("td",null,[e("button",{class:"btn btn-danger",onClick:l=>v(s.id)},"åˆ é™¤å¹¿å‘Š",8,Rl)])]))),128))])])])]),e("div",jl,[a[8]||(a[8]=e("h3",{class:"section-title"},"å³ä¾§å¹¿å‘Šåˆ—è¡¨",-1)),e("div",El,[e("table",ql,[a[7]||(a[7]=e("thead",null,[e("tr",null,[e("th",null,"å›¾ç‰‡"),e("th",null,"è·³è½¬é“¾æ¥"),e("th",null,"æ“ä½œ")])],-1)),e("tbody",null,[(u(!0),c(H,null,O(g.value,s=>(u(),c("tr",{key:s.id},[e("td",null,[_(e("input",{"onUpdate:modelValue":l=>s.img=l,onBlur:l=>i(s),class:"input"},null,40,Jl),[[U,s.img]])]),e("td",null,[_(e("input",{"onUpdate:modelValue":l=>s.url=l,onBlur:l=>i(s),class:"input"},null,40,Gl),[[U,s.url]])]),e("td",null,[e("button",{class:"btn btn-danger",onClick:l=>v(s.id)},"åˆ é™¤å¹¿å‘Š",8,Kl)])]))),128))])])])])]))}},Xl=q(Ql,[["__scopeId","data-v-9c35605d"]]),Yl={class:"friend-manage"},Zl={class:"friend-add"},ea={class:"friend-card"},ta={class:"friend-table"},sa=["onUpdate:modelValue","onBlur"],la=["onUpdate:modelValue","onBlur"],aa=["onUpdate:modelValue","onBlur"],oa=["onClick"],na={__name:"FriendLinkManage",setup(L){const o=w([]),g=w(""),$=w(""),M=w("");Q(A);function A(){return C(this,null,function*(){const v=yield ot();o.value=v.data})}function D(){return C(this,null,function*(){!g.value||!$.value||(yield nt({title:g.value,url:$.value,logo:M.value}),g.value="",$.value="",M.value="",A())})}function B(v){return C(this,null,function*(){yield it(v.id,{title:v.title,url:v.url,logo:v.logo}),A()})}function i(v){return C(this,null,function*(){if(!confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå‹é“¾å—ï¼Ÿ"))return;const n=o.value.findIndex(a=>a.id===v);n>-1&&o.value.splice(n,1);try{yield dt(v)}catch(a){console.error("åˆ é™¤å‹é“¾å¤±è´¥:",a),yield A()}})}return(v,n)=>(u(),c("div",Yl,[n[4]||(n[4]=e("div",{class:"friend-header"},null,-1)),e("div",Zl,[_(e("input",{"onUpdate:modelValue":n[0]||(n[0]=a=>g.value=a),placeholder:"ç½‘ç«™å",class:"input"},null,512),[[U,g.value]]),_(e("input",{"onUpdate:modelValue":n[1]||(n[1]=a=>$.value=a),placeholder:"ç½‘ç«™é“¾æ¥",class:"input"},null,512),[[U,$.value]]),_(e("input",{"onUpdate:modelValue":n[2]||(n[2]=a=>M.value=a),placeholder:"logoé“¾æ¥(å¯é€‰)",class:"input"},null,512),[[U,M.value]]),e("button",{class:"btn",onClick:D},"æ·»åŠ å‹é“¾")]),e("div",ea,[e("table",ta,[n[3]||(n[3]=e("thead",null,[e("tr",null,[e("th",null,"ç½‘ç«™å"),e("th",null,"é“¾æ¥"),e("th",null,"Logo"),e("th",null,"æ“ä½œ")])],-1)),e("tbody",null,[(u(!0),c(H,null,O(o.value,a=>(u(),c("tr",{key:a.id},[e("td",null,[_(e("input",{"onUpdate:modelValue":s=>a.title=s,onBlur:s=>B(a),class:"input"},null,40,sa),[[U,a.title]])]),e("td",null,[_(e("input",{"onUpdate:modelValue":s=>a.url=s,onBlur:s=>B(a),class:"input"},null,40,la),[[U,a.url]])]),e("td",null,[_(e("input",{"onUpdate:modelValue":s=>a.logo=s,onBlur:s=>B(a),class:"input",placeholder:"logoé“¾æ¥(å¯é€‰)"},null,40,aa),[[U,a.logo]])]),e("td",null,[e("button",{class:"btn btn-danger",onClick:s=>i(a.id)},"åˆ é™¤",8,oa)])]))),128))])])])]))}},ia=q(na,[["__scopeId","data-v-c25e838c"]]),da={class:"user-manage"},ra={class:"user-card"},ua={class:"username-section"},ca={class:"username-form"},va={class:"current-username"},pa={class:"username-display"},ma={class:"form-group"},ba={class:"form-actions"},ga=["disabled"],fa={class:"password-section"},ha={class:"password-form"},wa={class:"form-group"},ka={class:"form-group"},ya={class:"form-group"},_a={class:"form-actions"},$a=["disabled"],Ca={__name:"UserManage",setup(L){const o=w(""),g=w(""),$=w(""),M=w(!1),A=w(""),D=w("success"),B=w({}),i=w(""),v=w(!1),n=w(""),a=w("success");Q(()=>C(null,null,function*(){yield s()}));function s(){return C(this,null,function*(){try{const S=yield rt();B.value=S.data.data||S.data}catch(S){console.error("è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:",S)}})}function l(){return C(this,null,function*(){var S,f;if(!i.value){d("è¯·è¾“å…¥æ–°ç”¨æˆ·å","error");return}if(i.value.length<3||i.value.length>20){d("ç”¨æˆ·åé•¿åº¦åº”ä¸º3-20ä½","error");return}if(i.value===B.value.username){d("æ–°ç”¨æˆ·åä¸èƒ½ä¸å½“å‰ç”¨æˆ·åç›¸åŒ","error");return}v.value=!0,n.value="";try{yield ut(i.value),d("ç”¨æˆ·åä¿®æ”¹æˆåŠŸï¼2ç§’åè‡ªåŠ¨é€€å‡ºï¼Œè¯·ä½¿ç”¨æ–°ç”¨æˆ·åé‡æ–°ç™»å½•...","success"),i.value="",setTimeout(()=>{localStorage.removeItem("token"),window.location.href="/admin"},2e3)}catch(k){d(((f=(S=k.response)==null?void 0:S.data)==null?void 0:f.message)||"ç”¨æˆ·åä¿®æ”¹å¤±è´¥","error")}finally{v.value=!1}})}function d(S,f){n.value=S,a.value=f,setTimeout(()=>{n.value=""},3e3)}function p(){return C(this,null,function*(){var S,f;if(!o.value||!g.value||!$.value){y("è¯·å¡«å†™æ‰€æœ‰å¯†ç å­—æ®µ","error");return}if(g.value!==$.value){y("ä¸¤æ¬¡è¾“å…¥çš„æ–°å¯†ç ä¸ä¸€è‡´","error");return}if(g.value.length<6){y("æ–°å¯†ç é•¿åº¦è‡³å°‘6ä½","error");return}M.value=!0,A.value="";try{yield ct(o.value,g.value),y("å¯†ç ä¿®æ”¹æˆåŠŸ","success"),o.value="",g.value="",$.value=""}catch(k){y(((f=(S=k.response)==null?void 0:S.data)==null?void 0:f.message)||"å¯†ç ä¿®æ”¹å¤±è´¥","error")}finally{M.value=!1}})}function y(S,f){A.value=S,D.value=f,S==="å¯†ç ä¿®æ”¹æˆåŠŸ"&&f==="success"?setTimeout(()=>{A.value="2ç§’åè‡ªåŠ¨é€€å‡ºç™»å½•,è¯·ä½¿ç”¨æ–°å¯†ç é‡æ–°ç™»å½•...",setTimeout(()=>{localStorage.removeItem("token"),window.location.reload()},2e3)},500):setTimeout(()=>{A.value=""},3e3)}return(S,f)=>(u(),c("div",da,[f[11]||(f[11]=e("div",{class:"user-header"},null,-1)),e("div",ra,[e("div",ua,[f[6]||(f[6]=e("h3",{class:"section-title"},"ä¿®æ”¹ç”¨æˆ·å",-1)),e("div",ca,[e("div",va,[f[4]||(f[4]=e("label",null,"å½“å‰ç”¨æˆ·åï¼š",-1)),e("span",pa,h(B.value.username||"admin"),1)]),e("div",ma,[f[5]||(f[5]=e("label",null,"æ–°ç”¨æˆ·åï¼š",-1)),_(e("input",{"onUpdate:modelValue":f[0]||(f[0]=k=>i.value=k),type:"text",placeholder:"è¯·è¾“å…¥æ–°ç”¨æˆ·åï¼ˆ3-20ä½ï¼‰",class:"input"},null,512),[[U,i.value]])]),e("div",ba,[e("button",{onClick:l,class:"btn",disabled:v.value},h(v.value?"ä¿®æ”¹ä¸­...":"ä¿®æ”¹ç”¨æˆ·å"),9,ga)]),n.value?(u(),c("p",{key:0,class:z(["message",a.value])},h(n.value),3)):W("",!0)])]),e("div",fa,[f[10]||(f[10]=e("h3",{class:"section-title"},"ä¿®æ”¹å¯†ç ",-1)),e("div",ha,[e("div",wa,[f[7]||(f[7]=e("label",null,"å½“å‰å¯†ç ï¼š",-1)),_(e("input",{"onUpdate:modelValue":f[1]||(f[1]=k=>o.value=k),type:"password",placeholder:"è¯·è¾“å…¥å½“å‰å¯†ç ",class:"input"},null,512),[[U,o.value]])]),e("div",ka,[f[8]||(f[8]=e("label",null,"æ–°å¯†ç ï¼š",-1)),_(e("input",{"onUpdate:modelValue":f[2]||(f[2]=k=>g.value=k),type:"password",placeholder:"è¯·è¾“å…¥æ–°å¯†ç ",class:"input"},null,512),[[U,g.value]])]),e("div",ya,[f[9]||(f[9]=e("label",null,"ç¡®è®¤æ–°å¯†ç ï¼š",-1)),_(e("input",{"onUpdate:modelValue":f[3]||(f[3]=k=>$.value=k),type:"password",placeholder:"è¯·å†æ¬¡è¾“å…¥æ–°å¯†ç ",class:"input"},null,512),[[U,$.value]])]),e("div",_a,[e("button",{onClick:p,class:"btn",disabled:M.value},h(M.value?"ä¿®æ”¹ä¸­...":"ä¿®æ”¹å¯†ç "),9,$a)]),A.value?(u(),c("p",{key:0,class:z(["message",D.value])},h(A.value),3)):W("",!0)])])])]))}},xa=q(Ca,[["__scopeId","data-v-40392133"]]),Ma={class:"backup-manage"},Va={class:"tabs"},Ba={class:"tab-content"},Ua={class:"toolbar"},Aa=["disabled"],Da=["disabled"],Sa=["disabled"],Ta={class:"backup-list"},Ia={key:0,class:"empty-state"},La={key:1,class:"backup-grid"},Wa={class:"backup-info"},Na={class:"backup-name"},za={class:"backup-meta"},Pa={class:"backup-size"},Ha={class:"backup-date"},Oa={key:0,class:"backup-signed",title:"å·²ç­¾åéªŒè¯"},Fa={key:1,class:"backup-unsigned",title:"æœªç­¾åï¼ˆå¤–éƒ¨ä¸Šä¼ ï¼‰"},Ra={class:"backup-actions"},ja=["onClick"],Ea=["onClick"],qa=["onClick"],Ja=["onClick"],Ga={class:"tab-content"},Ka={class:"toolbar"},Qa=["disabled"],Xa=["disabled"],Ya={key:1,class:"info-box"},Za={class:"backup-list"},eo={key:0,class:"empty-state"},to={key:1,class:"backup-grid"},so={class:"backup-info"},lo={class:"backup-name"},ao={class:"backup-meta"},oo={class:"backup-size"},no={class:"backup-date"},io={class:"backup-actions"},ro=["onClick"],uo=["onClick"],co={class:"tab-content"},vo={class:"config-section"},po={class:"config-card"},mo={class:"config-header"},bo={class:"switch"},go={key:0,class:"config-fields"},fo={class:"field-row"},ho={class:"field-row"},wo={class:"config-card"},ko={class:"config-header"},yo={class:"switch"},_o={key:0,class:"config-fields"},$o={class:"field-row"},Co={class:"time-input"},xo={class:"field-row"},Mo={class:"field-row checkbox-row"},Vo={class:"checkbox-label"},Bo={class:"config-card"},Uo={class:"config-header"},Ao={class:"switch"},Do={class:"config-info"},So={key:0,class:"warning-text"},To={key:0,class:"config-fields"},Io={class:"field-row checkbox-row"},Lo={class:"checkbox-label"},Wo={class:"field-row checkbox-row"},No={class:"checkbox-label"},zo={class:"config-card"},Po={class:"config-header"},Ho={class:"switch"},Oo={key:0,class:"stats-card"},Fo={class:"stats-grid"},Ro={class:"stat-item"},jo={class:"stat-value"},Eo={class:"stat-item"},qo={class:"stat-value"},Jo={class:"stat-item"},Go={class:"stat-value"},Ko={class:"stat-item"},Qo={class:"stat-value"},Xo={class:"config-actions"},Yo=["disabled"],Zo={key:0,class:"modal-overlay"},en={class:"modal-content config-modal"},tn={class:"form-group"},sn={class:"form-group"},ln={class:"form-group"},an=["placeholder"],on={key:0},nn={key:1},dn={class:"modal-actions"},rn=["disabled"],un={key:1,class:"modal-overlay"},cn={class:"modal-content"},vn={style:{"white-space":"pre-line"}},pn={class:"modal-actions"},mn=["disabled"],bn=["disabled"],gn={key:2,class:"modal-overlay"},fn={class:"modal-content config-modal"},hn={class:"form-group"},wn={class:"form-group"},kn={class:"modal-actions"},yn=["disabled"],_n={key:3,class:"modal-overlay"},$n={class:"modal-content config-modal"},Cn={class:"form-group"},xn={class:"modal-actions"},Mn=["disabled"],Vn={__name:"BackupManage",setup(L){const o=w("local"),g=w([]),$=w([]),M=w(!1),A=w(!1),D=w(!1),B=w(null),i=Z({create:!1,list:!1,delete:!1,restore:!1,upload:!1,rename:!1,webdavConfig:!1,webdavBackup:!1,webdavList:!1,webdavRestore:!1,webdavDelete:!1,autoBackupConfig:!1}),v=Z({name:"",description:""}),n=Z({oldName:"",newName:""}),a=w({text:"",type:""}),s=Z({show:!1,filename:"",action:null,title:"",message:"",confirmClass:"",signed:!0,processing:!1}),l=Z({configured:!1,url:"",username:""}),d=Z({url:"",username:"",password:""}),p=Z({debounce:{enabled:!0,delay:30,keep:5},scheduled:{enabled:!0,hour:2,minute:0,keep:7,onlyIfModified:!0},webdav:{enabled:!1,syncDaily:!0,syncIncremental:!0},autoClean:!0}),y=w(null),S=localStorage.getItem("token");function f(P){return C(this,arguments,function*(r,t={}){return(yield fetch(r,ue(se({},t),{headers:se({Authorization:`Bearer ${S}`,"Content-Type":"application/json"},t.headers)}))).json()})}const k=(r,t="success",P=4e3)=>{a.value={text:r,type:t},setTimeout(()=>{a.value={text:"",type:""}},t==="error"?6e3:P)},J=()=>{v.name="",v.description="",A.value=!0},F=()=>C(null,null,function*(){i.create=!0;const r=yield f("/api/backup/create",{method:"POST",body:JSON.stringify({name:v.name||null,description:v.description||null})});r.success?(k("å¤‡ä»½åˆ›å»ºæˆåŠŸï¼"),A.value=!1,yield I()):k(r.message||"å¤‡ä»½åˆ›å»ºå¤±è´¥","error"),i.create=!1}),R=r=>{n.oldName=r,n.newName=r.replace(".zip",""),D.value=!0},x=()=>C(null,null,function*(){if(!n.newName.trim()){k("è¯·è¾“å…¥æ–°åç§°","error");return}i.rename=!0;const r=yield f(`/api/backup/rename/${n.oldName}`,{method:"PUT",body:JSON.stringify({newName:n.newName})});r.success?(k("é‡å‘½åæˆåŠŸï¼"),D.value=!1,yield I()):k(r.message||"é‡å‘½åå¤±è´¥","error"),i.rename=!1}),I=()=>C(null,null,function*(){i.list=!0;const r=yield f("/api/backup/list");r.success?g.value=r.backups:k("è·å–å¤‡ä»½åˆ—è¡¨å¤±è´¥","error"),i.list=!1}),pe=r=>{window.open(`/api/backup/download/${r}?token=${S}`,"_blank")},X=(r,t)=>{const P=typeof t=="object"?t:{name:t},b=P.name;s.show=!0,s.filename=b,s.action=r,s.signed=P.signed,s.processing=!1,r==="delete"?(s.title="åˆ é™¤",s.message=`ç¡®å®šè¦åˆ é™¤å¤‡ä»½æ–‡ä»¶ ${b} å—ï¼Ÿ`,s.confirmClass="btn-danger"):r==="restore"?(s.title="æ¢å¤",P.signed?s.message=`ç¡®å®šè¦æ¢å¤å¤‡ä»½æ–‡ä»¶ ${b} å—ï¼Ÿ`:s.message=`âš ï¸ è­¦å‘Šï¼šæ­¤å¤‡ä»½æ–‡ä»¶æœªç­¾åï¼ˆå¯èƒ½æ˜¯å¤–éƒ¨ä¸Šä¼ çš„ï¼‰ï¼Œæ— æ³•éªŒè¯å…¶å®Œæ•´æ€§ã€‚

ç¡®å®šè¦æ¢å¤å¤‡ä»½æ–‡ä»¶ ${b} å—ï¼Ÿ`,s.confirmClass="btn-restore"):r==="webdav-restore"?(s.title="ä»WebDAVæ¢å¤",s.message=`ç¡®å®šè¦ä»WebDAVæ¢å¤å¤‡ä»½ ${b} å—ï¼Ÿè¿™å°†è¦†ç›–å½“å‰æ•°æ®ã€‚`,s.confirmClass="btn-restore"):r==="webdav-delete"&&(s.title="åˆ é™¤WebDAVå¤‡ä»½",s.message=`ç¡®å®šè¦åˆ é™¤WebDAVå¤‡ä»½ ${b} å—ï¼Ÿ`,s.confirmClass="btn-danger")},Y=()=>C(null,null,function*(){const{action:r,filename:t,signed:P}=s;s.show=!1,s.processing=!1;try{if(r==="delete"){k("æ­£åœ¨åˆ é™¤å¤‡ä»½...");const b=yield f(`/api/backup/delete/${t}`,{method:"DELETE"});b.success?(k("âœ“ åˆ é™¤æˆåŠŸ"),yield I()):k("âœ— "+(b.message||"åˆ é™¤å¤±è´¥"),"error")}else if(r==="restore"){k("æ­£åœ¨æ¢å¤å¤‡ä»½ï¼Œè¯·ç¨å€™...");const b=P?{}:{forceRestore:!0},j=yield f(`/api/backup/restore/${t}`,{method:"POST",body:JSON.stringify(b)});if(j.success)k("âœ“ å¤‡ä»½å·²æ¢å¤ï¼Œæ­£åœ¨é‡æ–°åŠ è½½æ•°æ®..."),yield new Promise(re=>setTimeout(re,2e3)),yield Promise.all([I(),T(),E(),G()]),k("âœ“ æ¢å¤å®Œæˆï¼æ•°æ®å·²æ›´æ–°","success",5e3);else if(j.requireConfirm&&j.code==="NO_SIGNATURE"){if(confirm(j.message+`

ç‚¹å‡»"ç¡®å®š"ç»§ç»­æ¢å¤ï¼Œç‚¹å‡»"å–æ¶ˆ"æ”¾å¼ƒæ“ä½œã€‚`)){const re=yield f(`/api/backup/restore/${t}`,{method:"POST",body:JSON.stringify({forceRestore:!0})});re.success?(k("âœ“ å¤‡ä»½å·²æ¢å¤ï¼Œæ­£åœ¨é‡æ–°åŠ è½½æ•°æ®..."),yield new Promise(Be=>setTimeout(Be,2e3)),yield Promise.all([I(),T(),E(),G()]),k("âœ“ æ¢å¤å®Œæˆï¼æ•°æ®å·²æ›´æ–°","success",5e3)):k("âœ— "+(re.message||"æ¢å¤å¤±è´¥"),"error")}}else k("âœ— "+(j.message||"æ¢å¤å¤±è´¥"),"error")}else r==="webdav-restore"?yield ne(t):r==="webdav-delete"&&(yield ie(t))}catch(b){k("âœ— æ“ä½œå¤±è´¥: "+b.message,"error")}}),te=r=>r?new Date(r).toLocaleString("zh-CN",{hour12:!1}):"--",me=()=>{B.value.click()},be=r=>C(null,null,function*(){const t=r.target.files[0];if(t){if(!t.name.endsWith(".zip")){k("åªæ”¯æŒ.zipæ ¼å¼çš„å¤‡ä»½æ–‡ä»¶","error"),r.target.value="";return}if(t.size>500*1024*1024){k("å¤‡ä»½æ–‡ä»¶è¿‡å¤§ï¼Œæœ€å¤§æ”¯æŒ500MB","error"),r.target.value="";return}i.upload=!0;try{const P=new FormData;P.append("backup",t);const j=yield(yield fetch("/api/backup/upload",{method:"POST",headers:{Authorization:`Bearer ${S}`},body:P})).json();j.success?(k("å¤‡ä»½æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼"),yield I()):k(j.message||"å¤‡ä»½æ–‡ä»¶ä¸Šä¼ å¤±è´¥","error")}catch(P){console.error("ä¸Šä¼ å¤±è´¥:",P),k("å¤‡ä»½æ–‡ä»¶ä¸Šä¼ å¤±è´¥","error")}finally{i.upload=!1,r.target.value=""}}}),T=()=>C(null,null,function*(){const r=yield f("/api/backup/webdav/config");r.success&&r.config&&(l.configured=r.config.configured,l.url=r.config.url||"",l.username=r.config.username||"")}),m=()=>C(null,null,function*(){yield T(),d.url=l.url,d.username=l.username,d.password="",M.value=!0}),K=()=>C(null,null,function*(){if(!d.url||!d.username){k("è¯·å¡«å†™URLå’Œç”¨æˆ·å","error");return}if(!l.configured&&!d.password){k("é¦–æ¬¡é…ç½®æ—¶å¯†ç ä¸èƒ½ä¸ºç©º","error");return}i.webdavConfig=!0;const r=yield f("/api/backup/webdav/config",{method:"POST",body:JSON.stringify(d)});r.success?(k("WebDAVé…ç½®ä¿å­˜æˆåŠŸï¼"),M.value=!1,yield T(),l.configured&&(yield E())):k(r.message||"WebDAVé…ç½®ä¿å­˜å¤±è´¥","error"),i.webdavConfig=!1}),ae=()=>C(null,null,function*(){i.webdavBackup=!0;const r=yield f("/api/backup/webdav/backup",{method:"POST"});r.success?(k("å¤‡ä»½åˆ°WebDAVæˆåŠŸï¼"),yield E()):k(r.message||"å¤‡ä»½åˆ°WebDAVå¤±è´¥","error"),i.webdavBackup=!1}),oe=r=>{r.target.checked&&!l.configured&&(p.webdav.enabled=!1,k('è¯·å…ˆåœ¨"WebDAVå¤‡ä»½"æ ‡ç­¾é¡µé…ç½®WebDAVè¿æ¥',"error"),o.value="webdav")},E=()=>C(null,null,function*(){i.webdavList=!0;const r=yield f("/api/backup/webdav/list");r.success?$.value=r.backups||[]:k("è·å–WebDAVå¤‡ä»½åˆ—è¡¨å¤±è´¥","error"),i.webdavList=!1}),ne=r=>C(null,null,function*(){k("æ­£åœ¨ä» WebDAV æ¢å¤å¤‡ä»½ï¼Œè¯·ç¨å€™..."),i.webdavRestore=!0;try{const t=yield f("/api/backup/webdav/restore",{method:"POST",body:JSON.stringify({filename:r})});t.success?(k("âœ“ å¤‡ä»½å·²æ¢å¤ï¼Œæ­£åœ¨é‡æ–°åŠ è½½æ•°æ®..."),yield new Promise(P=>setTimeout(P,2e3)),yield Promise.all([I(),T(),E(),G()]),k("âœ“ æ¢å¤å®Œæˆï¼æ•°æ®å·²æ›´æ–°","success",5e3)):k("âœ— "+(t.message||"ä» WebDAV æ¢å¤å¤±è´¥"),"error")}catch(t){k("âœ— æ¢å¤å¤±è´¥: "+t.message,"error")}finally{i.webdavRestore=!1}}),ie=r=>C(null,null,function*(){k("æ­£åœ¨åˆ é™¤ WebDAV å¤‡ä»½..."),i.webdavDelete=!0;try{const t=yield f(`/api/backup/webdav/delete/${r}`,{method:"DELETE"});t.success?(k("âœ“ åˆ é™¤æˆåŠŸ"),yield E()):k("âœ— "+(t.message||"åˆ é™¤å¤±è´¥"),"error")}catch(t){k("âœ— åˆ é™¤å¤±è´¥: "+t.message,"error")}finally{i.webdavDelete=!1}}),G=()=>C(null,null,function*(){const r=yield f("/api/backup/auto/config");r.success&&r.config?(Object.assign(p,r.config),y.value=r.stats||null):k("åŠ è½½è‡ªåŠ¨å¤‡ä»½é…ç½®å¤±è´¥","error")}),de=()=>C(null,null,function*(){i.autoBackupConfig=!0;const r=yield f("/api/backup/auto/config",{method:"POST",body:JSON.stringify(p)});r.success?(k("è‡ªåŠ¨å¤‡ä»½é…ç½®ä¿å­˜æˆåŠŸï¼"),yield G()):k(r.message||"è‡ªåŠ¨å¤‡ä»½é…ç½®ä¿å­˜å¤±è´¥","error"),i.autoBackupConfig=!1}),V=()=>{if(!p.scheduled.enabled)return"æœªå¯ç”¨";const r=String(p.scheduled.hour).padStart(2,"0"),t=String(p.scheduled.minute).padStart(2,"0");return`æ¯å¤© ${r}:${t}`};return Q(()=>C(null,null,function*(){yield I(),yield T(),l.configured&&(yield E()),yield G()})),(r,t)=>{var P;return u(),c("div",Ma,[e("div",Va,[e("button",{class:z(["tab",{active:o.value==="local"}]),onClick:t[0]||(t[0]=b=>o.value="local")}," ğŸ“¦ æœ¬åœ°å¤‡ä»½ ",2),e("button",{class:z(["tab",{active:o.value==="webdav"}]),onClick:t[1]||(t[1]=b=>o.value="webdav")}," â˜ï¸ WebDAVå¤‡ä»½ ",2),e("button",{class:z(["tab",{active:o.value==="auto"}]),onClick:t[2]||(t[2]=b=>o.value="auto")}," âš™ï¸ è‡ªåŠ¨å¤‡ä»½é…ç½® ",2)]),_(e("div",Ba,[e("div",Ua,[e("button",{class:"btn btn-primary",onClick:J,disabled:i.create},[t[25]||(t[25]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"})],-1)),N(" "+h(i.create?"å¤‡ä»½ä¸­...":"åˆ›å»ºå¤‡ä»½"),1)],8,Aa),e("button",{class:"btn btn-success",onClick:me,disabled:i.upload},[t[26]||(t[26]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5-5 5 5M12 15V3"})],-1)),N(" "+h(i.upload?"ä¸Šä¼ ä¸­...":"ä¸Šä¼ å¤‡ä»½"),1)],8,Da),e("button",{class:"btn btn-secondary",onClick:I,disabled:i.list},[t[27]||(t[27]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)),N(" "+h(i.list?"åˆ·æ–°ä¸­...":"åˆ·æ–°åˆ—è¡¨"),1)],8,Sa),e("input",{ref_key:"fileInput",ref:B,type:"file",accept:".zip",onChange:be,style:{display:"none"}},null,544)]),a.value.text?(u(),c("div",{key:0,class:z(["message",a.value.type])},h(a.value.text),3)):W("",!0),e("div",Ta,[g.value.length===0&&!i.list?(u(),c("div",Ia,[...t[28]||(t[28]=[e("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"#ccc","stroke-width":"1.5"},[e("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e("circle",{cx:"12",cy:"7",r:"4"})],-1),e("p",null,"æš‚æ— å¤‡ä»½æ–‡ä»¶",-1)])])):(u(),c("div",La,[(u(!0),c(H,null,O(g.value,b=>(u(),c("div",{key:b.name,class:"backup-card"},[t[33]||(t[33]=e("div",{class:"backup-icon"},[e("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2"},[e("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e("polyline",{points:"14 2 14 8 20 8"})])],-1)),e("div",Wa,[e("div",Na,h(b.name),1),e("div",za,[e("span",Pa,h(b.size),1),e("span",Ha,h(te(b.created)),1),b.signed?(u(),c("span",Oa,"ğŸ”’")):(u(),c("span",Fa,"âš ï¸"))])]),e("div",Ra,[e("button",{class:"btn-icon btn-restore",onClick:j=>X("restore",b),title:"æ¢å¤å¤‡ä»½"},[...t[29]||(t[29]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)])],8,ja),e("button",{class:"btn-icon btn-rename",onClick:j=>R(b.name),title:"é‡å‘½å"},[...t[30]||(t[30]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,Ea),e("button",{class:"btn-icon",onClick:j=>pe(b.name),title:"ä¸‹è½½å¤‡ä»½"},[...t[31]||(t[31]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"})],-1)])],8,qa),e("button",{class:"btn-icon btn-danger",onClick:j=>X("delete",b.name),title:"åˆ é™¤å¤‡ä»½"},[...t[32]||(t[32]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"3 6 5 6 21 6"}),e("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})],-1)])],8,Ja)])]))),128))]))])],512),[[ge,o.value==="local"]]),_(e("div",Ga,[e("div",Ka,[e("button",{class:"btn btn-primary",onClick:m},[...t[34]||(t[34]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"3"}),e("path",{d:"M12 1v6m0 6v6M5.64 5.64l4.24 4.24m4.24 4.24l4.24 4.24M1 12h6m6 0h6M5.64 18.36l4.24-4.24m4.24-4.24l4.24-4.24"})],-1),N(" WebDAVé…ç½® ",-1)])]),e("button",{class:"btn btn-primary",onClick:ae,disabled:i.webdavBackup||!l.configured},[t[35]||(t[35]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"})],-1)),N(" "+h(i.webdavBackup?"å¤‡ä»½ä¸­...":"å¤‡ä»½åˆ°WebDAV"),1)],8,Qa),e("button",{class:"btn btn-secondary",onClick:E,disabled:i.webdavList||!l.configured},[t[36]||(t[36]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)),N(" "+h(i.webdavList?"åˆ·æ–°ä¸­...":"åˆ·æ–°åˆ—è¡¨"),1)],8,Xa)]),a.value.text?(u(),c("div",{key:0,class:z(["message",a.value.type])},h(a.value.text),3)):W("",!0),l.configured?W("",!0):(u(),c("div",Ya,[...t[37]||(t[37]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),e("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})],-1),e("p",null,"è¯·å…ˆé…ç½®WebDAVè¿æ¥ä¿¡æ¯ï¼ˆæ”¯æŒï¼šåšæœäº‘ã€Nextcloudã€é˜¿é‡Œäº‘ç›˜WebDAVã€Dropboxç­‰ï¼‰",-1)])])),e("div",Za,[$.value.length===0&&!i.webdavList?(u(),c("div",eo,[...t[38]||(t[38]=[e("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"#ccc","stroke-width":"1.5"},[e("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e("circle",{cx:"12",cy:"7",r:"4"})],-1),e("p",null,"æš‚æ— WebDAVå¤‡ä»½",-1)])])):(u(),c("div",to,[(u(!0),c(H,null,O($.value,b=>(u(),c("div",{key:b.name,class:"backup-card"},[t[41]||(t[41]=le('<div class="backup-icon" data-v-b8ebf567><svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#16a34a" stroke-width="2" data-v-b8ebf567><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" data-v-b8ebf567></path><polyline points="14 2 14 8 20 8" data-v-b8ebf567></polyline><path d="M12 18v-6M9 15l3 3 3-3" data-v-b8ebf567></path></svg></div>',1)),e("div",so,[e("div",lo,h(b.name),1),e("div",ao,[e("span",oo,h(b.size),1),e("span",no,h(te(b.created)),1)])]),e("div",io,[e("button",{class:"btn-icon btn-restore",onClick:j=>X("webdav-restore",b.name),title:"ä»WebDAVæ¢å¤"},[...t[39]||(t[39]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)])],8,ro),e("button",{class:"btn-icon btn-danger",onClick:j=>X("webdav-delete",b.name),title:"åˆ é™¤WebDAVå¤‡ä»½"},[...t[40]||(t[40]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"3 6 5 6 21 6"}),e("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})],-1)])],8,uo)])]))),128))]))])],512),[[ge,o.value==="webdav"]]),_(e("div",co,[a.value.text?(u(),c("div",{key:0,class:z(["message",a.value.type])},h(a.value.text),3)):W("",!0),e("div",vo,[t[76]||(t[76]=e("h3",null,"âš¡ è‡ªåŠ¨å¤‡ä»½é…ç½®",-1)),t[77]||(t[77]=e("p",{class:"config-description"},"é…ç½®ç³»ç»Ÿè‡ªåŠ¨å¤‡ä»½ç­–ç•¥ï¼ŒåŒ…æ‹¬å¢é‡å¤‡ä»½å’Œå®šæ—¶å¤‡ä»½ã€‚",-1)),e("div",po,[e("div",mo,[t[43]||(t[43]=e("h4",null,"å¢é‡å¤‡ä»½ï¼ˆé˜²æŠ–ï¼‰",-1)),e("label",bo,[_(e("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=b=>p.debounce.enabled=b)},null,512),[[ee,p.debounce.enabled]]),t[42]||(t[42]=e("span",{class:"slider"},null,-1))])]),t[48]||(t[48]=e("p",{class:"config-info"},"å½“æ•°æ®å˜æ›´æ—¶ï¼Œå»¶è¿Ÿä¸€æ®µæ—¶é—´åè‡ªåŠ¨å¤‡ä»½ã€‚é€‚åˆé¢‘ç¹ä¿®æ”¹çš„åœºæ™¯ã€‚",-1)),p.debounce.enabled?(u(),c("div",go,[e("div",fo,[t[44]||(t[44]=e("label",null,"å»¶è¿Ÿæ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰",-1)),_(e("input",{type:"number","onUpdate:modelValue":t[4]||(t[4]=b=>p.debounce.delay=b),min:"5",max:"1440",class:"form-input"},null,512),[[U,p.debounce.delay,void 0,{number:!0}]]),t[45]||(t[45]=e("small",null,"æ•°æ®ä¿®æ”¹åå»¶è¿Ÿå¤šä¹…è§¦å‘å¤‡ä»½ï¼ŒèŒƒå›´ï¼š5-1440åˆ†é’Ÿ",-1))]),e("div",ho,[t[46]||(t[46]=e("label",null,"ä¿ç•™å¤‡ä»½æ•°é‡",-1)),_(e("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=b=>p.debounce.keep=b),min:"1",max:"30",class:"form-input"},null,512),[[U,p.debounce.keep,void 0,{number:!0}]]),t[47]||(t[47]=e("small",null,"è‡ªåŠ¨æ¸…ç†æ—¶ä¿ç•™æœ€æ–°çš„Nä¸ªå¤‡ä»½ï¼ŒèŒƒå›´ï¼š1-30ä¸ª",-1))])])):W("",!0)]),e("div",wo,[e("div",ko,[t[50]||(t[50]=e("h4",null,"å®šæ—¶å¤‡ä»½ï¼ˆæ¯æ—¥ï¼‰",-1)),e("label",yo,[_(e("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=b=>p.scheduled.enabled=b)},null,512),[[ee,p.scheduled.enabled]]),t[49]||(t[49]=e("span",{class:"slider"},null,-1))])]),t[58]||(t[58]=e("p",{class:"config-info"},"æ¯å¤©åœ¨å›ºå®šæ—¶é—´è‡ªåŠ¨æ‰§è¡Œå¤‡ä»½ã€‚",-1)),p.scheduled.enabled?(u(),c("div",_o,[e("div",$o,[t[52]||(t[52]=e("label",null,"å¤‡ä»½æ—¶é—´",-1)),e("div",Co,[_(e("input",{type:"number","onUpdate:modelValue":t[7]||(t[7]=b=>p.scheduled.hour=b),min:"0",max:"23",class:"form-input time-field",placeholder:"æ—¶"},null,512),[[U,p.scheduled.hour,void 0,{number:!0}]]),t[51]||(t[51]=e("span",null,":",-1)),_(e("input",{type:"number","onUpdate:modelValue":t[8]||(t[8]=b=>p.scheduled.minute=b),min:"0",max:"59",class:"form-input time-field",placeholder:"åˆ†"},null,512),[[U,p.scheduled.minute,void 0,{number:!0}]])]),t[53]||(t[53]=e("small",null,"æ ¼å¼ï¼š24å°æ—¶åˆ¶ï¼Œå¦‚ 02:00",-1))]),e("div",xo,[t[54]||(t[54]=e("label",null,"ä¿ç•™å¤‡ä»½æ•°é‡",-1)),_(e("input",{type:"number","onUpdate:modelValue":t[9]||(t[9]=b=>p.scheduled.keep=b),min:"1",max:"30",class:"form-input"},null,512),[[U,p.scheduled.keep,void 0,{number:!0}]]),t[55]||(t[55]=e("small",null,"è‡ªåŠ¨æ¸…ç†æ—¶ä¿ç•™æœ€æ–°çš„Nä¸ªå¤‡ä»½ï¼ŒèŒƒå›´ï¼š1-30ä¸ª",-1))]),e("div",Mo,[e("label",Vo,[_(e("input",{type:"checkbox","onUpdate:modelValue":t[10]||(t[10]=b=>p.scheduled.onlyIfModified=b)},null,512),[[ee,p.scheduled.onlyIfModified]]),t[56]||(t[56]=e("span",null,"ä»…åœ¨æœ‰ä¿®æ”¹æ—¶å¤‡ä»½",-1))]),t[57]||(t[57]=e("small",null,"å¦‚æœ24å°æ—¶å†…å·²æœ‰å¢é‡å¤‡ä»½ï¼Œè·³è¿‡å®šæ—¶å¤‡ä»½ï¼ˆé¿å…é‡å¤ï¼‰",-1))])])):W("",!0)]),e("div",Bo,[e("div",Uo,[t[60]||(t[60]=e("h4",null,"â˜ï¸ WebDAV è‡ªåŠ¨åŒæ­¥",-1)),e("label",Ao,[_(e("input",{type:"checkbox","onUpdate:modelValue":t[11]||(t[11]=b=>p.webdav.enabled=b),onChange:oe},null,544),[[ee,p.webdav.enabled]]),t[59]||(t[59]=e("span",{class:"slider"},null,-1))])]),e("p",Do,[t[61]||(t[61]=N(" è‡ªåŠ¨å°†æœ¬åœ°å¤‡ä»½åŒæ­¥åˆ° WebDAV äº‘ç«¯ã€‚ ",-1)),l.configured?W("",!0):(u(),c("span",So,'âš ï¸ è¯·å…ˆåœ¨"WebDAVå¤‡ä»½"æ ‡ç­¾é¡µé…ç½®è¿æ¥'))]),p.webdav.enabled?(u(),c("div",To,[e("div",Io,[e("label",Lo,[_(e("input",{type:"checkbox","onUpdate:modelValue":t[12]||(t[12]=b=>p.webdav.syncDaily=b)},null,512),[[ee,p.webdav.syncDaily]]),t[62]||(t[62]=e("span",null,"åŒæ­¥æ¯æ—¥å®šæ—¶å¤‡ä»½",-1))]),t[63]||(t[63]=e("small",null,"æ¯å¤©å®šæ—¶å¤‡ä»½åè‡ªåŠ¨ä¸Šä¼ åˆ° WebDAV",-1))]),e("div",Wo,[e("label",No,[_(e("input",{type:"checkbox","onUpdate:modelValue":t[13]||(t[13]=b=>p.webdav.syncIncremental=b)},null,512),[[ee,p.webdav.syncIncremental]]),t[64]||(t[64]=e("span",null,"åŒæ­¥å¢é‡å¤‡ä»½",-1))]),t[65]||(t[65]=e("small",null,"å¢é‡å¤‡ä»½åè‡ªåŠ¨ä¸Šä¼ åˆ° WebDAV",-1))])])):W("",!0)]),e("div",zo,[e("div",Po,[t[67]||(t[67]=e("h4",null,"è‡ªåŠ¨æ¸…ç†",-1)),e("label",Ho,[_(e("input",{type:"checkbox","onUpdate:modelValue":t[14]||(t[14]=b=>p.autoClean=b)},null,512),[[ee,p.autoClean]]),t[66]||(t[66]=e("span",{class:"slider"},null,-1))])]),t[68]||(t[68]=e("p",{class:"config-info"},"è‡ªåŠ¨åˆ é™¤è¶…å‡ºä¿ç•™æ•°é‡çš„æ—§å¤‡ä»½æ–‡ä»¶ï¼ˆæŒ‰æ—¶é—´æ’åºï¼Œä¿ç•™æœ€æ–°çš„ï¼‰ã€‚",-1))]),y.value?(u(),c("div",Oo,[t[73]||(t[73]=e("h4",null,"ğŸ“Š å¤‡ä»½ç»Ÿè®¡",-1)),e("div",Fo,[e("div",Ro,[t[69]||(t[69]=e("span",{class:"stat-label"},"å¢é‡å¤‡ä»½æ•°é‡",-1)),e("span",jo,h(((P=y.value.incremental)==null?void 0:P.count)||0)+" ä¸ª",1)]),e("div",Eo,[t[70]||(t[70]=e("span",{class:"stat-label"},"æœ€åå¢é‡å¤‡ä»½",-1)),e("span",qo,h(te(y.value.lastDebounce)||"æ— "),1)]),e("div",Jo,[t[71]||(t[71]=e("span",{class:"stat-label"},"æœ€åå®šæ—¶å¤‡ä»½",-1)),e("span",Go,h(te(y.value.lastScheduled)||"æ— "),1)]),e("div",Ko,[t[72]||(t[72]=e("span",{class:"stat-label"},"ä¸‹æ¬¡å®šæ—¶å¤‡ä»½",-1)),e("span",Qo,h(V()),1)])])])):W("",!0),e("div",Xo,[e("button",{class:"btn btn-secondary",onClick:G},[...t[74]||(t[74]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1),N(" é‡ç½® ",-1)])]),e("button",{class:"btn btn-primary",onClick:de,disabled:i.autoBackupConfig},[t[75]||(t[75]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),e("polyline",{points:"17 21 17 13 7 13 7 21"}),e("polyline",{points:"7 3 7 8 15 8"})],-1)),N(" "+h(i.autoBackupConfig?"ä¿å­˜ä¸­...":"ä¿å­˜é…ç½®"),1)],8,Yo)])])],512),[[ge,o.value==="auto"]]),M.value?(u(),c("div",Zo,[e("div",en,[t[82]||(t[82]=e("h3",null,"WebDAVé…ç½®",-1)),e("div",tn,[t[78]||(t[78]=e("label",null,[N("WebDAV URL "),e("span",{class:"required"},"*")],-1)),_(e("input",{type:"text","onUpdate:modelValue":t[15]||(t[15]=b=>d.url=b),placeholder:"https://dav.jianguoyun.com/dav/",class:"form-input"},null,512),[[U,d.url]]),t[79]||(t[79]=e("small",null,"ä¾‹ï¼šåšæœäº‘ https://dav.jianguoyun.com/dav/",-1))]),e("div",sn,[t[80]||(t[80]=e("label",null,[N("ç”¨æˆ·å "),e("span",{class:"required"},"*")],-1)),_(e("input",{type:"text","onUpdate:modelValue":t[16]||(t[16]=b=>d.username=b),placeholder:"é‚®ç®±æˆ–ç”¨æˆ·å",class:"form-input"},null,512),[[U,d.username]])]),e("div",ln,[t[81]||(t[81]=e("label",null,[N("å¯†ç  "),e("span",{class:"required"},"*")],-1)),_(e("input",{type:"password","onUpdate:modelValue":t[17]||(t[17]=b=>d.password=b),placeholder:l.configured?"ç•™ç©ºåˆ™ä¿æŒåŸå¯†ç ä¸å˜":"åº”ç”¨å¯†ç æˆ–è®¿é—®ä»¤ç‰Œ",class:"form-input"},null,8,an),[[U,d.password]]),l.configured?(u(),c("small",nn,"å¦‚éœ€ä¿®æ”¹å¯†ç è¯·è¾“å…¥æ–°å¯†ç ï¼Œç•™ç©ºåˆ™ä¿æŒåŸå¯†ç ä¸å˜")):(u(),c("small",on,"æ³¨æ„ï¼šæŸäº›æœåŠ¡éœ€è¦ä½¿ç”¨åº”ç”¨ä¸“ç”¨å¯†ç ï¼Œè€Œä¸æ˜¯ç™»å½•å¯†ç "))]),e("div",dn,[e("button",{class:"btn btn-secondary",onClick:t[18]||(t[18]=b=>M.value=!1)},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:K,disabled:i.webdavConfig},h(i.webdavConfig?"æµ‹è¯•è¿æ¥ä¸­...":"ä¿å­˜"),9,rn)])])])):W("",!0),s.show?(u(),c("div",un,[e("div",cn,[e("h3",null,"ç¡®è®¤"+h(s.title),1),e("p",vn,h(s.message),1),e("div",pn,[e("button",{class:"btn btn-secondary",onClick:t[19]||(t[19]=b=>s.show=!1),disabled:s.processing},"å–æ¶ˆ",8,mn),e("button",{class:z(["btn",s.confirmClass]),onClick:Y,disabled:s.processing},h(s.processing?"å¤„ç†ä¸­...":"ç¡®è®¤"),11,bn)])])])):W("",!0),A.value?(u(),c("div",gn,[e("div",fn,[t[86]||(t[86]=e("h3",null,"åˆ›å»ºå¤‡ä»½",-1)),e("div",hn,[t[83]||(t[83]=e("label",null,"å¤‡ä»½åç§°ï¼ˆå¯é€‰ï¼‰",-1)),_(e("input",{type:"text","onUpdate:modelValue":t[20]||(t[20]=b=>v.name=b),placeholder:"ä¾‹å¦‚ï¼šæ·»åŠ ä¹¦ç­¾åçš„å¤‡ä»½",class:"form-input",maxlength:"50"},null,512),[[U,v.name]]),t[84]||(t[84]=e("small",null,"ç•™ç©ºåˆ™ä½¿ç”¨é»˜è®¤åç§°ï¼ˆbackup-æ—¶é—´æˆ³ï¼‰",-1))]),e("div",wn,[t[85]||(t[85]=e("label",null,"å¤‡ä»½æè¿°ï¼ˆå¯é€‰ï¼‰",-1)),_(e("textarea",{"onUpdate:modelValue":t[21]||(t[21]=b=>v.description=b),placeholder:"æè¿°è¿™æ¬¡å¤‡ä»½çš„å†…å®¹æˆ–ç›®çš„...",class:"form-input",rows:"3"},null,512),[[U,v.description]])]),e("div",kn,[e("button",{class:"btn btn-secondary",onClick:t[22]||(t[22]=b=>A.value=!1)},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:F,disabled:i.create},h(i.create?"å¤‡ä»½ä¸­...":"åˆ›å»ºå¤‡ä»½"),9,yn)])])])):W("",!0),D.value?(u(),c("div",_n,[e("div",$n,[t[88]||(t[88]=e("h3",null,"é‡å‘½åå¤‡ä»½",-1)),e("div",Cn,[t[87]||(t[87]=e("label",null,[N("æ–°åç§° "),e("span",{class:"required"},"*")],-1)),_(e("input",{type:"text","onUpdate:modelValue":t[23]||(t[23]=b=>n.newName=b),placeholder:"è¾“å…¥æ–°çš„å¤‡ä»½åç§°",class:"form-input",maxlength:"50"},null,512),[[U,n.newName]]),e("small",null,"åŸåç§°ï¼š"+h(n.oldName),1)]),e("div",xn,[e("button",{class:"btn btn-secondary",onClick:t[24]||(t[24]=b=>D.value=!1)},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:x,disabled:i.rename||!n.newName.trim()},h(i.rename?"é‡å‘½åä¸­...":"ç¡®è®¤é‡å‘½å"),9,Mn)])])])):W("",!0)])}}},Bn=q(Vn,[["__scopeId","data-v-b8ebf567"]]),Un={key:0,class:"login-container"},An={class:"login-card"},Dn={class:"login-form"},Sn={class:"password-input-wrapper"},Tn=["type"],In={key:0,width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},Ln={key:1,width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},Wn={class:"login-buttons"},Nn=["disabled"],zn={key:0,class:"login-error"},Pn={key:1,class:"admin-layout"},Hn={class:"menu-list"},On={class:"admin-main"},Fn={class:"admin-header"},Rn={class:"header-title"},jn={class:"admin-content"},En={__name:"Admin",setup(L){const o=w("welcome"),g={welcome:yt,menu:Gt,card:Is,duplicate:fl,tag:Ll,ad:Xl,friend:ia,user:xa,backup:Bn},$=ce(()=>g[o.value]),M=ce(()=>o.value==="welcome"?{lastLoginTime:A.value,lastLoginIp:D.value,currentUsername:B.value}:{}),A=w(""),D=w(""),B=w("admin"),i=w(!1),v=w(""),n=w(""),a=w(!1),s=w(""),l=w(!1),d=w(!1),p=ce(()=>{switch(o.value){case"menu":return"æ ç›®ç®¡ç†";case"card":return"å¡ç‰‡ç®¡ç†";case"duplicate":return"å»é‡ç®¡ç†";case"tag":return"æ ‡ç­¾ç®¡ç†";case"ad":return"å¹¿å‘Šç®¡ç†";case"friend":return"å‹é“¾ç®¡ç†";case"user":return"ç”¨æˆ·ç®¡ç†";case"backup":return"å¤‡ä»½ç®¡ç†";default:return""}});Q(()=>{const R=localStorage.getItem("token");i.value=!!R,i.value&&y()});function y(){return C(this,null,function*(){try{const R=yield fetch("/api/users/me",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(R.ok){const x=yield R.json();A.value=x.last_login_time||"",D.value=x.last_login_ip||"",B.value=x.username||"admin"}}catch(R){console.error("è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:",R)}})}function S(){return C(this,null,function*(){var R,x;if(!v.value||!n.value){s.value="è¯·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ";return}a.value=!0,s.value="";try{const I=yield vt(v.value,n.value);I.data.token&&(localStorage.setItem("token",I.data.token),i.value=!0,A.value=I.data.lastLoginTime||"",D.value=I.data.lastLoginIp||"",yield y())}catch(I){s.value=((x=(R=I.response)==null?void 0:R.data)==null?void 0:x.message)||"ç™»å½•å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç”¨æˆ·åå’Œå¯†ç "}finally{a.value=!1}})}function f(){localStorage.removeItem("token"),i.value=!1,v.value="",n.value="",s.value=""}function k(){window.open("/","_blank")}function J(){d.value=!d.value}function F(){d.value=!1}return(R,x)=>i.value?(u(),c("div",Pn,[e("aside",{class:z(["admin-sider",{open:d.value}]),onClick:ve(F,["self"])},[e("div",{class:"logo clickable",onClick:x[3]||(x[3]=I=>{o.value="welcome",F()})},"Admin"),e("ul",Hn,[e("li",{class:z({active:o.value==="menu"}),onClick:x[4]||(x[4]=I=>{o.value="menu",F()})},"æ ç›®ç®¡ç†",2),e("li",{class:z({active:o.value==="card"}),onClick:x[5]||(x[5]=I=>{o.value="card",F()})},"å¡ç‰‡ç®¡ç†",2),e("li",{class:z({active:o.value==="duplicate"}),onClick:x[6]||(x[6]=I=>{o.value="duplicate",F()})},"å»é‡ç®¡ç†",2),e("li",{class:z({active:o.value==="tag"}),onClick:x[7]||(x[7]=I=>{o.value="tag",F()})},"æ ‡ç­¾ç®¡ç†",2),e("li",{class:z({active:o.value==="ad"}),onClick:x[8]||(x[8]=I=>{o.value="ad",F()})},"å¹¿å‘Šç®¡ç†",2),e("li",{class:z({active:o.value==="friend"}),onClick:x[9]||(x[9]=I=>{o.value="friend",F()})},"å‹é“¾ç®¡ç†",2),e("li",{class:z({active:o.value==="user"}),onClick:x[10]||(x[10]=I=>{o.value="user",F()})},"ç”¨æˆ·ç®¡ç†",2),e("li",{class:z({active:o.value==="backup"}),onClick:x[11]||(x[11]=I=>{o.value="backup",F()})},"å¤‡ä»½ç®¡ç†",2)])],2),e("main",On,[e("div",Fn,[e("button",{class:"menu-toggle",onClick:J}," â˜° "),e("div",Rn,h(p.value),1),e("div",{class:"header-actions"},[e("span",{class:"home-icon",onClick:k,title:"è¿›å…¥ä¸»é¡µ"},[...x[16]||(x[16]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},[e("path",{d:"M3 10.5L12 4l9 6.5V20a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1v-4h-4v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V10.5z",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])]),e("button",{class:"btn logout-btn",onClick:f},"é€€å‡ºç™»å½•")])]),e("div",jn,[Le(Ne,{name:"fade",mode:"out-in"},{default:We(()=>[(u(),ze(Pe($.value),He({key:o.value},M.value),null,16))]),_:1})]),x[17]||(x[17]=e("footer",{class:"admin-footer"},[e("p",{class:"admin-copyright"},[N("Copyright Â© 2025 Con-Nav-Item | "),e("a",{href:"https://github.com/zczy-k/Con-Nav-Item",target:"_blank",class:"footer-link"},"Powered by zczy-k")])],-1))])])):(u(),c("div",Un,[e("div",An,[x[15]||(x[15]=e("h2",{class:"login-title"},"åå°ç®¡ç†ç™»å½•",-1)),e("div",Dn,[_(e("input",{"onUpdate:modelValue":x[0]||(x[0]=I=>v.value=I),type:"text",placeholder:"ç”¨æˆ·åï¼ˆé»˜è®¤ï¼šadminï¼‰",class:"login-input",onKeyup:$e(S,["enter"])},null,544),[[U,v.value]]),e("div",Sn,[_(e("input",{"onUpdate:modelValue":x[1]||(x[1]=I=>n.value=I),type:l.value?"text":"password",placeholder:"å¯†ç ï¼ˆé»˜è®¤ï¼š123456ï¼‰",class:"login-input password-input",onKeyup:$e(S,["enter"])},null,40,Tn),[[Ie,n.value]]),e("span",{class:"toggle-password",onClick:x[2]||(x[2]=I=>l.value=!l.value)},[l.value?(u(),c("svg",In,[...x[12]||(x[12]=[e("path",{d:"M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12z"},null,-1),e("circle",{cx:"12",cy:"12",r:"3"},null,-1)])])):(u(),c("svg",Ln,[...x[13]||(x[13]=[e("path",{d:"M17.94 17.94A10.94 10.94 0 0 1 12 19c-7 0-11-7-11-7a21.77 21.77 0 0 1 5.06-6.06"},null,-1),e("path",{d:"M1 1l22 22"},null,-1),e("path",{d:"M9.53 9.53A3 3 0 0 0 12 15a3 3 0 0 0 2.47-5.47"},null,-1)])]))])]),e("div",Wn,[e("button",{onClick:k,class:"back-btn"},[...x[14]||(x[14]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1),N(" è¿”å›é¦–é¡µ ",-1)])]),e("button",{onClick:S,class:"login-btn",disabled:a.value},h(a.value?"ç™»å½•ä¸­...":"ç™»å½•"),9,Nn)]),s.value?(u(),c("p",zn,h(s.value),1)):W("",!0)])])]))}},Kn=q(En,[["__scopeId","data-v-2762ba0b"]]);export{Kn as default};
