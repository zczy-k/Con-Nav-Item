var Se=Object.defineProperty,Te=Object.defineProperties;var Ie=Object.getOwnPropertyDescriptors;var ke=Object.getOwnPropertySymbols;var Le=Object.prototype.hasOwnProperty,We=Object.prototype.propertyIsEnumerable;var ye=(W,i,w)=>i in W?Se(W,i,{enumerable:!0,configurable:!0,writable:!0,value:w}):W[i]=w,se=(W,i)=>{for(var w in i||(i={}))Le.call(i,w)&&ye(W,w,i[w]);if(ke)for(var w of ke(i))We.call(i,w)&&ye(W,w,i[w]);return W},ue=(W,i)=>Te(W,Ie(i));var x=(W,i,w)=>new Promise((M,V)=>{var $=d=>{try{S(w.next(d))}catch(b){V(b)}},B=d=>{try{S(w.throw(d))}catch(b){V(b)}},S=d=>d.done?M(d.value):Promise.resolve(d.value).then($,B);S((w=w.apply(W,i)).next())});import{_ as J,c as p,o as v,b as e,t as y,z as le,r as _,g as Q,i as xe,k as Ve,d as L,n as z,T as Be,w as C,v as D,q as N,F as O,a as F,e as ce,A as _e,B as fe,x as we,j as ve,C as Z,y as ge,p as ee,l as $e,D as Ne,E as ze,G as Pe,H as He}from"./index-DBPlE-eO.js";import{g as Ue,q as Oe,r as Fe,s as Re,t as je,w as Ee,x as qe,c as Ae,i as Je,u as Ce,n as Me,e as Ge,y as Ke,z as Qe,A as he,B as Xe,C as Ye,D as Ze,E as et,a as tt,F as st,G as lt,H as at,b as ot,I as nt,J as it,K as dt,L as rt,M as ut,N as ct,O as vt}from"./urlNormalizer-BQ0ShDV0.js";const pt={class:"welcome-page"},mt={class:"welcome-title"},bt={class:"welcome-cards"},gt={class:"welcome-card"},ht={class:"welcome-value"},ft={class:"welcome-card"},wt={class:"welcome-value"},kt={__name:"WelcomePage",props:{lastLoginTime:String,lastLoginIp:String,currentUsername:String},setup(W){return(i,w)=>(v(),p("div",pt,[e("h2",mt,"æ¬¢è¿æ‚¨ï¼Œ"+y(W.currentUsername||"admin")+"ï¼",1),e("div",bt,[e("div",gt,[w[0]||(w[0]=le('<div class="welcome-icon time-icon" data-v-5cc4f846><svg width="32" height="32" viewBox="0 0 24 24" fill="none" data-v-5cc4f846><circle cx="12" cy="12" r="10" stroke="#1abc9c" stroke-width="2" data-v-5cc4f846></circle><path d="M12 6v6l4 2" stroke="#1abc9c" stroke-width="2" stroke-linecap="round" data-v-5cc4f846></path></svg></div><div class="welcome-label" data-v-5cc4f846>ä¸Šæ¬¡ç™»å½•æ—¶é—´</div>',2)),e("div",ht,y(W.lastLoginTime||"--"),1)]),e("div",ft,[w[1]||(w[1]=le('<div class="welcome-icon ip-icon" data-v-5cc4f846><svg width="32" height="32" viewBox="0 0 24 24" fill="none" data-v-5cc4f846><circle cx="12" cy="12" r="10" stroke="#1abc9c" stroke-width="2" data-v-5cc4f846></circle><path d="M12 8a4 4 0 1 1 0 8 4 4 0 0 1 0-8z" stroke="#1abc9c" stroke-width="2" data-v-5cc4f846></path><circle cx="12" cy="12" r="2" fill="#1abc9c" data-v-5cc4f846></circle></svg></div><div class="welcome-label" data-v-5cc4f846>ä¸Šæ¬¡ç™»å½•IP</div>',2)),e("div",wt,y(W.lastLoginIp||"--"),1)])])]))}},yt=J(kt,[["__scopeId","data-v-5cc4f846"]]),_t={class:"menu-manage"},$t={key:0,class:"spin",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Ct={key:1,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Mt={key:2,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},xt={class:"menu-header"},Vt={class:"menu-add"},Bt={class:"menu-content"},Ut={class:"menu-list"},At={class:"main-menu"},Dt={class:"menu-info"},St=["onUpdate:modelValue","onBlur"],Tt={class:"menu-order"},It=["onUpdate:modelValue","onBlur"],Lt={class:"menu-actions"},Wt=["onClick","title"],Nt=["onClick"],zt={class:"sub-menu-header"},Pt={class:"sub-menu-title"},Ht=["onClick"],Ot={key:0,class:"sub-menu-list"},Ft={class:"sub-menu-info"},Rt=["onUpdate:modelValue","onBlur"],jt={class:"sub-menu-order"},Et=["onUpdate:modelValue","onBlur"],qt={class:"sub-menu-actions"},Jt=["onClick"],Gt={key:1,class:"empty-sub-menu"},Kt=["onClick"],Qt={__name:"MenuManage",setup(W){const i=_([]),w=_(""),M=_({show:!1,type:"saving",message:""});let V=null;function $(o,s,r=2e3){V&&clearTimeout(V),M.value={show:!0,type:o,message:s},o!=="saving"&&(V=setTimeout(()=>{M.value.show=!1},r))}Q(B);function B(o=!1){return x(this,null,function*(){const s=i.value.filter(k=>k.showSubMenu).map(k=>k.id),r=yield Ue(o);i.value=r.data.map(k=>ue(se({},k),{subMenus:k.subMenus||[],showSubMenu:s.includes(k.id)}))})}function S(){return x(this,null,function*(){var o,s;if(w.value.trim()){$("saving","æ·»åŠ ä¸­...");try{const r=i.value.length?Math.max(...i.value.map(k=>k.order||0)):0;yield Oe({name:w.value.trim(),order:r+1}),w.value="",yield B(!0),$("success","æ·»åŠ æˆåŠŸ")}catch(r){$("error","æ·»åŠ å¤±è´¥ï¼š"+(((s=(o=r.response)==null?void 0:o.data)==null?void 0:s.error)||r.message),3e3)}}})}function d(o){return x(this,null,function*(){var s,r;$("saving","ä¿å­˜ä¸­...");try{yield Fe(o.id,{name:o.name,order:o.order}),yield B(!0),$("success","å·²ä¿å­˜")}catch(k){console.error("æ›´æ–°èœå•å¤±è´¥:",k),$("error","ä¿å­˜å¤±è´¥ï¼š"+(((r=(s=k.response)==null?void 0:s.data)==null?void 0:r.error)||k.message),3e3),yield B(!0)}})}function b(o){return x(this,null,function*(){var s,r;if(confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªä¸»èœå•å—ï¼Ÿåˆ é™¤åå°†åŒæ—¶åˆ é™¤å…¶ä¸‹çš„æ‰€æœ‰å­èœå•å’Œå¡ç‰‡ã€‚")){$("saving","åˆ é™¤ä¸­...");try{yield Re(o),yield B(!0),$("success","åˆ é™¤æˆåŠŸ")}catch(k){console.error("åˆ é™¤èœå•å¤±è´¥:",k),$("error","åˆ é™¤å¤±è´¥ï¼š"+(((r=(s=k.response)==null?void 0:s.data)==null?void 0:r.error)||k.message),3e3),yield B(!0)}}})}function n(o){return x(this,null,function*(){var k,m;const s=i.value.find(g=>g.id===o),r=prompt("è¯·è¾“å…¥å­èœå•åç§°ï¼š");if(r!=null&&r.trim()){$("saving","æ·»åŠ ä¸­...");try{const g=(s==null?void 0:s.subMenus)||[],E=g.length?Math.max(...g.map(H=>H.order||0)):0;yield je(o,{name:r.trim(),order:E+1}),yield B(!0),$("success","æ·»åŠ æˆåŠŸ")}catch(g){$("error","æ·»åŠ å¤±è´¥ï¼š"+(((m=(k=g.response)==null?void 0:k.data)==null?void 0:m.error)||g.message),3e3)}}})}function a(o){return x(this,null,function*(){var s,r;$("saving","ä¿å­˜ä¸­...");try{yield Ee(o.id,{name:o.name,order:o.order}),yield B(!0),$("success","å·²ä¿å­˜")}catch(k){console.error("æ›´æ–°å­èœå•å¤±è´¥:",k),$("error","ä¿å­˜å¤±è´¥ï¼š"+(((r=(s=k.response)==null?void 0:s.data)==null?void 0:r.error)||k.message),3e3),yield B(!0)}})}function l(o){return x(this,null,function*(){var s,r;if(confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå­èœå•å—ï¼Ÿåˆ é™¤åå°†åŒæ—¶åˆ é™¤å…¶ä¸‹çš„æ‰€æœ‰å¡ç‰‡ã€‚")){$("saving","åˆ é™¤ä¸­...");try{yield qe(o),yield B(!0),$("success","åˆ é™¤æˆåŠŸ")}catch(k){console.error("åˆ é™¤å­èœå•å¤±è´¥:",k),$("error","åˆ é™¤å¤±è´¥ï¼š"+(((r=(s=k.response)==null?void 0:s.data)==null?void 0:r.error)||k.message),3e3)}}})}function u(o){const s=i.value.find(r=>r.id===o);s&&(s.showSubMenu=!s.showSubMenu)}return(o,s)=>(v(),p("div",_t,[xe(Be,{name:"toast"},{default:Ve(()=>[M.value.show?(v(),p("div",{key:0,class:z(["save-toast",M.value.type])},[M.value.type==="saving"?(v(),p("svg",$t,[...s[1]||(s[1]=[e("path",{d:"M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"},null,-1)])])):M.value.type==="success"?(v(),p("svg",Ct,[...s[2]||(s[2]=[e("path",{d:"M20 6L9 17l-5-5"},null,-1)])])):(v(),p("svg",Mt,[...s[3]||(s[3]=[e("circle",{cx:"12",cy:"12",r:"10"},null,-1),e("path",{d:"M15 9l-6 6M9 9l6 6"},null,-1)])])),e("span",null,y(M.value.message),1)],2)):L("",!0)]),_:1}),e("div",xt,[s[5]||(s[5]=e("div",{class:"header-content"},[e("h2",{class:"page-title"},"ç®¡ç†ä¸»èœå•å’Œå­èœå•")],-1)),e("div",Vt,[C(e("input",{"onUpdate:modelValue":s[0]||(s[0]=r=>w.value=r),placeholder:"è¯·è¾“å…¥ä¸»èœå•åç§°",class:"input"},null,512),[[D,w.value]]),e("button",{class:"btn btn-primary",onClick:S},[...s[4]||(s[4]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),N(" æ·»åŠ ä¸»èœå• ",-1)])])])]),e("div",Bt,[e("div",Ut,[(v(!0),p(O,null,F(i.value,r=>{var k;return v(),p("div",{key:r.id,class:"menu-item"},[e("div",At,[e("div",Dt,[s[7]||(s[7]=e("div",{class:"menu-icon"},[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 3h18v18H3zM9 9h6v6H9z"})])],-1)),C(e("input",{"onUpdate:modelValue":m=>r.name=m,onBlur:m=>d(r),class:"menu-name-input"},null,40,St),[[D,r.name]]),e("div",Tt,[s[6]||(s[6]=e("span",{class:"order-label"},"æ’åº",-1)),C(e("input",{"onUpdate:modelValue":m=>r.order=m,type:"number",onBlur:m=>d(r),class:"order-input"},null,40,It),[[D,r.order,void 0,{number:!0}]])])]),e("div",Lt,[e("button",{class:"btn btn-icon expand-btn",onClick:m=>u(r.id),title:r.showSubMenu?"æ”¶èµ·å­èœå•":"å±•å¼€å­èœå•"},[...s[8]||(s[8]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"m6 9 6 6 6-6"})],-1)])],8,Wt),e("button",{class:"btn btn-danger btn-icon",onClick:m=>b(r.id),title:"åˆ é™¤ä¸»èœå•"},[...s[9]||(s[9]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)])],8,Nt)])]),e("div",{class:z(["sub-menu-section",{expanded:r.showSubMenu}])},[e("div",zt,[e("div",Pt,[s[10]||(s[10]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 11H1l8-8 8 8h-8v8z"})],-1)),N(" å­èœå• ("+y(((k=r.subMenus)==null?void 0:k.length)||0)+") ",1)]),e("button",{class:"btn btn-sm btn-outline",onClick:m=>n(r.id)},[...s[11]||(s[11]=[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),N(" æ·»åŠ å­èœå• ",-1)])],8,Ht)]),r.subMenus&&r.subMenus.length>0?(v(),p("div",Ot,[(v(!0),p(O,null,F(r.subMenus,m=>(v(),p("div",{key:m.id,class:"sub-menu-item"},[e("div",Ft,[s[12]||(s[12]=e("div",{class:"sub-menu-icon"},[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M4 6h16M4 12h16M4 18h16"})])],-1)),C(e("input",{"onUpdate:modelValue":g=>m.name=g,onBlur:g=>a(m),class:"sub-menu-name-input"},null,40,Rt),[[D,m.name]]),e("div",jt,[C(e("input",{"onUpdate:modelValue":g=>m.order=g,type:"number",onBlur:g=>a(m),class:"order-input"},null,40,Et),[[D,m.order,void 0,{number:!0}]])])]),e("div",qt,[e("button",{class:"btn btn-danger btn-icon btn-sm",onClick:g=>l(m.id),title:"åˆ é™¤å­èœå•"},[...s[13]||(s[13]=[e("svg",{width:"14",height:"14",viewBox:"0 0 22 22",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)])],8,Jt)])]))),128))])):(v(),p("div",Gt,[s[14]||(s[14]=e("p",null,"æš‚æ— å­èœå•",-1)),e("button",{class:"btn btn-sm btn-outline",onClick:m=>n(r.id)},"æ·»åŠ ç¬¬ä¸€ä¸ªå­èœå•",8,Kt)]))],2)])}),128))])])]))}},Xt=J(Qt,[["__scopeId","data-v-a7098c48"]]),Yt={class:"card-manage"},Zt={class:"card-header"},es={class:"card-add"},ts=["value"],ss=["value"],ls={class:"card-card"},as={class:"card-table"},os=["onUpdate:modelValue","onBlur"],ns=["onUpdate:modelValue","onBlur"],is=["onUpdate:modelValue","onBlur"],ds=["onUpdate:modelValue","onBlur"],rs=["onClick"],us={key:0,class:"selected-tags"},cs={key:1,class:"tag-placeholder"},vs=["onUpdate:modelValue","onBlur"],ps=["onClick"],ms={class:"modal-body"},bs={key:0,class:"empty-tags"},gs={key:1,class:"tag-options"},hs=["checked","onChange"],fs={class:"modal-body"},ws={class:"duplicate-comparison"},ks={class:"card-info-box existing"},ys={class:"card-details"},_s={class:"detail-row"},$s={class:"detail-value"},Cs={class:"detail-row"},Ms={class:"detail-value url"},xs={key:0,class:"detail-row"},Vs={class:"detail-value url"},Bs={class:"card-info-box pending"},Us={class:"card-details"},As={class:"detail-row"},Ds={class:"detail-value"},Ss={class:"detail-row"},Ts={class:"detail-value url"},Is={key:0,class:"detail-row"},Ls={class:"detail-value url"},Ws={__name:"CardManage",setup(W){const i=_([]),w=_([]),M=_(),V=_(""),$=_(""),B=_(""),S=_(""),d=_([]),b=_(!1),n=_(null),a=_([]),l=_(!1),u=_(null),o=_(null),s=ce(()=>{if(!M.value)return[];const T=i.value.find(h=>h.id===M.value);return(T==null?void 0:T.subMenus)||[]});Q(()=>x(null,null,function*(){const T=yield Ue();i.value=T.data,i.value.length&&(M.value=i.value[0].id,V.value="");const h=yield Ae();d.value=h.data})),_e(M,()=>{V.value="",m()}),_e(V,m);function r(){V.value=""}function k(){m()}function m(){return x(this,null,function*(){if(!M.value)return;const T=yield Ge(M.value,V.value||null);w.value=T.data})}function g(){return x(this,null,function*(){if(!$.value||!B.value)return;const T=w.value.find(h=>Je({title:$.value,url:B.value},h));T?(u.value=T,o.value={menu_id:M.value,sub_menu_id:V.value||null,title:$.value,url:B.value,logo_url:S.value},l.value=!0):yield X({menu_id:M.value,sub_menu_id:V.value||null,title:$.value,url:B.value,logo_url:S.value})})}function E(T){return x(this,null,function*(){yield Ce(T.id,{menu_id:M.value,sub_menu_id:V.value||null,title:T.title,url:T.url,logo_url:T.logo_url,desc:T.desc,order:T.order,tagIds:T.tags?T.tags.map(h=>h.id):[]}),m()})}function H(T){return x(this,null,function*(){if(!confirm("ç¡®å®šè¦åˆ é™¤è¿™å¼ å¡ç‰‡å—ï¼Ÿ"))return;const h=w.value.findIndex(K=>K.id===T);h>-1&&w.value.splice(h,1);try{yield Me(T)}catch(K){console.error("åˆ é™¤å¡ç‰‡å¤±è´¥:",K),yield m()}})}function R(T){n.value=T,a.value=T.tags?T.tags.map(h=>h.id):[],b.value=!0}function U(){b.value=!1,n.value=null,a.value=[]}function I(T){const h=a.value.indexOf(T);h>-1?a.value.splice(h,1):a.value.push(T)}function pe(){return x(this,null,function*(){n.value&&(yield Ce(n.value.id,{menu_id:n.value.menu_id,sub_menu_id:n.value.sub_menu_id,title:n.value.title,url:n.value.url,logo_url:n.value.logo_url,desc:n.value.desc,order:n.value.order,tagIds:a.value}),U(),m())})}function X(T){return x(this,null,function*(){yield Ke(T),$.value="",B.value="",S.value="",m()})}function Y(){l.value=!1,u.value=null,o.value=null}function te(){Y(),$.value="",B.value="",S.value=""}function me(){return x(this,null,function*(){!o.value||!u.value||(yield Me(u.value.id),yield X(o.value),Y())})}function be(){o.value&&($.value=o.value.title,B.value=o.value.url,S.value=o.value.logo_url||"",Y(),alert("è¯·ä¿®æ”¹å¡ç‰‡ä¿¡æ¯åå†æ¬¡ç‚¹å‡»â€œæ·»åŠ å¡ç‰‡â€æŒ‰é’®"))}return(T,h)=>{var K,ae,oe,q,ne,ie,G,de;return v(),p("div",Yt,[e("div",Zt,[h[9]||(h[9]=e("div",{class:"header-content"},[e("h2",{class:"page-title"},"ç®¡ç†ç½‘ç«™å¯¼èˆªå¡ç‰‡ï¼Œæ”¯æŒä¸»èœå•å’Œå­èœå•åˆ†ç±»")],-1)),e("div",es,[C(e("select",{"onUpdate:modelValue":h[0]||(h[0]=A=>M.value=A),class:"input narrow",onChange:r},[(v(!0),p(O,null,F(i.value,A=>(v(),p("option",{value:A.id,key:A.id},y(A.name),9,ts))),128))],544),[[fe,M.value]]),C(e("select",{"onUpdate:modelValue":h[1]||(h[1]=A=>V.value=A),class:"input narrow",onChange:k},[h[7]||(h[7]=e("option",{value:""},"ä¸»èœå•",-1)),(v(!0),p(O,null,F(s.value,A=>(v(),p("option",{value:A.id,key:A.id},y(A.name),9,ss))),128))],544),[[fe,V.value]]),C(e("input",{"onUpdate:modelValue":h[2]||(h[2]=A=>$.value=A),placeholder:"å¡ç‰‡æ ‡é¢˜",class:"input narrow"},null,512),[[D,$.value]]),C(e("input",{"onUpdate:modelValue":h[3]||(h[3]=A=>B.value=A),placeholder:"å¡ç‰‡é“¾æ¥",class:"input wide"},null,512),[[D,B.value]]),C(e("input",{"onUpdate:modelValue":h[4]||(h[4]=A=>S.value=A),placeholder:"logoé“¾æ¥(å¯é€‰)",class:"input wide"},null,512),[[D,S.value]]),e("button",{class:"btn",onClick:g},[...h[8]||(h[8]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),N(" æ·»åŠ å¡ç‰‡ ",-1)])])])]),e("div",ls,[e("table",as,[h[11]||(h[11]=e("thead",null,[e("tr",null,[e("th",null,"æ ‡é¢˜"),e("th",null,"ç½‘å€"),e("th",null,"Logoé“¾æ¥"),e("th",null,"æè¿°"),e("th",null,"æ ‡ç­¾"),e("th",null,"æ’åº"),e("th",null,"æ“ä½œ")])],-1)),e("tbody",null,[(v(!0),p(O,null,F(w.value,A=>(v(),p("tr",{key:A.id},[e("td",null,[C(e("input",{"onUpdate:modelValue":c=>A.title=c,onBlur:c=>E(A),class:"table-input"},null,40,os),[[D,A.title]])]),e("td",null,[C(e("input",{"onUpdate:modelValue":c=>A.url=c,onBlur:c=>E(A),class:"table-input"},null,40,ns),[[D,A.url]])]),e("td",null,[C(e("input",{"onUpdate:modelValue":c=>A.logo_url=c,onBlur:c=>E(A),class:"table-input",placeholder:"logoé“¾æ¥(å¯é€‰)"},null,40,is),[[D,A.logo_url]])]),e("td",null,[C(e("input",{"onUpdate:modelValue":c=>A.desc=c,onBlur:c=>E(A),class:"table-input",placeholder:"æè¿°ï¼ˆå¯é€‰ï¼‰"},null,40,ds),[[D,A.desc]])]),e("td",null,[e("div",{class:"tag-selector",onClick:c=>R(A)},[A.tags&&A.tags.length>0?(v(),p("div",us,[(v(!0),p(O,null,F(A.tags,c=>(v(),p("span",{key:c.id,class:"mini-tag",style:we({backgroundColor:c.color})},y(c.name),5))),128))])):(v(),p("span",cs,"é€‰æ‹©æ ‡ç­¾"))],8,rs)]),e("td",null,[C(e("input",{"onUpdate:modelValue":c=>A.order=c,type:"number",onBlur:c=>E(A),class:"table-input order-input"},null,40,vs),[[D,A.order,void 0,{number:!0}]])]),e("td",null,[e("button",{class:"btn btn-danger btn-icon",onClick:c=>H(A.id),title:"åˆ é™¤"},[...h[10]||(h[10]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)])],8,ps)])]))),128))])])]),b.value?(v(),p("div",{key:0,class:"modal-overlay",onClick:U},[e("div",{class:"modal-content",onClick:h[5]||(h[5]=ve(()=>{},["stop"]))},[e("div",{class:"modal-header"},[h[12]||(h[12]=e("h3",null,"é€‰æ‹©æ ‡ç­¾",-1)),e("button",{class:"close-btn",onClick:U},"Ã—")]),e("div",ms,[d.value.length===0?(v(),p("div",bs,[...h[13]||(h[13]=[e("p",null,"æš‚æ— æ ‡ç­¾ï¼Œè¯·å…ˆåœ¨æ ‡ç­¾ç®¡ç†é¡µé¢åˆ›å»º",-1)])])):(v(),p("div",gs,[(v(!0),p(O,null,F(d.value,A=>(v(),p("label",{key:A.id,class:"tag-option"},[e("input",{type:"checkbox",checked:a.value.includes(A.id),onChange:c=>I(A.id)},null,40,hs),e("span",{class:"tag-label",style:we({backgroundColor:A.color})},y(A.name),5)]))),128))]))]),e("div",{class:"modal-footer"},[e("button",{class:"btn btn-secondary",onClick:U},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:pe},"ç¡®å®š")])])])):L("",!0),l.value?(v(),p("div",{key:1,class:"modal-overlay",onClick:Y},[e("div",{class:"modal-content duplicate-modal",onClick:h[6]||(h[6]=ve(()=>{},["stop"]))},[e("div",{class:"modal-header"},[h[14]||(h[14]=le('<div class="header-with-icon" data-v-edd548d5><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#dc2626" stroke-width="2" data-v-edd548d5><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z" data-v-edd548d5></path><line x1="12" y1="9" x2="12" y2="13" data-v-edd548d5></line><line x1="12" y1="17" x2="12.01" y2="17" data-v-edd548d5></line></svg><h3 data-v-edd548d5>æ£€æµ‹åˆ°é‡å¤å¡ç‰‡</h3></div>',1)),e("button",{class:"close-btn",onClick:Y},"Ã—")]),e("div",fs,[h[24]||(h[24]=e("div",{class:"duplicate-warning"},[e("p",{class:"warning-text"},"æ‚¨è¦æ·»åŠ çš„å¡ç‰‡ä¸ä»¥ä¸‹ç°æœ‰å¡ç‰‡é‡å¤ï¼š")],-1)),e("div",ws,[e("div",ks,[h[18]||(h[18]=e("div",{class:"box-header"},[e("span",{class:"box-label"},"ç°æœ‰å¡ç‰‡")],-1)),e("div",ys,[e("div",_s,[h[15]||(h[15]=e("span",{class:"detail-label"},"æ ‡é¢˜ï¼š",-1)),e("span",$s,y((K=u.value)==null?void 0:K.title),1)]),e("div",Cs,[h[16]||(h[16]=e("span",{class:"detail-label"},"ç½‘å€ï¼š",-1)),e("span",Ms,y((ae=u.value)==null?void 0:ae.url),1)]),(oe=u.value)!=null&&oe.logo_url?(v(),p("div",xs,[h[17]||(h[17]=e("span",{class:"detail-label"},"Logoï¼š",-1)),e("span",Vs,y((q=u.value)==null?void 0:q.logo_url),1)])):L("",!0)])]),h[23]||(h[23]=e("div",{class:"arrow-divider"},[e("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"#9ca3af","stroke-width":"2"},[e("path",{d:"M5 12h14M12 5l7 7-7 7"})])],-1)),e("div",Bs,[h[22]||(h[22]=e("div",{class:"box-header"},[e("span",{class:"box-label"},"å¾…æ·»åŠ å¡ç‰‡")],-1)),e("div",Us,[e("div",As,[h[19]||(h[19]=e("span",{class:"detail-label"},"æ ‡é¢˜ï¼š",-1)),e("span",Ds,y((ne=o.value)==null?void 0:ne.title),1)]),e("div",Ss,[h[20]||(h[20]=e("span",{class:"detail-label"},"ç½‘å€ï¼š",-1)),e("span",Ts,y((ie=o.value)==null?void 0:ie.url),1)]),(G=o.value)!=null&&G.logo_url?(v(),p("div",Is,[h[21]||(h[21]=e("span",{class:"detail-label"},"Logoï¼š",-1)),e("span",Ls,y((de=o.value)==null?void 0:de.logo_url),1)])):L("",!0)])])]),h[25]||(h[25]=e("div",{class:"duplicate-actions-info"},[e("p",null,"è¯·é€‰æ‹©å¦‚ä½•å¤„ç†ï¼š")],-1))]),e("div",{class:"modal-footer duplicate-footer"},[e("button",{class:"btn btn-secondary",onClick:te},[...h[26]||(h[26]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M18 6L6 18M6 6l12 12"})],-1),N(" è·³è¿‡ ",-1)])]),e("button",{class:"btn btn-warning",onClick:me},[...h[27]||(h[27]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 12a9 9 0 11-9-9c2.52 0 4.93 1 6.74 2.74L21 8"}),e("path",{d:"M21 3v5h-5"})],-1),N(" æ›¿æ¢ ",-1)])]),e("button",{class:"btn btn-primary",onClick:be},[...h[28]||(h[28]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1),N(" ç¼–è¾‘åæ·»åŠ  ",-1)])])])])])):L("",!0)])}}},Ns=J(Ws,[["__scopeId","data-v-edd548d5"]]),zs={class:"duplicate-manage"},Ps={class:"section-header"},Hs=["disabled"],Os={key:0,class:"duplicate-results"},Fs={class:"result-summary"},Rs={class:"summary-card"},js={class:"summary-value"},Es={class:"summary-card warning"},qs={class:"summary-value"},Js={class:"summary-card danger"},Gs={class:"summary-value"},Ks={class:"duplicate-groups"},Qs={class:"group-header"},Xs={class:"group-count"},Ys={class:"card-item original"},Zs={class:"card-info"},el={class:"card-title"},tl={class:"card-url"},sl={key:0,class:"card-desc"},ll={class:"card-id"},al={class:"duplicates-list"},ol={class:"card-info"},nl={class:"card-title"},il={class:"card-url"},dl={key:0,class:"card-desc"},rl={class:"card-actions"},ul={class:"card-id"},cl=["onClick","disabled"],vl={class:"group-actions"},pl=["onClick","disabled"],ml={class:"global-actions"},bl=["disabled"],gl={key:1,class:"no-duplicates"},hl={key:2,class:"initial-hint"},fl={key:3,class:"error"},wl={__name:"DuplicateManage",setup(W){const i=_(!1),w=_(!1),M=_(!1),V=_([]),$=_(0),B=_(0),S=_("");function d(){return x(this,null,function*(){var l,u;i.value=!0,S.value="";try{const o=yield Qe();$.value=o.data.total,V.value=o.data.duplicateGroups,B.value=o.data.duplicateCount,M.value=!0}catch(o){S.value=((u=(l=o.response)==null?void 0:l.data)==null?void 0:u.error)||"æ£€æµ‹å¤±è´¥",console.error("æ£€æµ‹é‡å¤å¤±è´¥:",o)}finally{i.value=!1}})}function b(l){return x(this,null,function*(){var u,o,s;if(confirm("ç¡®å®šè¦åˆ é™¤è¿™å¼ å¡ç‰‡å—ï¼Ÿ")){w.value=!0,S.value="";try{console.log("[å»é‡ç®¡ç†] åˆ é™¤å•ä¸ªå¡ç‰‡:",l);const r=yield he([l]);console.log("[å»é‡ç®¡ç†] åˆ é™¤å“åº”:",r.data),r.data.success?(console.log("[å»é‡ç®¡ç†] åˆ é™¤æˆåŠŸï¼Œé‡æ–°æ£€æµ‹..."),yield d()):S.value="åˆ é™¤å¤±è´¥ï¼š"+(r.data.message||"æœªçŸ¥é”™è¯¯")}catch(r){console.error("[å»é‡ç®¡ç†] åˆ é™¤å¡ç‰‡å¤±è´¥:",r),console.error("[å»é‡ç®¡ç†] é”™è¯¯è¯¦æƒ…:",(u=r.response)==null?void 0:u.data),S.value=((s=(o=r.response)==null?void 0:o.data)==null?void 0:s.error)||r.message||"åˆ é™¤å¤±è´¥"}finally{w.value=!1}}})}function n(l){return x(this,null,function*(){var o,s,r;const u=l.duplicates.length;if(confirm(`ç¡®å®šè¦åˆ é™¤è¿™ ${u} å¼ é‡å¤å¡ç‰‡å—ï¼Ÿ

å°†ä¿ç•™ï¼š${l.original.title}`)){w.value=!0,S.value="";try{const k=l.duplicates.map(g=>g.id);console.log("[å»é‡ç®¡ç†] åˆ é™¤ä¸€ç»„é‡å¤å¡ç‰‡:",k);const m=yield he(k);console.log("[å»é‡ç®¡ç†] åˆ é™¤å“åº”:",m.data),m.data.success?(console.log("[å»é‡ç®¡ç†] åˆ é™¤æˆåŠŸï¼Œé‡æ–°æ£€æµ‹..."),yield d()):S.value="åˆ é™¤å¤±è´¥ï¼š"+(m.data.message||"æœªçŸ¥é”™è¯¯")}catch(k){console.error("[å»é‡ç®¡ç†] åˆ é™¤é‡å¤å¡ç‰‡å¤±è´¥:",k),console.error("[å»é‡ç®¡ç†] é”™è¯¯è¯¦æƒ…:",(o=k.response)==null?void 0:o.data),S.value=((r=(s=k.response)==null?void 0:s.data)==null?void 0:r.error)||k.message||"åˆ é™¤å¤±è´¥"}finally{w.value=!1}}})}function a(){return x(this,null,function*(){var u,o,s;const l=B.value;if(confirm(`ç¡®å®šè¦åˆ é™¤æ‰€æœ‰ ${l} å¼ é‡å¤å¡ç‰‡å—ï¼Ÿ

æ­¤æ“ä½œä¸å¯æ’¤é”€ï¼`)){w.value=!0,S.value="";try{const r=V.value.flatMap(m=>m.duplicates.map(g=>g.id));console.log("[å»é‡ç®¡ç†] åˆ é™¤æ‰€æœ‰é‡å¤å¡ç‰‡:",r);const k=yield he(r);console.log("[å»é‡ç®¡ç†] åˆ é™¤å“åº”:",k.data),k.data.success?(console.log("[å»é‡ç®¡ç†] åˆ é™¤æˆåŠŸï¼Œé‡æ–°æ£€æµ‹..."),yield d()):S.value="åˆ é™¤å¤±è´¥ï¼š"+(k.data.message||"æœªçŸ¥é”™è¯¯")}catch(r){console.error("[å»é‡ç®¡ç†] åˆ é™¤æ‰€æœ‰é‡å¤å¤±è´¥:",r),console.error("[å»é‡ç®¡ç†] é”™è¯¯è¯¦æƒ…:",(u=r.response)==null?void 0:u.data),S.value=((s=(o=r.response)==null?void 0:o.data)==null?void 0:s.error)||r.message||"åˆ é™¤å¤±è´¥"}finally{w.value=!1}}})}return(l,u)=>(v(),p("div",zs,[e("div",Ps,[u[0]||(u[0]=e("h3",null,"å¡ç‰‡å»é‡ç®¡ç†",-1)),e("button",{onClick:d,class:"btn btn-primary",disabled:i.value},y(i.value?"æ£€æµ‹ä¸­...":"ğŸ” ä¸€é”®æ£€æµ‹é‡å¤"),9,Hs)]),V.value.length>0?(v(),p("div",Os,[e("div",Fs,[e("div",Rs,[u[1]||(u[1]=e("div",{class:"summary-label"},"æ€»å¡ç‰‡æ•°",-1)),e("div",js,y($.value),1)]),e("div",Es,[u[2]||(u[2]=e("div",{class:"summary-label"},"é‡å¤ç»„æ•°",-1)),e("div",qs,y(V.value.length),1)]),e("div",Js,[u[3]||(u[3]=e("div",{class:"summary-label"},"é‡å¤å¡ç‰‡",-1)),e("div",Gs,y(B.value),1)])]),e("div",Ks,[(v(!0),p(O,null,F(V.value,(o,s)=>(v(),p("div",{key:s,class:"duplicate-group"},[e("div",Qs,[e("h4",null,"é‡å¤ç»„ "+y(s+1),1),e("span",Xs,y(o.totalCount)+" å¼ å¡ç‰‡",1)]),e("div",Ys,[u[4]||(u[4]=e("div",{class:"card-badge"},"ä¿ç•™",-1)),e("div",Zs,[e("div",el,y(o.original.title),1),e("div",tl,y(o.original.url),1),o.original.desc?(v(),p("div",sl,y(o.original.desc),1)):L("",!0)]),e("div",ll,"ID: "+y(o.original.id),1)]),e("div",al,[(v(!0),p(O,null,F(o.duplicates,r=>(v(),p("div",{key:r.id,class:"card-item duplicate"},[u[5]||(u[5]=e("div",{class:"card-badge danger"},"é‡å¤",-1)),e("div",ol,[e("div",nl,y(r.title),1),e("div",il,y(r.url),1),r.desc?(v(),p("div",dl,y(r.desc),1)):L("",!0)]),e("div",rl,[e("span",ul,"ID: "+y(r.id),1),e("button",{onClick:k=>b(r.id),class:"btn-remove",disabled:w.value,title:"åˆ é™¤æ­¤å¡ç‰‡"}," åˆ é™¤ ",8,cl)])]))),128))]),e("div",vl,[e("button",{onClick:r=>n(o),class:"btn btn-danger",disabled:w.value}," åˆ é™¤æ­¤ç»„æ‰€æœ‰é‡å¤å¡ç‰‡ ("+y(o.duplicates.length)+" å¼ ) ",9,pl)])]))),128))]),e("div",ml,[e("button",{onClick:a,class:"btn btn-danger btn-large",disabled:w.value},y(w.value?"åˆ é™¤ä¸­...":`åˆ é™¤æ‰€æœ‰é‡å¤å¡ç‰‡ (${B.value} å¼ )`),9,bl)])])):M.value&&V.value.length===0?(v(),p("div",gl,[...u[6]||(u[6]=[e("svg",{width:"80",height:"80",viewBox:"0 0 24 24",fill:"none",stroke:"#1abc9c","stroke-width":"2"},[e("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e("polyline",{points:"22 4 12 14.01 9 11.01"})],-1),e("h3",null,"å¤ªæ£’äº†ï¼æ²¡æœ‰å‘ç°é‡å¤å¡ç‰‡",-1),e("p",null,"æ‚¨çš„å¯¼èˆªå¡ç‰‡éƒ½æ˜¯å”¯ä¸€çš„",-1)])])):M.value?L("",!0):(v(),p("div",hl,[...u[7]||(u[7]=[le('<svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="#666" stroke-width="2" data-v-62bbc778><circle cx="12" cy="12" r="10" data-v-62bbc778></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" data-v-62bbc778></path><line x1="12" y1="17" x2="12.01" y2="17" data-v-62bbc778></line></svg><h3 data-v-62bbc778>ç‚¹å‡»&quot;ä¸€é”®æ£€æµ‹é‡å¤&quot;å¼€å§‹æ‰«æ</h3><p data-v-62bbc778>ç³»ç»Ÿå°†æ£€æµ‹æ‰€æœ‰é‡å¤çš„å¯¼èˆªå¡ç‰‡</p><ul class="hint-list" data-v-62bbc778><li data-v-62bbc778>ğŸ“Œ URL ç›¸åŒçš„å¡ç‰‡</li><li data-v-62bbc778>ğŸ“Œ æ ‡é¢˜ç›¸åŒä¸”åŸŸåç›¸åŒçš„å¡ç‰‡</li></ul>',4)])])),S.value?(v(),p("p",fl,y(S.value),1)):L("",!0)]))}},kl=J(wl,[["__scopeId","data-v-62bbc778"]]),yl={class:"tag-manage"},_l={class:"tag-header"},$l={class:"tag-add"},Cl={class:"tag-content"},Ml={key:0,class:"empty-state"},xl={key:1,class:"tag-list"},Vl={class:"tag-info"},Bl=["onUpdate:modelValue","onBlur"],Ul={class:"tag-stats"},Al={class:"card-count"},Dl={class:"tag-controls"},Sl=["onUpdate:modelValue","onChange"],Tl={class:"tag-order"},Il=["onUpdate:modelValue","onBlur"],Ll={class:"tag-actions"},Wl=["onClick"],Nl={__name:"TagManage",setup(W){const i=_([]),w=_(""),M=_("#2566d8");Q(V);function V(){return x(this,null,function*(){const d=yield Ae();i.value=d.data;for(const b of i.value)try{const n=yield Xe(b.id);b.cardCount=n.data.count}catch(n){b.cardCount=0}})}function $(){return x(this,null,function*(){var l,u;if(!w.value.trim())return;const d=i.value.length?Math.max(...i.value.map(o=>o.order||0)):0,b=w.value.trim(),n=M.value,a={id:Date.now(),name:b,color:n,order:d+1,cardCount:0,_temp:!0};i.value.push(a),w.value="",M.value="#2566d8";try{const o=yield Ye({name:b,color:n,order:d+1}),s=i.value.findIndex(r=>r.id===a.id);s>-1&&(i.value[s]=ue(se({},o.data),{cardCount:0}))}catch(o){const s=i.value.findIndex(r=>r.id===a.id);s>-1&&i.value.splice(s,1),alert("æ·»åŠ æ ‡ç­¾å¤±è´¥ï¼š"+(((u=(l=o.response)==null?void 0:l.data)==null?void 0:u.error)||o.message))}})}function B(d){return x(this,null,function*(){var b,n;if(!d._temp)try{yield Ze(d.id,{name:d.name,color:d.color,order:d.order})}catch(a){alert("æ›´æ–°æ ‡ç­¾å¤±è´¥ï¼š"+(((n=(b=a.response)==null?void 0:b.data)==null?void 0:n.error)||a.message)),V()}})}function S(d){return x(this,null,function*(){var l,u;const b=i.value.find(o=>o.id===d);if(!b)return;const n=b.cardCount>0?`ç¡®å®šè¦åˆ é™¤æ ‡ç­¾"${b.name}"å—ï¼Ÿè¿™å°†å–æ¶ˆ ${b.cardCount} å¼ å¡ç‰‡çš„å…³è”ã€‚`:`ç¡®å®šè¦åˆ é™¤æ ‡ç­¾"${b.name}"å—ï¼Ÿ`;if(!confirm(n))return;const a=i.value.findIndex(o=>o.id===d);a>-1&&i.value.splice(a,1);try{yield et(d)}catch(o){alert("åˆ é™¤æ ‡ç­¾å¤±è´¥ï¼š"+(((u=(l=o.response)==null?void 0:l.data)==null?void 0:u.error)||o.message)),V()}})}return(d,b)=>(v(),p("div",yl,[e("div",_l,[b[3]||(b[3]=e("div",{class:"header-content"},[e("h2",{class:"page-title"},"ç®¡ç†æ ‡ç­¾"),e("p",{class:"page-desc"},"ä¸ºå¡ç‰‡åˆ›å»ºå¤šç»´åº¦åˆ†ç±»æ ‡ç­¾")],-1)),e("div",$l,[C(e("input",{"onUpdate:modelValue":b[0]||(b[0]=n=>w.value=n),placeholder:"æ ‡ç­¾åç§°",class:"input",maxlength:"20"},null,512),[[D,w.value]]),C(e("input",{"onUpdate:modelValue":b[1]||(b[1]=n=>M.value=n),type:"color",class:"color-input",title:"é€‰æ‹©æ ‡ç­¾é¢œè‰²"},null,512),[[D,M.value]]),e("button",{class:"btn btn-primary",onClick:$},[...b[2]||(b[2]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),N(" æ·»åŠ æ ‡ç­¾ ",-1)])])])]),e("div",Cl,[i.value.length===0?(v(),p("div",Ml,[...b[4]||(b[4]=[e("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1"},[e("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"}),e("line",{x1:"7",y1:"7",x2:"7.01",y2:"7"})],-1),e("p",null,"æš‚æ— æ ‡ç­¾",-1),e("p",{class:"hint"},"åˆ›å»ºç¬¬ä¸€ä¸ªæ ‡ç­¾ï¼Œå¼€å§‹ä¸ºå¡ç‰‡æ·»åŠ å¤šç»´åº¦åˆ†ç±»",-1)])])):(v(),p("div",xl,[(v(!0),p(O,null,F(i.value,n=>(v(),p("div",{key:n.id,class:"tag-item"},[e("div",{class:"tag-preview",style:we({backgroundColor:n.color})},[...b[5]||(b[5]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"}),e("line",{x1:"7",y1:"7",x2:"7.01",y2:"7"})],-1)])],4),e("div",Vl,[C(e("input",{"onUpdate:modelValue":a=>n.name=a,onBlur:a=>B(n),class:"tag-name-input",maxlength:"20"},null,40,Bl),[[D,n.name]]),e("div",Ul,[e("span",Al,y(n.cardCount||0)+" å¼ å¡ç‰‡",1)])]),e("div",Dl,[C(e("input",{"onUpdate:modelValue":a=>n.color=a,type:"color",onChange:a=>B(n),class:"color-picker",title:"æ›´æ”¹é¢œè‰²"},null,40,Sl),[[D,n.color]]),e("div",Tl,[b[6]||(b[6]=e("span",{class:"order-label"},"æ’åº",-1)),C(e("input",{"onUpdate:modelValue":a=>n.order=a,type:"number",onBlur:a=>B(n),class:"order-input"},null,40,Il),[[D,n.order,void 0,{number:!0}]])])]),e("div",Ll,[e("button",{class:"btn btn-danger btn-icon",onClick:a=>S(n.id),title:"åˆ é™¤æ ‡ç­¾"},[...b[7]||(b[7]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)])],8,Wl)])]))),128))]))])]))}},zl=J(Nl,[["__scopeId","data-v-56efcb56"]]),Pl={class:"ad-manage"},Hl={class:"ad-header"},Ol={class:"ad-section"},Fl={class:"ad-card"},Rl={class:"ad-table"},jl=["onUpdate:modelValue","onBlur"],El=["onUpdate:modelValue","onBlur"],ql=["onClick"],Jl={class:"ad-section"},Gl={class:"ad-card"},Kl={class:"ad-table"},Ql=["onUpdate:modelValue","onBlur"],Xl=["onUpdate:modelValue","onBlur"],Yl=["onClick"],Zl={__name:"AdManage",setup(W){const i=_([]),w=_([]),M=_(""),V=_(""),$=_("left");Q(B);function B(){return x(this,null,function*(){try{const n=yield tt();let a=[];Array.isArray(n.data)?a=n.data:n.data&&Array.isArray(n.data.data)&&(a=n.data.data),i.value=a.filter(l=>l.position==="left"),w.value=a.filter(l=>l.position==="right")}catch(n){console.error("åŠ è½½å¹¿å‘Šå¤±è´¥:",n),i.value=[],w.value=[]}})}function S(){return x(this,null,function*(){var n,a;if(!M.value||!V.value){alert("è¯·å¡«å†™å¹¿å‘Šå›¾ç‰‡é“¾æ¥å’Œè·³è½¬é“¾æ¥");return}try{yield st({position:$.value,img:M.value,url:V.value}),M.value="",V.value="",$.value="left",yield B()}catch(l){alert("æ·»åŠ å¹¿å‘Šå¤±è´¥ï¼š"+(((a=(n=l.response)==null?void 0:n.data)==null?void 0:a.error)||l.message))}})}function d(n){return x(this,null,function*(){var a,l;try{yield lt(n.id,{img:n.img,url:n.url})}catch(u){alert("æ›´æ–°å¹¿å‘Šå¤±è´¥ï¼š"+(((l=(a=u.response)==null?void 0:a.data)==null?void 0:l.error)||u.message)),yield B()}})}function b(n){return x(this,null,function*(){if(!confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå¹¿å‘Šå—ï¼Ÿ"))return;const a=i.value.findIndex(u=>u.id===n),l=w.value.findIndex(u=>u.id===n);a>-1&&i.value.splice(a,1),l>-1&&w.value.splice(l,1);try{yield at(n)}catch(u){console.error("åˆ é™¤å¹¿å‘Šå¤±è´¥:",u),yield B()}})}return(n,a)=>(v(),p("div",Pl,[e("div",Hl,[e("form",{class:"ad-add-row",onSubmit:ve(S,["prevent"])},[C(e("input",{"onUpdate:modelValue":a[0]||(a[0]=l=>M.value=l),placeholder:"å¹¿å‘Šå›¾ç‰‡é“¾æ¥",class:"input"},null,512),[[D,M.value]]),C(e("input",{"onUpdate:modelValue":a[1]||(a[1]=l=>V.value=l),placeholder:"å¹¿å‘Šè·³è½¬é“¾æ¥",class:"input"},null,512),[[D,V.value]]),C(e("select",{"onUpdate:modelValue":a[2]||(a[2]=l=>$.value=l),class:"input select-input"},[...a[3]||(a[3]=[e("option",{value:"left"},"å·¦ä¾§å¹¿å‘Š",-1),e("option",{value:"right"},"å³ä¾§å¹¿å‘Š",-1)])],512),[[fe,$.value]]),a[4]||(a[4]=e("button",{class:"btn",type:"submit"},"æ·»åŠ å¹¿å‘Š",-1))],32)]),e("div",Ol,[a[6]||(a[6]=e("h3",{class:"section-title"},"å·¦ä¾§å¹¿å‘Šåˆ—è¡¨",-1)),e("div",Fl,[e("table",Rl,[a[5]||(a[5]=e("thead",null,[e("tr",null,[e("th",null,"å›¾ç‰‡"),e("th",null,"è·³è½¬é“¾æ¥"),e("th",null,"æ“ä½œ")])],-1)),e("tbody",null,[(v(!0),p(O,null,F(i.value,l=>(v(),p("tr",{key:l.id},[e("td",null,[C(e("input",{"onUpdate:modelValue":u=>l.img=u,onBlur:u=>d(l),class:"input"},null,40,jl),[[D,l.img]])]),e("td",null,[C(e("input",{"onUpdate:modelValue":u=>l.url=u,onBlur:u=>d(l),class:"input"},null,40,El),[[D,l.url]])]),e("td",null,[e("button",{class:"btn btn-danger",onClick:u=>b(l.id)},"åˆ é™¤å¹¿å‘Š",8,ql)])]))),128))])])])]),e("div",Jl,[a[8]||(a[8]=e("h3",{class:"section-title"},"å³ä¾§å¹¿å‘Šåˆ—è¡¨",-1)),e("div",Gl,[e("table",Kl,[a[7]||(a[7]=e("thead",null,[e("tr",null,[e("th",null,"å›¾ç‰‡"),e("th",null,"è·³è½¬é“¾æ¥"),e("th",null,"æ“ä½œ")])],-1)),e("tbody",null,[(v(!0),p(O,null,F(w.value,l=>(v(),p("tr",{key:l.id},[e("td",null,[C(e("input",{"onUpdate:modelValue":u=>l.img=u,onBlur:u=>d(l),class:"input"},null,40,Ql),[[D,l.img]])]),e("td",null,[C(e("input",{"onUpdate:modelValue":u=>l.url=u,onBlur:u=>d(l),class:"input"},null,40,Xl),[[D,l.url]])]),e("td",null,[e("button",{class:"btn btn-danger",onClick:u=>b(l.id)},"åˆ é™¤å¹¿å‘Š",8,Yl)])]))),128))])])])])]))}},ea=J(Zl,[["__scopeId","data-v-9c35605d"]]),ta={class:"friend-manage"},sa={class:"friend-add"},la={class:"friend-card"},aa={class:"friend-table"},oa=["onUpdate:modelValue","onBlur"],na=["onUpdate:modelValue","onBlur"],ia=["onUpdate:modelValue","onBlur"],da=["onClick"],ra={__name:"FriendLinkManage",setup(W){const i=_([]),w=_(""),M=_(""),V=_("");Q($);function $(){return x(this,null,function*(){const b=yield ot();i.value=b.data})}function B(){return x(this,null,function*(){!w.value||!M.value||(yield nt({title:w.value,url:M.value,logo:V.value}),w.value="",M.value="",V.value="",$())})}function S(b){return x(this,null,function*(){yield it(b.id,{title:b.title,url:b.url,logo:b.logo}),$()})}function d(b){return x(this,null,function*(){if(!confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå‹é“¾å—ï¼Ÿ"))return;const n=i.value.findIndex(a=>a.id===b);n>-1&&i.value.splice(n,1);try{yield dt(b)}catch(a){console.error("åˆ é™¤å‹é“¾å¤±è´¥:",a),yield $()}})}return(b,n)=>(v(),p("div",ta,[n[4]||(n[4]=e("div",{class:"friend-header"},null,-1)),e("div",sa,[C(e("input",{"onUpdate:modelValue":n[0]||(n[0]=a=>w.value=a),placeholder:"ç½‘ç«™å",class:"input"},null,512),[[D,w.value]]),C(e("input",{"onUpdate:modelValue":n[1]||(n[1]=a=>M.value=a),placeholder:"ç½‘ç«™é“¾æ¥",class:"input"},null,512),[[D,M.value]]),C(e("input",{"onUpdate:modelValue":n[2]||(n[2]=a=>V.value=a),placeholder:"logoé“¾æ¥(å¯é€‰)",class:"input"},null,512),[[D,V.value]]),e("button",{class:"btn",onClick:B},"æ·»åŠ å‹é“¾")]),e("div",la,[e("table",aa,[n[3]||(n[3]=e("thead",null,[e("tr",null,[e("th",null,"ç½‘ç«™å"),e("th",null,"é“¾æ¥"),e("th",null,"Logo"),e("th",null,"æ“ä½œ")])],-1)),e("tbody",null,[(v(!0),p(O,null,F(i.value,a=>(v(),p("tr",{key:a.id},[e("td",null,[C(e("input",{"onUpdate:modelValue":l=>a.title=l,onBlur:l=>S(a),class:"input"},null,40,oa),[[D,a.title]])]),e("td",null,[C(e("input",{"onUpdate:modelValue":l=>a.url=l,onBlur:l=>S(a),class:"input"},null,40,na),[[D,a.url]])]),e("td",null,[C(e("input",{"onUpdate:modelValue":l=>a.logo=l,onBlur:l=>S(a),class:"input",placeholder:"logoé“¾æ¥(å¯é€‰)"},null,40,ia),[[D,a.logo]])]),e("td",null,[e("button",{class:"btn btn-danger",onClick:l=>d(a.id)},"åˆ é™¤",8,da)])]))),128))])])])]))}},ua=J(ra,[["__scopeId","data-v-c25e838c"]]),ca={class:"user-manage"},va={class:"user-card"},pa={class:"username-section"},ma={class:"username-form"},ba={class:"current-username"},ga={class:"username-display"},ha={class:"form-group"},fa={class:"form-actions"},wa=["disabled"],ka={class:"password-section"},ya={class:"password-form"},_a={class:"form-group"},$a={class:"form-group"},Ca={class:"form-group"},Ma={class:"form-actions"},xa=["disabled"],Va={__name:"UserManage",setup(W){const i=_(""),w=_(""),M=_(""),V=_(!1),$=_(""),B=_("success"),S=_({}),d=_(""),b=_(!1),n=_(""),a=_("success");Q(()=>x(null,null,function*(){yield l()}));function l(){return x(this,null,function*(){try{const k=yield rt();S.value=k.data.data||k.data}catch(k){console.error("è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:",k)}})}function u(){return x(this,null,function*(){var k,m;if(!d.value){o("è¯·è¾“å…¥æ–°ç”¨æˆ·å","error");return}if(d.value.length<3||d.value.length>20){o("ç”¨æˆ·åé•¿åº¦åº”ä¸º3-20ä½","error");return}if(d.value===S.value.username){o("æ–°ç”¨æˆ·åä¸èƒ½ä¸å½“å‰ç”¨æˆ·åç›¸åŒ","error");return}b.value=!0,n.value="";try{yield ut(d.value),o("ç”¨æˆ·åä¿®æ”¹æˆåŠŸï¼2ç§’åè‡ªåŠ¨é€€å‡ºï¼Œè¯·ä½¿ç”¨æ–°ç”¨æˆ·åé‡æ–°ç™»å½•...","success"),d.value="",setTimeout(()=>{localStorage.removeItem("token"),window.location.href="/admin"},2e3)}catch(g){o(((m=(k=g.response)==null?void 0:k.data)==null?void 0:m.message)||"ç”¨æˆ·åä¿®æ”¹å¤±è´¥","error")}finally{b.value=!1}})}function o(k,m){n.value=k,a.value=m,setTimeout(()=>{n.value=""},3e3)}function s(){return x(this,null,function*(){var k,m;if(!i.value||!w.value||!M.value){r("è¯·å¡«å†™æ‰€æœ‰å¯†ç å­—æ®µ","error");return}if(w.value!==M.value){r("ä¸¤æ¬¡è¾“å…¥çš„æ–°å¯†ç ä¸ä¸€è‡´","error");return}if(w.value.length<6){r("æ–°å¯†ç é•¿åº¦è‡³å°‘6ä½","error");return}V.value=!0,$.value="";try{yield ct(i.value,w.value),r("å¯†ç ä¿®æ”¹æˆåŠŸ","success"),i.value="",w.value="",M.value=""}catch(g){r(((m=(k=g.response)==null?void 0:k.data)==null?void 0:m.message)||"å¯†ç ä¿®æ”¹å¤±è´¥","error")}finally{V.value=!1}})}function r(k,m){$.value=k,B.value=m,k==="å¯†ç ä¿®æ”¹æˆåŠŸ"&&m==="success"?setTimeout(()=>{$.value="2ç§’åè‡ªåŠ¨é€€å‡ºç™»å½•,è¯·ä½¿ç”¨æ–°å¯†ç é‡æ–°ç™»å½•...",setTimeout(()=>{localStorage.removeItem("token"),window.location.reload()},2e3)},500):setTimeout(()=>{$.value=""},3e3)}return(k,m)=>(v(),p("div",ca,[m[11]||(m[11]=e("div",{class:"user-header"},null,-1)),e("div",va,[e("div",pa,[m[6]||(m[6]=e("h3",{class:"section-title"},"ä¿®æ”¹ç”¨æˆ·å",-1)),e("div",ma,[e("div",ba,[m[4]||(m[4]=e("label",null,"å½“å‰ç”¨æˆ·åï¼š",-1)),e("span",ga,y(S.value.username||"admin"),1)]),e("div",ha,[m[5]||(m[5]=e("label",null,"æ–°ç”¨æˆ·åï¼š",-1)),C(e("input",{"onUpdate:modelValue":m[0]||(m[0]=g=>d.value=g),type:"text",placeholder:"è¯·è¾“å…¥æ–°ç”¨æˆ·åï¼ˆ3-20ä½ï¼‰",class:"input"},null,512),[[D,d.value]])]),e("div",fa,[e("button",{onClick:u,class:"btn",disabled:b.value},y(b.value?"ä¿®æ”¹ä¸­...":"ä¿®æ”¹ç”¨æˆ·å"),9,wa)]),n.value?(v(),p("p",{key:0,class:z(["message",a.value])},y(n.value),3)):L("",!0)])]),e("div",ka,[m[10]||(m[10]=e("h3",{class:"section-title"},"ä¿®æ”¹å¯†ç ",-1)),e("div",ya,[e("div",_a,[m[7]||(m[7]=e("label",null,"å½“å‰å¯†ç ï¼š",-1)),C(e("input",{"onUpdate:modelValue":m[1]||(m[1]=g=>i.value=g),type:"password",placeholder:"è¯·è¾“å…¥å½“å‰å¯†ç ",class:"input"},null,512),[[D,i.value]])]),e("div",$a,[m[8]||(m[8]=e("label",null,"æ–°å¯†ç ï¼š",-1)),C(e("input",{"onUpdate:modelValue":m[2]||(m[2]=g=>w.value=g),type:"password",placeholder:"è¯·è¾“å…¥æ–°å¯†ç ",class:"input"},null,512),[[D,w.value]])]),e("div",Ca,[m[9]||(m[9]=e("label",null,"ç¡®è®¤æ–°å¯†ç ï¼š",-1)),C(e("input",{"onUpdate:modelValue":m[3]||(m[3]=g=>M.value=g),type:"password",placeholder:"è¯·å†æ¬¡è¾“å…¥æ–°å¯†ç ",class:"input"},null,512),[[D,M.value]])]),e("div",Ma,[e("button",{onClick:s,class:"btn",disabled:V.value},y(V.value?"ä¿®æ”¹ä¸­...":"ä¿®æ”¹å¯†ç "),9,xa)]),$.value?(v(),p("p",{key:0,class:z(["message",B.value])},y($.value),3)):L("",!0)])])])]))}},Ba=J(Va,[["__scopeId","data-v-40392133"]]),Ua={class:"backup-manage"},Aa={class:"tabs"},Da={class:"tab-content"},Sa={class:"toolbar"},Ta=["disabled"],Ia=["disabled"],La=["disabled"],Wa={class:"backup-list"},Na={key:0,class:"empty-state"},za={key:1,class:"backup-grid"},Pa={class:"backup-info"},Ha={class:"backup-name"},Oa={class:"backup-meta"},Fa={class:"backup-size"},Ra={class:"backup-date"},ja={key:0,class:"backup-signed",title:"å·²ç­¾åéªŒè¯"},Ea={key:1,class:"backup-unsigned",title:"æœªç­¾åï¼ˆå¤–éƒ¨ä¸Šä¼ ï¼‰"},qa={class:"backup-actions"},Ja=["onClick"],Ga=["onClick"],Ka=["onClick"],Qa=["onClick"],Xa={class:"tab-content"},Ya={class:"toolbar"},Za=["disabled"],eo=["disabled"],to={key:1,class:"info-box"},so={class:"backup-list"},lo={key:0,class:"empty-state"},ao={key:1,class:"backup-grid"},oo={class:"backup-info"},no={class:"backup-name"},io={class:"backup-meta"},ro={class:"backup-size"},uo={class:"backup-date"},co={class:"backup-actions"},vo=["onClick"],po=["onClick"],mo={class:"tab-content"},bo={class:"config-section"},go={class:"config-card"},ho={class:"config-header"},fo={class:"switch"},wo={key:0,class:"config-fields"},ko={class:"field-row"},yo={class:"field-row"},_o={class:"config-card"},$o={class:"config-header"},Co={class:"switch"},Mo={key:0,class:"config-fields"},xo={class:"field-row"},Vo={class:"time-input"},Bo={class:"field-row"},Uo={class:"field-row checkbox-row"},Ao={class:"checkbox-label"},Do={class:"config-card"},So={class:"config-header"},To={class:"switch"},Io={class:"config-info"},Lo={key:0,class:"warning-text"},Wo={key:0,class:"config-fields"},No={class:"field-row checkbox-row"},zo={class:"checkbox-label"},Po={class:"field-row checkbox-row"},Ho={class:"checkbox-label"},Oo={class:"config-card"},Fo={class:"config-header"},Ro={class:"switch"},jo={key:0,class:"stats-card"},Eo={class:"stats-grid"},qo={class:"stat-item"},Jo={class:"stat-value"},Go={class:"stat-item"},Ko={class:"stat-value"},Qo={class:"stat-item"},Xo={class:"stat-value"},Yo={class:"stat-item"},Zo={class:"stat-value"},en={class:"config-actions"},tn=["disabled"],sn={key:0,class:"modal-overlay"},ln={class:"modal-content config-modal"},an={class:"form-group"},on={class:"form-group"},nn={class:"form-group"},dn=["placeholder"],rn={key:0},un={key:1},cn={class:"modal-actions"},vn=["disabled"],pn={key:1,class:"modal-overlay"},mn={class:"modal-content"},bn={style:{"white-space":"pre-line"}},gn={class:"modal-actions"},hn=["disabled"],fn=["disabled"],wn={key:2,class:"modal-overlay"},kn={class:"modal-content config-modal"},yn={class:"form-group"},_n={class:"form-group"},$n={class:"modal-actions"},Cn=["disabled"],Mn={key:3,class:"modal-overlay"},xn={class:"modal-content config-modal"},Vn={class:"form-group"},Bn={class:"modal-actions"},Un=["disabled"],An={__name:"BackupManage",setup(W){const i=_("local"),w=_([]),M=_([]),V=_(!1),$=_(!1),B=_(!1),S=_(null),d=Z({create:!1,list:!1,delete:!1,restore:!1,upload:!1,rename:!1,webdavConfig:!1,webdavBackup:!1,webdavList:!1,webdavRestore:!1,webdavDelete:!1,autoBackupConfig:!1}),b=Z({name:"",description:""}),n=Z({oldName:"",newName:""}),a=_({text:"",type:""}),l=Z({show:!1,filename:"",action:null,title:"",message:"",confirmClass:"",signed:!0,processing:!1}),u=Z({configured:!1,url:"",username:""}),o=Z({url:"",username:"",password:""}),s=Z({debounce:{enabled:!0,delay:30,keep:5},scheduled:{enabled:!0,hour:2,minute:0,keep:7,onlyIfModified:!0},webdav:{enabled:!1,syncDaily:!0,syncIncremental:!0},autoClean:!0}),r=_(null),k=localStorage.getItem("token");function m(P){return x(this,arguments,function*(c,t={}){return(yield fetch(c,ue(se({},t),{headers:se({Authorization:`Bearer ${k}`,"Content-Type":"application/json"},t.headers)}))).json()})}const g=(c,t="success",P=4e3)=>{a.value={text:c,type:t},setTimeout(()=>{a.value={text:"",type:""}},t==="error"?6e3:P)},E=()=>{b.name="",b.description="",$.value=!0},H=()=>x(null,null,function*(){d.create=!0;const c=yield m("/api/backup/create",{method:"POST",body:JSON.stringify({name:b.name||null,description:b.description||null})});c.success?(g("å¤‡ä»½åˆ›å»ºæˆåŠŸï¼"),$.value=!1,yield I()):g(c.message||"å¤‡ä»½åˆ›å»ºå¤±è´¥","error"),d.create=!1}),R=c=>{n.oldName=c,n.newName=c.replace(".zip",""),B.value=!0},U=()=>x(null,null,function*(){if(!n.newName.trim()){g("è¯·è¾“å…¥æ–°åç§°","error");return}d.rename=!0;const c=yield m(`/api/backup/rename/${n.oldName}`,{method:"PUT",body:JSON.stringify({newName:n.newName})});c.success?(g("é‡å‘½åæˆåŠŸï¼"),B.value=!1,yield I()):g(c.message||"é‡å‘½åå¤±è´¥","error"),d.rename=!1}),I=()=>x(null,null,function*(){d.list=!0;const c=yield m("/api/backup/list");c.success?w.value=c.backups:g("è·å–å¤‡ä»½åˆ—è¡¨å¤±è´¥","error"),d.list=!1}),pe=c=>{window.open(`/api/backup/download/${c}?token=${k}`,"_blank")},X=(c,t)=>{const P=typeof t=="object"?t:{name:t},f=P.name;l.show=!0,l.filename=f,l.action=c,l.signed=P.signed,l.processing=!1,c==="delete"?(l.title="åˆ é™¤",l.message=`ç¡®å®šè¦åˆ é™¤å¤‡ä»½æ–‡ä»¶ ${f} å—ï¼Ÿ`,l.confirmClass="btn-danger"):c==="restore"?(l.title="æ¢å¤",P.signed?l.message=`ç¡®å®šè¦æ¢å¤å¤‡ä»½æ–‡ä»¶ ${f} å—ï¼Ÿ`:l.message=`âš ï¸ è­¦å‘Šï¼šæ­¤å¤‡ä»½æ–‡ä»¶æœªç­¾åï¼ˆå¯èƒ½æ˜¯å¤–éƒ¨ä¸Šä¼ çš„ï¼‰ï¼Œæ— æ³•éªŒè¯å…¶å®Œæ•´æ€§ã€‚

ç¡®å®šè¦æ¢å¤å¤‡ä»½æ–‡ä»¶ ${f} å—ï¼Ÿ`,l.confirmClass="btn-restore"):c==="webdav-restore"?(l.title="ä»WebDAVæ¢å¤",l.message=`ç¡®å®šè¦ä»WebDAVæ¢å¤å¤‡ä»½ ${f} å—ï¼Ÿè¿™å°†è¦†ç›–å½“å‰æ•°æ®ã€‚`,l.confirmClass="btn-restore"):c==="webdav-delete"&&(l.title="åˆ é™¤WebDAVå¤‡ä»½",l.message=`ç¡®å®šè¦åˆ é™¤WebDAVå¤‡ä»½ ${f} å—ï¼Ÿ`,l.confirmClass="btn-danger")},Y=()=>x(null,null,function*(){const{action:c,filename:t,signed:P}=l;l.show=!1,l.processing=!1;try{if(c==="delete"){g("æ­£åœ¨åˆ é™¤å¤‡ä»½...");const f=yield m(`/api/backup/delete/${t}`,{method:"DELETE"});f.success?(g("âœ“ åˆ é™¤æˆåŠŸ"),yield I()):g("âœ— "+(f.message||"åˆ é™¤å¤±è´¥"),"error")}else if(c==="restore"){g("æ­£åœ¨æ¢å¤å¤‡ä»½ï¼Œè¯·ç¨å€™...");const f=P?{}:{forceRestore:!0},j=yield m(`/api/backup/restore/${t}`,{method:"POST",body:JSON.stringify(f)});if(j.success)g("âœ“ å¤‡ä»½å·²æ¢å¤ï¼Œæ­£åœ¨é‡æ–°åŠ è½½æ•°æ®..."),yield new Promise(re=>setTimeout(re,2e3)),yield Promise.all([I(),T(),q(),G()]),g("âœ“ æ¢å¤å®Œæˆï¼æ•°æ®å·²æ›´æ–°","success",5e3);else if(j.requireConfirm&&j.code==="NO_SIGNATURE"){if(confirm(j.message+`

ç‚¹å‡»"ç¡®å®š"ç»§ç»­æ¢å¤ï¼Œç‚¹å‡»"å–æ¶ˆ"æ”¾å¼ƒæ“ä½œã€‚`)){const re=yield m(`/api/backup/restore/${t}`,{method:"POST",body:JSON.stringify({forceRestore:!0})});re.success?(g("âœ“ å¤‡ä»½å·²æ¢å¤ï¼Œæ­£åœ¨é‡æ–°åŠ è½½æ•°æ®..."),yield new Promise(De=>setTimeout(De,2e3)),yield Promise.all([I(),T(),q(),G()]),g("âœ“ æ¢å¤å®Œæˆï¼æ•°æ®å·²æ›´æ–°","success",5e3)):g("âœ— "+(re.message||"æ¢å¤å¤±è´¥"),"error")}}else g("âœ— "+(j.message||"æ¢å¤å¤±è´¥"),"error")}else c==="webdav-restore"?yield ne(t):c==="webdav-delete"&&(yield ie(t))}catch(f){g("âœ— æ“ä½œå¤±è´¥: "+f.message,"error")}}),te=c=>c?new Date(c).toLocaleString("zh-CN",{hour12:!1}):"--",me=()=>{S.value.click()},be=c=>x(null,null,function*(){const t=c.target.files[0];if(t){if(!t.name.endsWith(".zip")){g("åªæ”¯æŒ.zipæ ¼å¼çš„å¤‡ä»½æ–‡ä»¶","error"),c.target.value="";return}if(t.size>500*1024*1024){g("å¤‡ä»½æ–‡ä»¶è¿‡å¤§ï¼Œæœ€å¤§æ”¯æŒ500MB","error"),c.target.value="";return}d.upload=!0;try{const P=new FormData;P.append("backup",t);const j=yield(yield fetch("/api/backup/upload",{method:"POST",headers:{Authorization:`Bearer ${k}`},body:P})).json();j.success?(g("å¤‡ä»½æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼"),yield I()):g(j.message||"å¤‡ä»½æ–‡ä»¶ä¸Šä¼ å¤±è´¥","error")}catch(P){console.error("ä¸Šä¼ å¤±è´¥:",P),g("å¤‡ä»½æ–‡ä»¶ä¸Šä¼ å¤±è´¥","error")}finally{d.upload=!1,c.target.value=""}}}),T=()=>x(null,null,function*(){const c=yield m("/api/backup/webdav/config");c.success&&c.config&&(u.configured=c.config.configured,u.url=c.config.url||"",u.username=c.config.username||"")}),h=()=>x(null,null,function*(){yield T(),o.url=u.url,o.username=u.username,o.password="",V.value=!0}),K=()=>x(null,null,function*(){if(!o.url||!o.username){g("è¯·å¡«å†™URLå’Œç”¨æˆ·å","error");return}if(!u.configured&&!o.password){g("é¦–æ¬¡é…ç½®æ—¶å¯†ç ä¸èƒ½ä¸ºç©º","error");return}d.webdavConfig=!0;const c=yield m("/api/backup/webdav/config",{method:"POST",body:JSON.stringify(o)});c.success?(g("WebDAVé…ç½®ä¿å­˜æˆåŠŸï¼"),V.value=!1,yield T(),u.configured&&(yield q())):g(c.message||"WebDAVé…ç½®ä¿å­˜å¤±è´¥","error"),d.webdavConfig=!1}),ae=()=>x(null,null,function*(){d.webdavBackup=!0;const c=yield m("/api/backup/webdav/backup",{method:"POST"});c.success?(g("å¤‡ä»½åˆ°WebDAVæˆåŠŸï¼"),yield q()):g(c.message||"å¤‡ä»½åˆ°WebDAVå¤±è´¥","error"),d.webdavBackup=!1}),oe=c=>{c.target.checked&&!u.configured&&(s.webdav.enabled=!1,g('è¯·å…ˆåœ¨"WebDAVå¤‡ä»½"æ ‡ç­¾é¡µé…ç½®WebDAVè¿æ¥',"error"),i.value="webdav")},q=()=>x(null,null,function*(){d.webdavList=!0;const c=yield m("/api/backup/webdav/list");c.success?M.value=c.backups||[]:g("è·å–WebDAVå¤‡ä»½åˆ—è¡¨å¤±è´¥","error"),d.webdavList=!1}),ne=c=>x(null,null,function*(){g("æ­£åœ¨ä» WebDAV æ¢å¤å¤‡ä»½ï¼Œè¯·ç¨å€™..."),d.webdavRestore=!0;try{const t=yield m("/api/backup/webdav/restore",{method:"POST",body:JSON.stringify({filename:c})});t.success?(g("âœ“ å¤‡ä»½å·²æ¢å¤ï¼Œæ­£åœ¨é‡æ–°åŠ è½½æ•°æ®..."),yield new Promise(P=>setTimeout(P,2e3)),yield Promise.all([I(),T(),q(),G()]),g("âœ“ æ¢å¤å®Œæˆï¼æ•°æ®å·²æ›´æ–°","success",5e3)):g("âœ— "+(t.message||"ä» WebDAV æ¢å¤å¤±è´¥"),"error")}catch(t){g("âœ— æ¢å¤å¤±è´¥: "+t.message,"error")}finally{d.webdavRestore=!1}}),ie=c=>x(null,null,function*(){g("æ­£åœ¨åˆ é™¤ WebDAV å¤‡ä»½..."),d.webdavDelete=!0;try{const t=yield m(`/api/backup/webdav/delete/${c}`,{method:"DELETE"});t.success?(g("âœ“ åˆ é™¤æˆåŠŸ"),yield q()):g("âœ— "+(t.message||"åˆ é™¤å¤±è´¥"),"error")}catch(t){g("âœ— åˆ é™¤å¤±è´¥: "+t.message,"error")}finally{d.webdavDelete=!1}}),G=()=>x(null,null,function*(){const c=yield m("/api/backup/auto/config");c.success&&c.config?(Object.assign(s,c.config),r.value=c.stats||null):g("åŠ è½½è‡ªåŠ¨å¤‡ä»½é…ç½®å¤±è´¥","error")}),de=()=>x(null,null,function*(){d.autoBackupConfig=!0;const c=yield m("/api/backup/auto/config",{method:"POST",body:JSON.stringify(s)});c.success?(g("è‡ªåŠ¨å¤‡ä»½é…ç½®ä¿å­˜æˆåŠŸï¼"),yield G()):g(c.message||"è‡ªåŠ¨å¤‡ä»½é…ç½®ä¿å­˜å¤±è´¥","error"),d.autoBackupConfig=!1}),A=()=>{if(!s.scheduled.enabled)return"æœªå¯ç”¨";const c=String(s.scheduled.hour).padStart(2,"0"),t=String(s.scheduled.minute).padStart(2,"0");return`æ¯å¤© ${c}:${t}`};return Q(()=>x(null,null,function*(){yield I(),yield T(),u.configured&&(yield q()),yield G()})),(c,t)=>{var P;return v(),p("div",Ua,[e("div",Aa,[e("button",{class:z(["tab",{active:i.value==="local"}]),onClick:t[0]||(t[0]=f=>i.value="local")}," ğŸ“¦ æœ¬åœ°å¤‡ä»½ ",2),e("button",{class:z(["tab",{active:i.value==="webdav"}]),onClick:t[1]||(t[1]=f=>i.value="webdav")}," â˜ï¸ WebDAVå¤‡ä»½ ",2),e("button",{class:z(["tab",{active:i.value==="auto"}]),onClick:t[2]||(t[2]=f=>i.value="auto")}," âš™ï¸ è‡ªåŠ¨å¤‡ä»½é…ç½® ",2)]),C(e("div",Da,[e("div",Sa,[e("button",{class:"btn btn-primary",onClick:E,disabled:d.create},[t[25]||(t[25]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"})],-1)),N(" "+y(d.create?"å¤‡ä»½ä¸­...":"åˆ›å»ºå¤‡ä»½"),1)],8,Ta),e("button",{class:"btn btn-success",onClick:me,disabled:d.upload},[t[26]||(t[26]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5-5 5 5M12 15V3"})],-1)),N(" "+y(d.upload?"ä¸Šä¼ ä¸­...":"ä¸Šä¼ å¤‡ä»½"),1)],8,Ia),e("button",{class:"btn btn-secondary",onClick:I,disabled:d.list},[t[27]||(t[27]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)),N(" "+y(d.list?"åˆ·æ–°ä¸­...":"åˆ·æ–°åˆ—è¡¨"),1)],8,La),e("input",{ref_key:"fileInput",ref:S,type:"file",accept:".zip",onChange:be,style:{display:"none"}},null,544)]),a.value.text?(v(),p("div",{key:0,class:z(["message",a.value.type])},y(a.value.text),3)):L("",!0),e("div",Wa,[w.value.length===0&&!d.list?(v(),p("div",Na,[...t[28]||(t[28]=[e("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"#ccc","stroke-width":"1.5"},[e("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e("circle",{cx:"12",cy:"7",r:"4"})],-1),e("p",null,"æš‚æ— å¤‡ä»½æ–‡ä»¶",-1)])])):(v(),p("div",za,[(v(!0),p(O,null,F(w.value,f=>(v(),p("div",{key:f.name,class:"backup-card"},[t[33]||(t[33]=e("div",{class:"backup-icon"},[e("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2"},[e("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e("polyline",{points:"14 2 14 8 20 8"})])],-1)),e("div",Pa,[e("div",Ha,y(f.name),1),e("div",Oa,[e("span",Fa,y(f.size),1),e("span",Ra,y(te(f.created)),1),f.signed?(v(),p("span",ja,"ğŸ”’")):(v(),p("span",Ea,"âš ï¸"))])]),e("div",qa,[e("button",{class:"btn-icon btn-restore",onClick:j=>X("restore",f),title:"æ¢å¤å¤‡ä»½"},[...t[29]||(t[29]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)])],8,Ja),e("button",{class:"btn-icon btn-rename",onClick:j=>R(f.name),title:"é‡å‘½å"},[...t[30]||(t[30]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,Ga),e("button",{class:"btn-icon",onClick:j=>pe(f.name),title:"ä¸‹è½½å¤‡ä»½"},[...t[31]||(t[31]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"})],-1)])],8,Ka),e("button",{class:"btn-icon btn-danger",onClick:j=>X("delete",f.name),title:"åˆ é™¤å¤‡ä»½"},[...t[32]||(t[32]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"3 6 5 6 21 6"}),e("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})],-1)])],8,Qa)])]))),128))]))])],512),[[ge,i.value==="local"]]),C(e("div",Xa,[e("div",Ya,[e("button",{class:"btn btn-primary",onClick:h},[...t[34]||(t[34]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"3"}),e("path",{d:"M12 1v6m0 6v6M5.64 5.64l4.24 4.24m4.24 4.24l4.24 4.24M1 12h6m6 0h6M5.64 18.36l4.24-4.24m4.24-4.24l4.24-4.24"})],-1),N(" WebDAVé…ç½® ",-1)])]),e("button",{class:"btn btn-primary",onClick:ae,disabled:d.webdavBackup||!u.configured},[t[35]||(t[35]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"})],-1)),N(" "+y(d.webdavBackup?"å¤‡ä»½ä¸­...":"å¤‡ä»½åˆ°WebDAV"),1)],8,Za),e("button",{class:"btn btn-secondary",onClick:q,disabled:d.webdavList||!u.configured},[t[36]||(t[36]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)),N(" "+y(d.webdavList?"åˆ·æ–°ä¸­...":"åˆ·æ–°åˆ—è¡¨"),1)],8,eo)]),a.value.text?(v(),p("div",{key:0,class:z(["message",a.value.type])},y(a.value.text),3)):L("",!0),u.configured?L("",!0):(v(),p("div",to,[...t[37]||(t[37]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),e("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})],-1),e("p",null,"è¯·å…ˆé…ç½®WebDAVè¿æ¥ä¿¡æ¯ï¼ˆæ”¯æŒï¼šåšæœäº‘ã€Nextcloudã€é˜¿é‡Œäº‘ç›˜WebDAVã€Dropboxç­‰ï¼‰",-1)])])),e("div",so,[M.value.length===0&&!d.webdavList?(v(),p("div",lo,[...t[38]||(t[38]=[e("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"#ccc","stroke-width":"1.5"},[e("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e("circle",{cx:"12",cy:"7",r:"4"})],-1),e("p",null,"æš‚æ— WebDAVå¤‡ä»½",-1)])])):(v(),p("div",ao,[(v(!0),p(O,null,F(M.value,f=>(v(),p("div",{key:f.name,class:"backup-card"},[t[41]||(t[41]=le('<div class="backup-icon" data-v-b8ebf567><svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#16a34a" stroke-width="2" data-v-b8ebf567><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" data-v-b8ebf567></path><polyline points="14 2 14 8 20 8" data-v-b8ebf567></polyline><path d="M12 18v-6M9 15l3 3 3-3" data-v-b8ebf567></path></svg></div>',1)),e("div",oo,[e("div",no,y(f.name),1),e("div",io,[e("span",ro,y(f.size),1),e("span",uo,y(te(f.created)),1)])]),e("div",co,[e("button",{class:"btn-icon btn-restore",onClick:j=>X("webdav-restore",f.name),title:"ä»WebDAVæ¢å¤"},[...t[39]||(t[39]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)])],8,vo),e("button",{class:"btn-icon btn-danger",onClick:j=>X("webdav-delete",f.name),title:"åˆ é™¤WebDAVå¤‡ä»½"},[...t[40]||(t[40]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"3 6 5 6 21 6"}),e("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})],-1)])],8,po)])]))),128))]))])],512),[[ge,i.value==="webdav"]]),C(e("div",mo,[a.value.text?(v(),p("div",{key:0,class:z(["message",a.value.type])},y(a.value.text),3)):L("",!0),e("div",bo,[t[76]||(t[76]=e("h3",null,"âš¡ è‡ªåŠ¨å¤‡ä»½é…ç½®",-1)),t[77]||(t[77]=e("p",{class:"config-description"},"é…ç½®ç³»ç»Ÿè‡ªåŠ¨å¤‡ä»½ç­–ç•¥ï¼ŒåŒ…æ‹¬å¢é‡å¤‡ä»½å’Œå®šæ—¶å¤‡ä»½ã€‚",-1)),e("div",go,[e("div",ho,[t[43]||(t[43]=e("h4",null,"å¢é‡å¤‡ä»½ï¼ˆé˜²æŠ–ï¼‰",-1)),e("label",fo,[C(e("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=f=>s.debounce.enabled=f)},null,512),[[ee,s.debounce.enabled]]),t[42]||(t[42]=e("span",{class:"slider"},null,-1))])]),t[48]||(t[48]=e("p",{class:"config-info"},"å½“æ•°æ®å˜æ›´æ—¶ï¼Œå»¶è¿Ÿä¸€æ®µæ—¶é—´åè‡ªåŠ¨å¤‡ä»½ã€‚é€‚åˆé¢‘ç¹ä¿®æ”¹çš„åœºæ™¯ã€‚",-1)),s.debounce.enabled?(v(),p("div",wo,[e("div",ko,[t[44]||(t[44]=e("label",null,"å»¶è¿Ÿæ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰",-1)),C(e("input",{type:"number","onUpdate:modelValue":t[4]||(t[4]=f=>s.debounce.delay=f),min:"5",max:"1440",class:"form-input"},null,512),[[D,s.debounce.delay,void 0,{number:!0}]]),t[45]||(t[45]=e("small",null,"æ•°æ®ä¿®æ”¹åå»¶è¿Ÿå¤šä¹…è§¦å‘å¤‡ä»½ï¼ŒèŒƒå›´ï¼š5-1440åˆ†é’Ÿ",-1))]),e("div",yo,[t[46]||(t[46]=e("label",null,"ä¿ç•™å¤‡ä»½æ•°é‡",-1)),C(e("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=f=>s.debounce.keep=f),min:"1",max:"30",class:"form-input"},null,512),[[D,s.debounce.keep,void 0,{number:!0}]]),t[47]||(t[47]=e("small",null,"è‡ªåŠ¨æ¸…ç†æ—¶ä¿ç•™æœ€æ–°çš„Nä¸ªå¤‡ä»½ï¼ŒèŒƒå›´ï¼š1-30ä¸ª",-1))])])):L("",!0)]),e("div",_o,[e("div",$o,[t[50]||(t[50]=e("h4",null,"å®šæ—¶å¤‡ä»½ï¼ˆæ¯æ—¥ï¼‰",-1)),e("label",Co,[C(e("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=f=>s.scheduled.enabled=f)},null,512),[[ee,s.scheduled.enabled]]),t[49]||(t[49]=e("span",{class:"slider"},null,-1))])]),t[58]||(t[58]=e("p",{class:"config-info"},"æ¯å¤©åœ¨å›ºå®šæ—¶é—´è‡ªåŠ¨æ‰§è¡Œå¤‡ä»½ã€‚",-1)),s.scheduled.enabled?(v(),p("div",Mo,[e("div",xo,[t[52]||(t[52]=e("label",null,"å¤‡ä»½æ—¶é—´",-1)),e("div",Vo,[C(e("input",{type:"number","onUpdate:modelValue":t[7]||(t[7]=f=>s.scheduled.hour=f),min:"0",max:"23",class:"form-input time-field",placeholder:"æ—¶"},null,512),[[D,s.scheduled.hour,void 0,{number:!0}]]),t[51]||(t[51]=e("span",null,":",-1)),C(e("input",{type:"number","onUpdate:modelValue":t[8]||(t[8]=f=>s.scheduled.minute=f),min:"0",max:"59",class:"form-input time-field",placeholder:"åˆ†"},null,512),[[D,s.scheduled.minute,void 0,{number:!0}]])]),t[53]||(t[53]=e("small",null,"æ ¼å¼ï¼š24å°æ—¶åˆ¶ï¼Œå¦‚ 02:00",-1))]),e("div",Bo,[t[54]||(t[54]=e("label",null,"ä¿ç•™å¤‡ä»½æ•°é‡",-1)),C(e("input",{type:"number","onUpdate:modelValue":t[9]||(t[9]=f=>s.scheduled.keep=f),min:"1",max:"30",class:"form-input"},null,512),[[D,s.scheduled.keep,void 0,{number:!0}]]),t[55]||(t[55]=e("small",null,"è‡ªåŠ¨æ¸…ç†æ—¶ä¿ç•™æœ€æ–°çš„Nä¸ªå¤‡ä»½ï¼ŒèŒƒå›´ï¼š1-30ä¸ª",-1))]),e("div",Uo,[e("label",Ao,[C(e("input",{type:"checkbox","onUpdate:modelValue":t[10]||(t[10]=f=>s.scheduled.onlyIfModified=f)},null,512),[[ee,s.scheduled.onlyIfModified]]),t[56]||(t[56]=e("span",null,"ä»…åœ¨æœ‰ä¿®æ”¹æ—¶å¤‡ä»½",-1))]),t[57]||(t[57]=e("small",null,"å¦‚æœ24å°æ—¶å†…å·²æœ‰å¢é‡å¤‡ä»½ï¼Œè·³è¿‡å®šæ—¶å¤‡ä»½ï¼ˆé¿å…é‡å¤ï¼‰",-1))])])):L("",!0)]),e("div",Do,[e("div",So,[t[60]||(t[60]=e("h4",null,"â˜ï¸ WebDAV è‡ªåŠ¨åŒæ­¥",-1)),e("label",To,[C(e("input",{type:"checkbox","onUpdate:modelValue":t[11]||(t[11]=f=>s.webdav.enabled=f),onChange:oe},null,544),[[ee,s.webdav.enabled]]),t[59]||(t[59]=e("span",{class:"slider"},null,-1))])]),e("p",Io,[t[61]||(t[61]=N(" è‡ªåŠ¨å°†æœ¬åœ°å¤‡ä»½åŒæ­¥åˆ° WebDAV äº‘ç«¯ã€‚ ",-1)),u.configured?L("",!0):(v(),p("span",Lo,'âš ï¸ è¯·å…ˆåœ¨"WebDAVå¤‡ä»½"æ ‡ç­¾é¡µé…ç½®è¿æ¥'))]),s.webdav.enabled?(v(),p("div",Wo,[e("div",No,[e("label",zo,[C(e("input",{type:"checkbox","onUpdate:modelValue":t[12]||(t[12]=f=>s.webdav.syncDaily=f)},null,512),[[ee,s.webdav.syncDaily]]),t[62]||(t[62]=e("span",null,"åŒæ­¥æ¯æ—¥å®šæ—¶å¤‡ä»½",-1))]),t[63]||(t[63]=e("small",null,"æ¯å¤©å®šæ—¶å¤‡ä»½åè‡ªåŠ¨ä¸Šä¼ åˆ° WebDAV",-1))]),e("div",Po,[e("label",Ho,[C(e("input",{type:"checkbox","onUpdate:modelValue":t[13]||(t[13]=f=>s.webdav.syncIncremental=f)},null,512),[[ee,s.webdav.syncIncremental]]),t[64]||(t[64]=e("span",null,"åŒæ­¥å¢é‡å¤‡ä»½",-1))]),t[65]||(t[65]=e("small",null,"å¢é‡å¤‡ä»½åè‡ªåŠ¨ä¸Šä¼ åˆ° WebDAV",-1))])])):L("",!0)]),e("div",Oo,[e("div",Fo,[t[67]||(t[67]=e("h4",null,"è‡ªåŠ¨æ¸…ç†",-1)),e("label",Ro,[C(e("input",{type:"checkbox","onUpdate:modelValue":t[14]||(t[14]=f=>s.autoClean=f)},null,512),[[ee,s.autoClean]]),t[66]||(t[66]=e("span",{class:"slider"},null,-1))])]),t[68]||(t[68]=e("p",{class:"config-info"},"è‡ªåŠ¨åˆ é™¤è¶…å‡ºä¿ç•™æ•°é‡çš„æ—§å¤‡ä»½æ–‡ä»¶ï¼ˆæŒ‰æ—¶é—´æ’åºï¼Œä¿ç•™æœ€æ–°çš„ï¼‰ã€‚",-1))]),r.value?(v(),p("div",jo,[t[73]||(t[73]=e("h4",null,"ğŸ“Š å¤‡ä»½ç»Ÿè®¡",-1)),e("div",Eo,[e("div",qo,[t[69]||(t[69]=e("span",{class:"stat-label"},"å¢é‡å¤‡ä»½æ•°é‡",-1)),e("span",Jo,y(((P=r.value.incremental)==null?void 0:P.count)||0)+" ä¸ª",1)]),e("div",Go,[t[70]||(t[70]=e("span",{class:"stat-label"},"æœ€åå¢é‡å¤‡ä»½",-1)),e("span",Ko,y(te(r.value.lastDebounce)||"æ— "),1)]),e("div",Qo,[t[71]||(t[71]=e("span",{class:"stat-label"},"æœ€åå®šæ—¶å¤‡ä»½",-1)),e("span",Xo,y(te(r.value.lastScheduled)||"æ— "),1)]),e("div",Yo,[t[72]||(t[72]=e("span",{class:"stat-label"},"ä¸‹æ¬¡å®šæ—¶å¤‡ä»½",-1)),e("span",Zo,y(A()),1)])])])):L("",!0),e("div",en,[e("button",{class:"btn btn-secondary",onClick:G},[...t[74]||(t[74]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1),N(" é‡ç½® ",-1)])]),e("button",{class:"btn btn-primary",onClick:de,disabled:d.autoBackupConfig},[t[75]||(t[75]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),e("polyline",{points:"17 21 17 13 7 13 7 21"}),e("polyline",{points:"7 3 7 8 15 8"})],-1)),N(" "+y(d.autoBackupConfig?"ä¿å­˜ä¸­...":"ä¿å­˜é…ç½®"),1)],8,tn)])])],512),[[ge,i.value==="auto"]]),V.value?(v(),p("div",sn,[e("div",ln,[t[82]||(t[82]=e("h3",null,"WebDAVé…ç½®",-1)),e("div",an,[t[78]||(t[78]=e("label",null,[N("WebDAV URL "),e("span",{class:"required"},"*")],-1)),C(e("input",{type:"text","onUpdate:modelValue":t[15]||(t[15]=f=>o.url=f),placeholder:"https://dav.jianguoyun.com/dav/",class:"form-input"},null,512),[[D,o.url]]),t[79]||(t[79]=e("small",null,"ä¾‹ï¼šåšæœäº‘ https://dav.jianguoyun.com/dav/",-1))]),e("div",on,[t[80]||(t[80]=e("label",null,[N("ç”¨æˆ·å "),e("span",{class:"required"},"*")],-1)),C(e("input",{type:"text","onUpdate:modelValue":t[16]||(t[16]=f=>o.username=f),placeholder:"é‚®ç®±æˆ–ç”¨æˆ·å",class:"form-input"},null,512),[[D,o.username]])]),e("div",nn,[t[81]||(t[81]=e("label",null,[N("å¯†ç  "),e("span",{class:"required"},"*")],-1)),C(e("input",{type:"password","onUpdate:modelValue":t[17]||(t[17]=f=>o.password=f),placeholder:u.configured?"ç•™ç©ºåˆ™ä¿æŒåŸå¯†ç ä¸å˜":"åº”ç”¨å¯†ç æˆ–è®¿é—®ä»¤ç‰Œ",class:"form-input"},null,8,dn),[[D,o.password]]),u.configured?(v(),p("small",un,"å¦‚éœ€ä¿®æ”¹å¯†ç è¯·è¾“å…¥æ–°å¯†ç ï¼Œç•™ç©ºåˆ™ä¿æŒåŸå¯†ç ä¸å˜")):(v(),p("small",rn,"æ³¨æ„ï¼šæŸäº›æœåŠ¡éœ€è¦ä½¿ç”¨åº”ç”¨ä¸“ç”¨å¯†ç ï¼Œè€Œä¸æ˜¯ç™»å½•å¯†ç "))]),e("div",cn,[e("button",{class:"btn btn-secondary",onClick:t[18]||(t[18]=f=>V.value=!1)},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:K,disabled:d.webdavConfig},y(d.webdavConfig?"æµ‹è¯•è¿æ¥ä¸­...":"ä¿å­˜"),9,vn)])])])):L("",!0),l.show?(v(),p("div",pn,[e("div",mn,[e("h3",null,"ç¡®è®¤"+y(l.title),1),e("p",bn,y(l.message),1),e("div",gn,[e("button",{class:"btn btn-secondary",onClick:t[19]||(t[19]=f=>l.show=!1),disabled:l.processing},"å–æ¶ˆ",8,hn),e("button",{class:z(["btn",l.confirmClass]),onClick:Y,disabled:l.processing},y(l.processing?"å¤„ç†ä¸­...":"ç¡®è®¤"),11,fn)])])])):L("",!0),$.value?(v(),p("div",wn,[e("div",kn,[t[86]||(t[86]=e("h3",null,"åˆ›å»ºå¤‡ä»½",-1)),e("div",yn,[t[83]||(t[83]=e("label",null,"å¤‡ä»½åç§°ï¼ˆå¯é€‰ï¼‰",-1)),C(e("input",{type:"text","onUpdate:modelValue":t[20]||(t[20]=f=>b.name=f),placeholder:"ä¾‹å¦‚ï¼šæ·»åŠ ä¹¦ç­¾åçš„å¤‡ä»½",class:"form-input",maxlength:"50"},null,512),[[D,b.name]]),t[84]||(t[84]=e("small",null,"ç•™ç©ºåˆ™ä½¿ç”¨é»˜è®¤åç§°ï¼ˆbackup-æ—¶é—´æˆ³ï¼‰",-1))]),e("div",_n,[t[85]||(t[85]=e("label",null,"å¤‡ä»½æè¿°ï¼ˆå¯é€‰ï¼‰",-1)),C(e("textarea",{"onUpdate:modelValue":t[21]||(t[21]=f=>b.description=f),placeholder:"æè¿°è¿™æ¬¡å¤‡ä»½çš„å†…å®¹æˆ–ç›®çš„...",class:"form-input",rows:"3"},null,512),[[D,b.description]])]),e("div",$n,[e("button",{class:"btn btn-secondary",onClick:t[22]||(t[22]=f=>$.value=!1)},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:H,disabled:d.create},y(d.create?"å¤‡ä»½ä¸­...":"åˆ›å»ºå¤‡ä»½"),9,Cn)])])])):L("",!0),B.value?(v(),p("div",Mn,[e("div",xn,[t[88]||(t[88]=e("h3",null,"é‡å‘½åå¤‡ä»½",-1)),e("div",Vn,[t[87]||(t[87]=e("label",null,[N("æ–°åç§° "),e("span",{class:"required"},"*")],-1)),C(e("input",{type:"text","onUpdate:modelValue":t[23]||(t[23]=f=>n.newName=f),placeholder:"è¾“å…¥æ–°çš„å¤‡ä»½åç§°",class:"form-input",maxlength:"50"},null,512),[[D,n.newName]]),e("small",null,"åŸåç§°ï¼š"+y(n.oldName),1)]),e("div",Bn,[e("button",{class:"btn btn-secondary",onClick:t[24]||(t[24]=f=>B.value=!1)},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:U,disabled:d.rename||!n.newName.trim()},y(d.rename?"é‡å‘½åä¸­...":"ç¡®è®¤é‡å‘½å"),9,Un)])])])):L("",!0)])}}},Dn=J(An,[["__scopeId","data-v-b8ebf567"]]),Sn={key:0,class:"login-container"},Tn={class:"login-card"},In={class:"login-form"},Ln={class:"password-input-wrapper"},Wn=["type"],Nn={key:0,width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},zn={key:1,width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},Pn={class:"login-buttons"},Hn=["disabled"],On={key:0,class:"login-error"},Fn={key:1,class:"admin-layout"},Rn={class:"menu-list"},jn={class:"admin-main"},En={class:"admin-header"},qn={class:"header-title"},Jn={class:"admin-content"},Gn={__name:"Admin",setup(W){const i=_("welcome"),w={welcome:yt,menu:Xt,card:Ns,duplicate:kl,tag:zl,ad:ea,friend:ua,user:Ba,backup:Dn},M=ce(()=>w[i.value]),V=ce(()=>i.value==="welcome"?{lastLoginTime:$.value,lastLoginIp:B.value,currentUsername:S.value}:{}),$=_(""),B=_(""),S=_("admin"),d=_(!1),b=_(""),n=_(""),a=_(!1),l=_(""),u=_(!1),o=_(!1),s=ce(()=>{switch(i.value){case"menu":return"æ ç›®ç®¡ç†";case"card":return"å¡ç‰‡ç®¡ç†";case"duplicate":return"å»é‡ç®¡ç†";case"tag":return"æ ‡ç­¾ç®¡ç†";case"ad":return"å¹¿å‘Šç®¡ç†";case"friend":return"å‹é“¾ç®¡ç†";case"user":return"ç”¨æˆ·ç®¡ç†";case"backup":return"å¤‡ä»½ç®¡ç†";default:return""}});Q(()=>{const R=localStorage.getItem("token");d.value=!!R,d.value&&r()});function r(){return x(this,null,function*(){try{const R=yield fetch("/api/users/me",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(R.ok){const U=yield R.json();$.value=U.last_login_time||"",B.value=U.last_login_ip||"",S.value=U.username||"admin"}}catch(R){console.error("è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:",R)}})}function k(){return x(this,null,function*(){var R,U;if(!b.value||!n.value){l.value="è¯·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ";return}a.value=!0,l.value="";try{const I=yield vt(b.value,n.value);I.data.token&&(localStorage.setItem("token",I.data.token),d.value=!0,$.value=I.data.lastLoginTime||"",B.value=I.data.lastLoginIp||"",yield r())}catch(I){l.value=((U=(R=I.response)==null?void 0:R.data)==null?void 0:U.message)||"ç™»å½•å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç”¨æˆ·åå’Œå¯†ç "}finally{a.value=!1}})}function m(){localStorage.removeItem("token"),d.value=!1,b.value="",n.value="",l.value=""}function g(){window.open("/","_blank")}function E(){o.value=!o.value}function H(){o.value=!1}return(R,U)=>d.value?(v(),p("div",Fn,[e("aside",{class:z(["admin-sider",{open:o.value}]),onClick:ve(H,["self"])},[e("div",{class:"logo clickable",onClick:U[3]||(U[3]=I=>{i.value="welcome",H()})},"Admin"),e("ul",Rn,[e("li",{class:z({active:i.value==="menu"}),onClick:U[4]||(U[4]=I=>{i.value="menu",H()})},"æ ç›®ç®¡ç†",2),e("li",{class:z({active:i.value==="card"}),onClick:U[5]||(U[5]=I=>{i.value="card",H()})},"å¡ç‰‡ç®¡ç†",2),e("li",{class:z({active:i.value==="duplicate"}),onClick:U[6]||(U[6]=I=>{i.value="duplicate",H()})},"å»é‡ç®¡ç†",2),e("li",{class:z({active:i.value==="tag"}),onClick:U[7]||(U[7]=I=>{i.value="tag",H()})},"æ ‡ç­¾ç®¡ç†",2),e("li",{class:z({active:i.value==="ad"}),onClick:U[8]||(U[8]=I=>{i.value="ad",H()})},"å¹¿å‘Šç®¡ç†",2),e("li",{class:z({active:i.value==="friend"}),onClick:U[9]||(U[9]=I=>{i.value="friend",H()})},"å‹é“¾ç®¡ç†",2),e("li",{class:z({active:i.value==="user"}),onClick:U[10]||(U[10]=I=>{i.value="user",H()})},"ç”¨æˆ·ç®¡ç†",2),e("li",{class:z({active:i.value==="backup"}),onClick:U[11]||(U[11]=I=>{i.value="backup",H()})},"å¤‡ä»½ç®¡ç†",2)])],2),e("main",jn,[e("div",En,[e("button",{class:"menu-toggle",onClick:E}," â˜° "),e("div",qn,y(s.value),1),e("div",{class:"header-actions"},[e("span",{class:"home-icon",onClick:g,title:"è¿›å…¥ä¸»é¡µ"},[...U[16]||(U[16]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},[e("path",{d:"M3 10.5L12 4l9 6.5V20a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1v-4h-4v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V10.5z",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])]),e("button",{class:"btn logout-btn",onClick:m},"é€€å‡ºç™»å½•")])]),e("div",Jn,[xe(Be,{name:"fade",mode:"out-in"},{default:Ve(()=>[(v(),ze(Pe(M.value),He({key:i.value},V.value),null,16))]),_:1})]),U[17]||(U[17]=e("footer",{class:"admin-footer"},[e("p",{class:"admin-copyright"},[N("Copyright Â© 2025 Con-Nav-Item | "),e("a",{href:"https://github.com/zczy-k/Con-Nav-Item",target:"_blank",class:"footer-link"},"Powered by zczy-k")])],-1))])])):(v(),p("div",Sn,[e("div",Tn,[U[15]||(U[15]=e("h2",{class:"login-title"},"åå°ç®¡ç†ç™»å½•",-1)),e("div",In,[C(e("input",{"onUpdate:modelValue":U[0]||(U[0]=I=>b.value=I),type:"text",placeholder:"ç”¨æˆ·åï¼ˆé»˜è®¤ï¼šadminï¼‰",class:"login-input",onKeyup:$e(k,["enter"])},null,544),[[D,b.value]]),e("div",Ln,[C(e("input",{"onUpdate:modelValue":U[1]||(U[1]=I=>n.value=I),type:u.value?"text":"password",placeholder:"å¯†ç ï¼ˆé»˜è®¤ï¼š123456ï¼‰",class:"login-input password-input",onKeyup:$e(k,["enter"])},null,40,Wn),[[Ne,n.value]]),e("span",{class:"toggle-password",onClick:U[2]||(U[2]=I=>u.value=!u.value)},[u.value?(v(),p("svg",Nn,[...U[12]||(U[12]=[e("path",{d:"M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12z"},null,-1),e("circle",{cx:"12",cy:"12",r:"3"},null,-1)])])):(v(),p("svg",zn,[...U[13]||(U[13]=[e("path",{d:"M17.94 17.94A10.94 10.94 0 0 1 12 19c-7 0-11-7-11-7a21.77 21.77 0 0 1 5.06-6.06"},null,-1),e("path",{d:"M1 1l22 22"},null,-1),e("path",{d:"M9.53 9.53A3 3 0 0 0 12 15a3 3 0 0 0 2.47-5.47"},null,-1)])]))])]),e("div",Pn,[e("button",{onClick:g,class:"back-btn"},[...U[14]||(U[14]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1),N(" è¿”å›é¦–é¡µ ",-1)])]),e("button",{onClick:k,class:"login-btn",disabled:a.value},y(a.value?"ç™»å½•ä¸­...":"ç™»å½•"),9,Hn)]),l.value?(v(),p("p",On,y(l.value),1)):L("",!0)])])]))}},Yn=J(Gn,[["__scopeId","data-v-2762ba0b"]]);export{Yn as default};
