var Ke=Object.defineProperty,Ne=Object.defineProperties;var Fe=Object.getOwnPropertyDescriptors;var Te=Object.getOwnPropertySymbols;var Oe=Object.prototype.hasOwnProperty,He=Object.prototype.propertyIsEnumerable;var Ue=(o,s,i)=>s in o?Ke(o,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[s]=i,q=(o,s)=>{for(var i in s||(s={}))Oe.call(s,i)&&Ue(o,i,s[i]);if(Te)for(var i of Te(s))He.call(s,i)&&Ue(o,i,s[i]);return o},ne=(o,s)=>Ne(o,Fe(s));var M=(o,s,i)=>new Promise((T,t)=>{var r=m=>{try{c(i.next(m))}catch(k){t(k)}},d=m=>{try{c(i.throw(m))}catch(k){t(k)}},c=m=>m.done?T(m.value):Promise.resolve(m.value).then(r,d);c((i=i.apply(o,s)).next())});import{_ as Y,b as a,d as l,e,t as u,A as re,r as x,o as ae,h as I,q as $,v as L,s as $e,F as N,g as F,c as de,k as Ve,C as ie,z as W,n as ve,w as ue,i as z,D as oe,E as we,y as J,G as Ae,l as Pe,H as Ee,I as Ge,a as je,m as qe,p as Je,f as Qe,J as Xe,K as Ye}from"./index-CfQK0ihy.js";import{g as xe,n as Ze,y as es,x as ss,u as ts,o as ns,p as ls,c as Se,l as as,q as Ie,w as Be,f as os,z as is,A as rs,B as _e,C as ds,D as us,E as cs,F as vs,i as ye,b as ps,G as ms,H as gs,I as hs,J as fs,K as bs,L as ys,M as Le,N as Me,O as ks,P as ws,Q as _s,R as Cs,S as $s,T as Ms,U as xs,V as Ss}from"./urlNormalizer-C5OcIviR.js";const Ts={class:"welcome-page"},Us={class:"welcome-title"},Vs={class:"welcome-cards"},As={class:"welcome-card"},Is={class:"welcome-value"},Bs={class:"welcome-card"},Ds={class:"welcome-value"},Ps={__name:"WelcomePage",props:{lastLoginTime:String,lastLoginIp:String,currentUsername:String},setup(o){return(s,i)=>(l(),a("div",Ts,[e("h2",Us,"æ¬¢è¿æ‚¨ï¼Œ"+u(o.currentUsername||"admin")+"ï¼",1),e("div",Vs,[e("div",As,[i[0]||(i[0]=re('<div class="welcome-icon time-icon" data-v-5cc4f846><svg width="32" height="32" viewBox="0 0 24 24" fill="none" data-v-5cc4f846><circle cx="12" cy="12" r="10" stroke="#1abc9c" stroke-width="2" data-v-5cc4f846></circle><path d="M12 6v6l4 2" stroke="#1abc9c" stroke-width="2" stroke-linecap="round" data-v-5cc4f846></path></svg></div><div class="welcome-label" data-v-5cc4f846>ä¸Šæ¬¡ç™»å½•æ—¶é—´</div>',2)),e("div",Is,u(o.lastLoginTime||"--"),1)]),e("div",Bs,[i[1]||(i[1]=re('<div class="welcome-icon ip-icon" data-v-5cc4f846><svg width="32" height="32" viewBox="0 0 24 24" fill="none" data-v-5cc4f846><circle cx="12" cy="12" r="10" stroke="#1abc9c" stroke-width="2" data-v-5cc4f846></circle><path d="M12 8a4 4 0 1 1 0 8 4 4 0 0 1 0-8z" stroke="#1abc9c" stroke-width="2" data-v-5cc4f846></path><circle cx="12" cy="12" r="2" fill="#1abc9c" data-v-5cc4f846></circle></svg></div><div class="welcome-label" data-v-5cc4f846>ä¸Šæ¬¡ç™»å½•IP</div>',2)),e("div",Ds,u(o.lastLoginIp||"--"),1)])])]))}},Es=Y(Ps,[["__scopeId","data-v-5cc4f846"]]),Ls={class:"menu-manage"},Rs={key:0,class:"loading-overlay"},Ws={class:"menu-header"},zs={class:"menu-add"},Ks=["disabled"],Ns={class:"menu-content"},Fs={key:0,class:"empty-state"},Os={class:"menu-card-header"},Hs={class:"menu-title"},Gs={class:"menu-name"},js={class:"menu-order"},qs={class:"menu-actions"},Js=["onClick"],Qs=["onClick"],Xs=["onClick"],Ys={key:0,class:"sub-menu-list"},Zs={class:"sub-menu-name"},et={class:"sub-menu-order"},st={class:"sub-menu-actions"},tt=["onClick"],nt=["onClick"],lt={key:1,class:"no-sub-menu"},at={key:1,class:"modal-overlay"},ot={class:"modal"},it={class:"modal-header"},rt={class:"modal-body"},dt={class:"form-group"},ut={class:"form-group"},ct={class:"modal-footer"},vt=["disabled"],pt={key:2,class:"modal-overlay"},mt={class:"modal"},gt={class:"modal-header"},ht={class:"modal-body"},ft={class:"form-group"},bt={class:"form-group"},yt={class:"modal-footer"},kt=["disabled"],wt={key:3,class:"modal-overlay"},_t={class:"modal"},Ct={class:"modal-body"},$t={class:"form-group"},Mt={class:"form-group"},xt={class:"modal-footer"},St=["disabled"],Tt={__name:"MenuManage",setup(o){const s=x([]),i=x(!1),T=x("åŠ è½½ä¸­..."),t=x(""),r=x(!1),d=x(null),c=x({name:"",order:0}),m=x(!1),k=x(null),C=x(""),y=x({name:"",order:0}),V=x(!1),b=x(null),g=x({name:"",order:0});ae(()=>{v()});function h(){try{window.dispatchEvent(new CustomEvent("nav-menus-updated")),console.log("[æ ç›®ç®¡ç†] å·²é€šçŸ¥æ‰©å±•åˆ·æ–°å³é”®èœå•")}catch(R){console.warn("[æ ç›®ç®¡ç†] é€šçŸ¥æ‰©å±•å¤±è´¥:",R)}}function v(R=!1){return M(this,null,function*(){var _,D;i.value=!0,T.value="åŠ è½½ä¸­...";try{const P=yield xe(!0);s.value=P.data||[],R&&h()}catch(P){alert("åŠ è½½å¤±è´¥: "+(((D=(_=P.response)==null?void 0:_.data)==null?void 0:D.error)||P.message))}finally{i.value=!1}})}function B(){return M(this,null,function*(){var R,_;if(t.value.trim()){i.value=!0,T.value="æ·»åŠ ä¸­...";try{const D=s.value.length?Math.max(...s.value.map(P=>P.order||0)):0;yield Ze({name:t.value.trim(),order:D+1}),t.value="",yield v(!0)}catch(D){alert("æ·»åŠ å¤±è´¥: "+(((_=(R=D.response)==null?void 0:R.data)==null?void 0:_.error)||D.message)),i.value=!1}}})}function U(R){d.value=R,c.value={name:R.name,order:R.order},r.value=!0}function A(){return M(this,null,function*(){var P,f;if(!c.value.name.trim()||!d.value)return;const R=d.value.id,_=c.value.name.trim(),D=c.value.order;K(),i.value=!0,T.value="ä¿å­˜ä¸­...";try{yield ts(R,{name:_,order:D}),yield v(!0)}catch(p){alert("ä¿å­˜å¤±è´¥: "+(((f=(P=p.response)==null?void 0:P.data)==null?void 0:f.error)||p.message)),i.value=!1}})}function H(R){return M(this,null,function*(){var _,D;if(confirm(`ç¡®å®šåˆ é™¤ä¸»èœå•ã€Œ${R.name}ã€å—ï¼Ÿ
å°†åŒæ—¶åˆ é™¤å…¶ä¸‹æ‰€æœ‰å­èœå•å’Œå¡ç‰‡ï¼`)){i.value=!0,T.value="åˆ é™¤ä¸­...";try{yield es(R.id),yield v(!0)}catch(P){alert("åˆ é™¤å¤±è´¥: "+(((D=(_=P.response)==null?void 0:_.data)==null?void 0:D.error)||P.message)),i.value=!1}}})}function X(R){k.value=R.id,C.value=R.name;const _=R.subMenus||[],D=_.length?Math.max(..._.map(P=>P.order||0)):0;y.value={name:"",order:D+1},m.value=!0}function ee(){return M(this,null,function*(){var P,f;if(!y.value.name.trim()||!k.value)return;const R=k.value,_=y.value.name.trim(),D=y.value.order;K(),i.value=!0,T.value="æ·»åŠ ä¸­...";try{yield ns(R,{name:_,order:D}),yield v(!0)}catch(p){alert("æ·»åŠ å¤±è´¥: "+(((f=(P=p.response)==null?void 0:P.data)==null?void 0:f.error)||p.message)),i.value=!1}})}function se(R,_){b.value=_,g.value={name:_.name,order:_.order},V.value=!0}function le(){return M(this,null,function*(){var P,f;if(!g.value.name.trim()||!b.value)return;const R=b.value.id,_=g.value.name.trim(),D=g.value.order;K(),i.value=!0,T.value="ä¿å­˜ä¸­...";try{yield ls(R,{name:_,order:D}),yield v(!0)}catch(p){alert("ä¿å­˜å¤±è´¥: "+(((f=(P=p.response)==null?void 0:P.data)==null?void 0:f.error)||p.message)),i.value=!1}})}function te(R){return M(this,null,function*(){var _,D;if(confirm(`ç¡®å®šåˆ é™¤å­èœå•ã€Œ${R.name}ã€å—ï¼Ÿ
å°†åŒæ—¶åˆ é™¤å…¶ä¸‹æ‰€æœ‰å¡ç‰‡ï¼`)){i.value=!0,T.value="åˆ é™¤ä¸­...";try{yield ss(R.id),yield v(!0)}catch(P){alert("åˆ é™¤å¤±è´¥: "+(((D=(_=P.response)==null?void 0:_.data)==null?void 0:D.error)||P.message)),i.value=!1}}})}function K(){r.value=!1,m.value=!1,V.value=!1,d.value=null,b.value=null}return(R,_)=>(l(),a("div",Ls,[i.value?(l(),a("div",Rs,[_[7]||(_[7]=e("div",{class:"loading-spinner"},null,-1)),e("span",null,u(T.value),1)])):I("",!0),e("div",Ws,[_[8]||(_[8]=e("h2",{class:"page-title"},"æ ç›®ç®¡ç†",-1)),e("div",zs,[$(e("input",{"onUpdate:modelValue":_[0]||(_[0]=D=>t.value=D),placeholder:"è¾“å…¥ä¸»èœå•åç§°",class:"input",onKeyup:$e(B,["enter"])},null,544),[[L,t.value]]),e("button",{class:"btn btn-primary",onClick:B,disabled:i.value||!t.value.trim()}," + æ·»åŠ ä¸»èœå• ",8,Ks)])]),e("div",Ns,[s.value.length===0?(l(),a("div",Fs,[..._[9]||(_[9]=[e("p",null,"æš‚æ— èœå•ï¼Œè¯·æ·»åŠ ç¬¬ä¸€ä¸ªä¸»èœå•",-1)])])):I("",!0),(l(!0),a(N,null,F(s.value,D=>(l(),a("div",{key:D.id,class:"menu-card"},[e("div",Os,[e("div",Hs,[e("span",Gs,u(D.name),1),e("span",js,"æ’åº: "+u(D.order),1)]),e("div",qs,[e("button",{class:"btn-icon btn-edit",onClick:P=>U(D),title:"ç¼–è¾‘"},[..._[10]||(_[10]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,Js),e("button",{class:"btn-icon btn-add",onClick:P=>X(D),title:"æ·»åŠ å­èœå•"},[..._[11]||(_[11]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1)])],8,Qs),e("button",{class:"btn-icon btn-delete",onClick:P=>H(D),title:"åˆ é™¤"},[..._[12]||(_[12]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"})],-1)])],8,Xs)])]),D.subMenus&&D.subMenus.length>0?(l(),a("div",Ys,[(l(!0),a(N,null,F(D.subMenus,P=>(l(),a("div",{key:P.id,class:"sub-menu-item"},[e("span",Zs,u(P.name),1),e("span",et,"æ’åº: "+u(P.order),1),e("div",st,[e("button",{class:"btn-icon-sm btn-edit",onClick:f=>se(D,P),title:"ç¼–è¾‘"},[..._[13]||(_[13]=[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,tt),e("button",{class:"btn-icon-sm btn-delete",onClick:f=>te(P),title:"åˆ é™¤"},[..._[14]||(_[14]=[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"})],-1)])],8,nt)])]))),128))])):(l(),a("div",lt,[..._[15]||(_[15]=[e("span",null,"æš‚æ— å­èœå•",-1)])]))]))),128))]),r.value?(l(),a("div",at,[e("div",ot,[e("div",it,[e("h3",null,u(d.value?"ç¼–è¾‘ä¸»èœå•":"æ·»åŠ å­èœå•"),1),e("button",{class:"modal-close",onClick:K},"Ã—")]),e("div",rt,[e("div",dt,[_[16]||(_[16]=e("label",null,"åç§°",-1)),$(e("input",{"onUpdate:modelValue":_[1]||(_[1]=D=>c.value.name=D),type:"text",class:"input",placeholder:"è¯·è¾“å…¥åç§°"},null,512),[[L,c.value.name]])]),e("div",ut,[_[17]||(_[17]=e("label",null,"æ’åº",-1)),$(e("input",{"onUpdate:modelValue":_[2]||(_[2]=D=>c.value.order=D),type:"number",class:"input",placeholder:"æ•°å­—è¶Šå°è¶Šé å‰"},null,512),[[L,c.value.order,void 0,{number:!0}]])])]),e("div",ct,[e("button",{class:"btn btn-cancel",onClick:K},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:A,disabled:!c.value.name.trim()},"ä¿å­˜",8,vt)])])])):I("",!0),m.value?(l(),a("div",pt,[e("div",mt,[e("div",gt,[e("h3",null,"æ·»åŠ å­èœå•åˆ°ã€Œ"+u(C.value)+"ã€",1),e("button",{class:"modal-close",onClick:K},"Ã—")]),e("div",ht,[e("div",ft,[_[18]||(_[18]=e("label",null,"å­èœå•åç§°",-1)),$(e("input",{"onUpdate:modelValue":_[3]||(_[3]=D=>y.value.name=D),type:"text",class:"input",placeholder:"è¯·è¾“å…¥å­èœå•åç§°"},null,512),[[L,y.value.name]])]),e("div",bt,[_[19]||(_[19]=e("label",null,"æ’åº",-1)),$(e("input",{"onUpdate:modelValue":_[4]||(_[4]=D=>y.value.order=D),type:"number",class:"input",placeholder:"æ•°å­—è¶Šå°è¶Šé å‰"},null,512),[[L,y.value.order,void 0,{number:!0}]])])]),e("div",yt,[e("button",{class:"btn btn-cancel",onClick:K},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:ee,disabled:!y.value.name.trim()},"æ·»åŠ ",8,kt)])])])):I("",!0),V.value?(l(),a("div",wt,[e("div",_t,[e("div",{class:"modal-header"},[_[20]||(_[20]=e("h3",null,"ç¼–è¾‘å­èœå•",-1)),e("button",{class:"modal-close",onClick:K},"Ã—")]),e("div",Ct,[e("div",$t,[_[21]||(_[21]=e("label",null,"å­èœå•åç§°",-1)),$(e("input",{"onUpdate:modelValue":_[5]||(_[5]=D=>g.value.name=D),type:"text",class:"input",placeholder:"è¯·è¾“å…¥å­èœå•åç§°"},null,512),[[L,g.value.name]])]),e("div",Mt,[_[22]||(_[22]=e("label",null,"æ’åº",-1)),$(e("input",{"onUpdate:modelValue":_[6]||(_[6]=D=>g.value.order=D),type:"number",class:"input",placeholder:"æ•°å­—è¶Šå°è¶Šé å‰"},null,512),[[L,g.value.order,void 0,{number:!0}]])])]),e("div",xt,[e("button",{class:"btn btn-cancel",onClick:K},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:le,disabled:!g.value.name.trim()},"ä¿å­˜",8,St)])])])):I("",!0)]))}},Ut=Y(Tt,[["__scopeId","data-v-7671c3a1"]]),Vt={class:"card-manage"},At={class:"card-header"},It={class:"card-add"},Bt=["value"],Dt=["value"],Pt={class:"card-card"},Et={class:"card-table"},Lt=["onUpdate:modelValue","onBlur"],Rt=["onUpdate:modelValue","onBlur"],Wt=["onUpdate:modelValue","onBlur"],zt=["onUpdate:modelValue","onBlur"],Kt=["onClick"],Nt={key:0,class:"selected-tags"},Ft={key:1,class:"tag-placeholder"},Ot=["onUpdate:modelValue","onBlur"],Ht=["onClick"],Gt={class:"modal-body"},jt={key:0,class:"empty-tags"},qt={key:1,class:"tag-options"},Jt=["checked","onChange"],Qt={class:"modal-body"},Xt={class:"duplicate-comparison"},Yt={class:"card-info-box existing"},Zt={class:"card-details"},en={class:"detail-row"},sn={class:"detail-value"},tn={class:"detail-row"},nn={class:"detail-value url"},ln={key:0,class:"detail-row"},an={class:"detail-value url"},on={class:"card-info-box pending"},rn={class:"card-details"},dn={class:"detail-row"},un={class:"detail-value"},cn={class:"detail-row"},vn={class:"detail-value url"},pn={key:0,class:"detail-row"},mn={class:"detail-value url"},gn={__name:"CardManage",setup(o){const s=x([]),i=x([]),T=x(),t=x(""),r=x(""),d=x(""),c=x(""),m=x([]),k=x(!1),C=x(null),y=x([]),V=x(!1),b=x(null),g=x(null),h=de(()=>{if(!T.value)return[];const f=s.value.find(p=>p.id===T.value);return(f==null?void 0:f.subMenus)||[]});ae(()=>M(null,null,function*(){const f=yield xe();s.value=f.data,s.value.length&&(T.value=s.value[0].id,t.value="");const p=yield Se();m.value=p.data})),Ve(T,()=>{t.value="",U()}),Ve(t,U);function v(){t.value=""}function B(){U()}function U(){return M(this,null,function*(){if(!T.value)return;const f=yield os(T.value,t.value||null);i.value=f.data})}function A(){return M(this,null,function*(){if(!r.value||!d.value)return;const f=i.value.find(p=>as({title:r.value,url:d.value},p));f?(b.value=f,g.value={menu_id:T.value,sub_menu_id:t.value||null,title:r.value,url:d.value,logo_url:c.value},V.value=!0):yield K({menu_id:T.value,sub_menu_id:t.value||null,title:r.value,url:d.value,logo_url:c.value})})}function H(f){return M(this,null,function*(){yield Ie(f.id,{menu_id:T.value,sub_menu_id:t.value||null,title:f.title,url:f.url,logo_url:f.logo_url,desc:f.desc,order:f.order,tagIds:f.tags?f.tags.map(p=>p.id):[]}),U()})}function X(f){return M(this,null,function*(){if(!confirm("ç¡®å®šè¦åˆ é™¤è¿™å¼ å¡ç‰‡å—ï¼Ÿ"))return;const p=i.value.findIndex(Q=>Q.id===f);p>-1&&i.value.splice(p,1);try{yield Be(f)}catch(Q){console.error("åˆ é™¤å¡ç‰‡å¤±è´¥:",Q),yield U()}})}function ee(f){C.value=f,y.value=f.tags?f.tags.map(p=>p.id):[],k.value=!0}function se(){k.value=!1,C.value=null,y.value=[]}function le(f){const p=y.value.indexOf(f);p>-1?y.value.splice(p,1):y.value.push(f)}function te(){return M(this,null,function*(){C.value&&(yield Ie(C.value.id,{menu_id:C.value.menu_id,sub_menu_id:C.value.sub_menu_id,title:C.value.title,url:C.value.url,logo_url:C.value.logo_url,desc:C.value.desc,order:C.value.order,tagIds:y.value}),se(),U())})}function K(f){return M(this,null,function*(){yield is(f),r.value="",d.value="",c.value="",U()})}function R(){V.value=!1,b.value=null,g.value=null}function _(){R(),r.value="",d.value="",c.value=""}function D(){return M(this,null,function*(){!g.value||!b.value||(yield Be(b.value.id),yield K(g.value),R())})}function P(){g.value&&(r.value=g.value.title,d.value=g.value.url,c.value=g.value.logo_url||"",R(),alert("è¯·ä¿®æ”¹å¡ç‰‡ä¿¡æ¯åå†æ¬¡ç‚¹å‡»â€œæ·»åŠ å¡ç‰‡â€æŒ‰é’®"))}return(f,p)=>{var Q,pe,me,ge,he,Z,fe,be;return l(),a("div",Vt,[e("div",At,[p[9]||(p[9]=e("div",{class:"header-content"},[e("h2",{class:"page-title"},"ç®¡ç†ç½‘ç«™å¯¼èˆªå¡ç‰‡ï¼Œæ”¯æŒä¸»èœå•å’Œå­èœå•åˆ†ç±»")],-1)),e("div",It,[$(e("select",{"onUpdate:modelValue":p[0]||(p[0]=E=>T.value=E),class:"input narrow",onChange:v},[(l(!0),a(N,null,F(s.value,E=>(l(),a("option",{value:E.id,key:E.id},u(E.name),9,Bt))),128))],544),[[ie,T.value]]),$(e("select",{"onUpdate:modelValue":p[1]||(p[1]=E=>t.value=E),class:"input narrow",onChange:B},[p[7]||(p[7]=e("option",{value:""},"ä¸»èœå•",-1)),(l(!0),a(N,null,F(h.value,E=>(l(),a("option",{value:E.id,key:E.id},u(E.name),9,Dt))),128))],544),[[ie,t.value]]),$(e("input",{"onUpdate:modelValue":p[2]||(p[2]=E=>r.value=E),placeholder:"å¡ç‰‡æ ‡é¢˜",class:"input narrow"},null,512),[[L,r.value]]),$(e("input",{"onUpdate:modelValue":p[3]||(p[3]=E=>d.value=E),placeholder:"å¡ç‰‡é“¾æ¥",class:"input wide"},null,512),[[L,d.value]]),$(e("input",{"onUpdate:modelValue":p[4]||(p[4]=E=>c.value=E),placeholder:"logoé“¾æ¥(å¯é€‰)",class:"input wide"},null,512),[[L,c.value]]),e("button",{class:"btn",onClick:A},[...p[8]||(p[8]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),W(" æ·»åŠ å¡ç‰‡ ",-1)])])])]),e("div",Pt,[e("table",Et,[p[11]||(p[11]=e("thead",null,[e("tr",null,[e("th",null,"æ ‡é¢˜"),e("th",null,"ç½‘å€"),e("th",null,"Logoé“¾æ¥"),e("th",null,"æè¿°"),e("th",null,"æ ‡ç­¾"),e("th",null,"æ’åº"),e("th",null,"æ“ä½œ")])],-1)),e("tbody",null,[(l(!0),a(N,null,F(i.value,E=>(l(),a("tr",{key:E.id},[e("td",null,[$(e("input",{"onUpdate:modelValue":O=>E.title=O,onBlur:O=>H(E),class:"table-input"},null,40,Lt),[[L,E.title]])]),e("td",null,[$(e("input",{"onUpdate:modelValue":O=>E.url=O,onBlur:O=>H(E),class:"table-input"},null,40,Rt),[[L,E.url]])]),e("td",null,[$(e("input",{"onUpdate:modelValue":O=>E.logo_url=O,onBlur:O=>H(E),class:"table-input",placeholder:"logoé“¾æ¥(å¯é€‰)"},null,40,Wt),[[L,E.logo_url]])]),e("td",null,[$(e("input",{"onUpdate:modelValue":O=>E.desc=O,onBlur:O=>H(E),class:"table-input",placeholder:"æè¿°ï¼ˆå¯é€‰ï¼‰"},null,40,zt),[[L,E.desc]])]),e("td",null,[e("div",{class:"tag-selector",onClick:O=>ee(E)},[E.tags&&E.tags.length>0?(l(),a("div",Nt,[(l(!0),a(N,null,F(E.tags,O=>(l(),a("span",{key:O.id,class:"mini-tag",style:ve({backgroundColor:O.color})},u(O.name),5))),128))])):(l(),a("span",Ft,"é€‰æ‹©æ ‡ç­¾"))],8,Kt)]),e("td",null,[$(e("input",{"onUpdate:modelValue":O=>E.order=O,type:"number",onBlur:O=>H(E),class:"table-input order-input"},null,40,Ot),[[L,E.order,void 0,{number:!0}]])]),e("td",null,[e("button",{class:"btn btn-danger btn-icon",onClick:O=>X(E.id),title:"åˆ é™¤"},[...p[10]||(p[10]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)])],8,Ht)])]))),128))])])]),k.value?(l(),a("div",{key:0,class:"modal-overlay",onClick:se},[e("div",{class:"modal-content",onClick:p[5]||(p[5]=ue(()=>{},["stop"]))},[e("div",{class:"modal-header"},[p[12]||(p[12]=e("h3",null,"é€‰æ‹©æ ‡ç­¾",-1)),e("button",{class:"close-btn",onClick:se},"Ã—")]),e("div",Gt,[m.value.length===0?(l(),a("div",jt,[...p[13]||(p[13]=[e("p",null,"æš‚æ— æ ‡ç­¾ï¼Œè¯·å…ˆåœ¨æ ‡ç­¾ç®¡ç†é¡µé¢åˆ›å»º",-1)])])):(l(),a("div",qt,[(l(!0),a(N,null,F(m.value,E=>(l(),a("label",{key:E.id,class:"tag-option"},[e("input",{type:"checkbox",checked:y.value.includes(E.id),onChange:O=>le(E.id)},null,40,Jt),e("span",{class:"tag-label",style:ve({backgroundColor:E.color})},u(E.name),5)]))),128))]))]),e("div",{class:"modal-footer"},[e("button",{class:"btn btn-secondary",onClick:se},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:te},"ç¡®å®š")])])])):I("",!0),V.value?(l(),a("div",{key:1,class:"modal-overlay",onClick:R},[e("div",{class:"modal-content duplicate-modal",onClick:p[6]||(p[6]=ue(()=>{},["stop"]))},[e("div",{class:"modal-header"},[p[14]||(p[14]=re('<div class="header-with-icon" data-v-edd548d5><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#dc2626" stroke-width="2" data-v-edd548d5><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z" data-v-edd548d5></path><line x1="12" y1="9" x2="12" y2="13" data-v-edd548d5></line><line x1="12" y1="17" x2="12.01" y2="17" data-v-edd548d5></line></svg><h3 data-v-edd548d5>æ£€æµ‹åˆ°é‡å¤å¡ç‰‡</h3></div>',1)),e("button",{class:"close-btn",onClick:R},"Ã—")]),e("div",Qt,[p[24]||(p[24]=e("div",{class:"duplicate-warning"},[e("p",{class:"warning-text"},"æ‚¨è¦æ·»åŠ çš„å¡ç‰‡ä¸ä»¥ä¸‹ç°æœ‰å¡ç‰‡é‡å¤ï¼š")],-1)),e("div",Xt,[e("div",Yt,[p[18]||(p[18]=e("div",{class:"box-header"},[e("span",{class:"box-label"},"ç°æœ‰å¡ç‰‡")],-1)),e("div",Zt,[e("div",en,[p[15]||(p[15]=e("span",{class:"detail-label"},"æ ‡é¢˜ï¼š",-1)),e("span",sn,u((Q=b.value)==null?void 0:Q.title),1)]),e("div",tn,[p[16]||(p[16]=e("span",{class:"detail-label"},"ç½‘å€ï¼š",-1)),e("span",nn,u((pe=b.value)==null?void 0:pe.url),1)]),(me=b.value)!=null&&me.logo_url?(l(),a("div",ln,[p[17]||(p[17]=e("span",{class:"detail-label"},"Logoï¼š",-1)),e("span",an,u((ge=b.value)==null?void 0:ge.logo_url),1)])):I("",!0)])]),p[23]||(p[23]=e("div",{class:"arrow-divider"},[e("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"#9ca3af","stroke-width":"2"},[e("path",{d:"M5 12h14M12 5l7 7-7 7"})])],-1)),e("div",on,[p[22]||(p[22]=e("div",{class:"box-header"},[e("span",{class:"box-label"},"å¾…æ·»åŠ å¡ç‰‡")],-1)),e("div",rn,[e("div",dn,[p[19]||(p[19]=e("span",{class:"detail-label"},"æ ‡é¢˜ï¼š",-1)),e("span",un,u((he=g.value)==null?void 0:he.title),1)]),e("div",cn,[p[20]||(p[20]=e("span",{class:"detail-label"},"ç½‘å€ï¼š",-1)),e("span",vn,u((Z=g.value)==null?void 0:Z.url),1)]),(fe=g.value)!=null&&fe.logo_url?(l(),a("div",pn,[p[21]||(p[21]=e("span",{class:"detail-label"},"Logoï¼š",-1)),e("span",mn,u((be=g.value)==null?void 0:be.logo_url),1)])):I("",!0)])])]),p[25]||(p[25]=e("div",{class:"duplicate-actions-info"},[e("p",null,"è¯·é€‰æ‹©å¦‚ä½•å¤„ç†ï¼š")],-1))]),e("div",{class:"modal-footer duplicate-footer"},[e("button",{class:"btn btn-secondary",onClick:_},[...p[26]||(p[26]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M18 6L6 18M6 6l12 12"})],-1),W(" è·³è¿‡ ",-1)])]),e("button",{class:"btn btn-warning",onClick:D},[...p[27]||(p[27]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 12a9 9 0 11-9-9c2.52 0 4.93 1 6.74 2.74L21 8"}),e("path",{d:"M21 3v5h-5"})],-1),W(" æ›¿æ¢ ",-1)])]),e("button",{class:"btn btn-primary",onClick:P},[...p[28]||(p[28]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1),W(" ç¼–è¾‘åæ·»åŠ  ",-1)])])])])])):I("",!0)])}}},hn=Y(gn,[["__scopeId","data-v-edd548d5"]]),fn={class:"duplicate-manage"},bn={class:"section-header"},yn=["disabled"],kn={key:0,class:"duplicate-results"},wn={class:"result-summary"},_n={class:"summary-card"},Cn={class:"summary-value"},$n={class:"summary-card warning"},Mn={class:"summary-value"},xn={class:"summary-card danger"},Sn={class:"summary-value"},Tn={class:"duplicate-groups"},Un={class:"group-header"},Vn={class:"group-count"},An={class:"card-item original"},In={class:"card-info"},Bn={class:"card-title"},Dn={class:"card-url"},Pn={key:0,class:"card-desc"},En={class:"card-id"},Ln={class:"duplicates-list"},Rn={class:"card-info"},Wn={class:"card-title"},zn={class:"card-url"},Kn={key:0,class:"card-desc"},Nn={class:"card-actions"},Fn={class:"card-id"},On=["onClick","disabled"],Hn={class:"group-actions"},Gn=["onClick","disabled"],jn={class:"global-actions"},qn=["disabled"],Jn={key:1,class:"no-duplicates"},Qn={key:2,class:"initial-hint"},Xn={key:3,class:"error"},Yn={__name:"DuplicateManage",setup(o){const s=x(!1),i=x(!1),T=x(!1),t=x([]),r=x(0),d=x(0),c=x("");function m(){return M(this,null,function*(){var V,b;s.value=!0,c.value="";try{const g=yield rs();r.value=g.data.total,t.value=g.data.duplicateGroups,d.value=g.data.duplicateCount,T.value=!0}catch(g){c.value=((b=(V=g.response)==null?void 0:V.data)==null?void 0:b.error)||"æ£€æµ‹å¤±è´¥",console.error("æ£€æµ‹é‡å¤å¤±è´¥:",g)}finally{s.value=!1}})}function k(V){return M(this,null,function*(){var b,g,h;if(confirm("ç¡®å®šè¦åˆ é™¤è¿™å¼ å¡ç‰‡å—ï¼Ÿ")){i.value=!0,c.value="";try{console.log("[å»é‡ç®¡ç†] åˆ é™¤å•ä¸ªå¡ç‰‡:",V);const v=yield _e([V]);console.log("[å»é‡ç®¡ç†] åˆ é™¤å“åº”:",v.data),v.data.success?(console.log("[å»é‡ç®¡ç†] åˆ é™¤æˆåŠŸï¼Œé‡æ–°æ£€æµ‹..."),yield m()):c.value="åˆ é™¤å¤±è´¥ï¼š"+(v.data.message||"æœªçŸ¥é”™è¯¯")}catch(v){console.error("[å»é‡ç®¡ç†] åˆ é™¤å¡ç‰‡å¤±è´¥:",v),console.error("[å»é‡ç®¡ç†] é”™è¯¯è¯¦æƒ…:",(b=v.response)==null?void 0:b.data),c.value=((h=(g=v.response)==null?void 0:g.data)==null?void 0:h.error)||v.message||"åˆ é™¤å¤±è´¥"}finally{i.value=!1}}})}function C(V){return M(this,null,function*(){var g,h,v;const b=V.duplicates.length;if(confirm(`ç¡®å®šè¦åˆ é™¤è¿™ ${b} å¼ é‡å¤å¡ç‰‡å—ï¼Ÿ

å°†ä¿ç•™ï¼š${V.original.title}`)){i.value=!0,c.value="";try{const B=V.duplicates.map(A=>A.id);console.log("[å»é‡ç®¡ç†] åˆ é™¤ä¸€ç»„é‡å¤å¡ç‰‡:",B);const U=yield _e(B);console.log("[å»é‡ç®¡ç†] åˆ é™¤å“åº”:",U.data),U.data.success?(console.log("[å»é‡ç®¡ç†] åˆ é™¤æˆåŠŸï¼Œé‡æ–°æ£€æµ‹..."),yield m()):c.value="åˆ é™¤å¤±è´¥ï¼š"+(U.data.message||"æœªçŸ¥é”™è¯¯")}catch(B){console.error("[å»é‡ç®¡ç†] åˆ é™¤é‡å¤å¡ç‰‡å¤±è´¥:",B),console.error("[å»é‡ç®¡ç†] é”™è¯¯è¯¦æƒ…:",(g=B.response)==null?void 0:g.data),c.value=((v=(h=B.response)==null?void 0:h.data)==null?void 0:v.error)||B.message||"åˆ é™¤å¤±è´¥"}finally{i.value=!1}}})}function y(){return M(this,null,function*(){var b,g,h;const V=d.value;if(confirm(`ç¡®å®šè¦åˆ é™¤æ‰€æœ‰ ${V} å¼ é‡å¤å¡ç‰‡å—ï¼Ÿ

æ­¤æ“ä½œä¸å¯æ’¤é”€ï¼`)){i.value=!0,c.value="";try{const v=t.value.flatMap(U=>U.duplicates.map(A=>A.id));console.log("[å»é‡ç®¡ç†] åˆ é™¤æ‰€æœ‰é‡å¤å¡ç‰‡:",v);const B=yield _e(v);console.log("[å»é‡ç®¡ç†] åˆ é™¤å“åº”:",B.data),B.data.success?(console.log("[å»é‡ç®¡ç†] åˆ é™¤æˆåŠŸï¼Œé‡æ–°æ£€æµ‹..."),yield m()):c.value="åˆ é™¤å¤±è´¥ï¼š"+(B.data.message||"æœªçŸ¥é”™è¯¯")}catch(v){console.error("[å»é‡ç®¡ç†] åˆ é™¤æ‰€æœ‰é‡å¤å¤±è´¥:",v),console.error("[å»é‡ç®¡ç†] é”™è¯¯è¯¦æƒ…:",(b=v.response)==null?void 0:b.data),c.value=((h=(g=v.response)==null?void 0:g.data)==null?void 0:h.error)||v.message||"åˆ é™¤å¤±è´¥"}finally{i.value=!1}}})}return(V,b)=>(l(),a("div",fn,[e("div",bn,[b[0]||(b[0]=e("h3",null,"å¡ç‰‡å»é‡ç®¡ç†",-1)),e("button",{onClick:m,class:"btn btn-primary",disabled:s.value},u(s.value?"æ£€æµ‹ä¸­...":"ğŸ” ä¸€é”®æ£€æµ‹é‡å¤"),9,yn)]),t.value.length>0?(l(),a("div",kn,[e("div",wn,[e("div",_n,[b[1]||(b[1]=e("div",{class:"summary-label"},"æ€»å¡ç‰‡æ•°",-1)),e("div",Cn,u(r.value),1)]),e("div",$n,[b[2]||(b[2]=e("div",{class:"summary-label"},"é‡å¤ç»„æ•°",-1)),e("div",Mn,u(t.value.length),1)]),e("div",xn,[b[3]||(b[3]=e("div",{class:"summary-label"},"é‡å¤å¡ç‰‡",-1)),e("div",Sn,u(d.value),1)])]),e("div",Tn,[(l(!0),a(N,null,F(t.value,(g,h)=>(l(),a("div",{key:h,class:"duplicate-group"},[e("div",Un,[e("h4",null,"é‡å¤ç»„ "+u(h+1),1),e("span",Vn,u(g.totalCount)+" å¼ å¡ç‰‡",1)]),e("div",An,[b[4]||(b[4]=e("div",{class:"card-badge"},"ä¿ç•™",-1)),e("div",In,[e("div",Bn,u(g.original.title),1),e("div",Dn,u(g.original.url),1),g.original.desc?(l(),a("div",Pn,u(g.original.desc),1)):I("",!0)]),e("div",En,"ID: "+u(g.original.id),1)]),e("div",Ln,[(l(!0),a(N,null,F(g.duplicates,v=>(l(),a("div",{key:v.id,class:"card-item duplicate"},[b[5]||(b[5]=e("div",{class:"card-badge danger"},"é‡å¤",-1)),e("div",Rn,[e("div",Wn,u(v.title),1),e("div",zn,u(v.url),1),v.desc?(l(),a("div",Kn,u(v.desc),1)):I("",!0)]),e("div",Nn,[e("span",Fn,"ID: "+u(v.id),1),e("button",{onClick:B=>k(v.id),class:"btn-remove",disabled:i.value,title:"åˆ é™¤æ­¤å¡ç‰‡"}," åˆ é™¤ ",8,On)])]))),128))]),e("div",Hn,[e("button",{onClick:v=>C(g),class:"btn btn-danger",disabled:i.value}," åˆ é™¤æ­¤ç»„æ‰€æœ‰é‡å¤å¡ç‰‡ ("+u(g.duplicates.length)+" å¼ ) ",9,Gn)])]))),128))]),e("div",jn,[e("button",{onClick:y,class:"btn btn-danger btn-large",disabled:i.value},u(i.value?"åˆ é™¤ä¸­...":`åˆ é™¤æ‰€æœ‰é‡å¤å¡ç‰‡ (${d.value} å¼ )`),9,qn)])])):T.value&&t.value.length===0?(l(),a("div",Jn,[...b[6]||(b[6]=[e("svg",{width:"80",height:"80",viewBox:"0 0 24 24",fill:"none",stroke:"#1abc9c","stroke-width":"2"},[e("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e("polyline",{points:"22 4 12 14.01 9 11.01"})],-1),e("h3",null,"å¤ªæ£’äº†ï¼æ²¡æœ‰å‘ç°é‡å¤å¡ç‰‡",-1),e("p",null,"æ‚¨çš„å¯¼èˆªå¡ç‰‡éƒ½æ˜¯å”¯ä¸€çš„",-1)])])):T.value?I("",!0):(l(),a("div",Qn,[...b[7]||(b[7]=[re('<svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="#666" stroke-width="2" data-v-62bbc778><circle cx="12" cy="12" r="10" data-v-62bbc778></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" data-v-62bbc778></path><line x1="12" y1="17" x2="12.01" y2="17" data-v-62bbc778></line></svg><h3 data-v-62bbc778>ç‚¹å‡»&quot;ä¸€é”®æ£€æµ‹é‡å¤&quot;å¼€å§‹æ‰«æ</h3><p data-v-62bbc778>ç³»ç»Ÿå°†æ£€æµ‹æ‰€æœ‰é‡å¤çš„å¯¼èˆªå¡ç‰‡</p><ul class="hint-list" data-v-62bbc778><li data-v-62bbc778>ğŸ“Œ URL ç›¸åŒçš„å¡ç‰‡</li><li data-v-62bbc778>ğŸ“Œ æ ‡é¢˜ç›¸åŒä¸”åŸŸåç›¸åŒçš„å¡ç‰‡</li></ul>',4)])])),c.value?(l(),a("p",Xn,u(c.value),1)):I("",!0)]))}},Zn=Y(Yn,[["__scopeId","data-v-62bbc778"]]),el={class:"tag-manage"},sl={class:"tag-header"},tl={class:"tag-add"},nl={class:"tag-content"},ll={key:0,class:"empty-state"},al={key:1,class:"tag-list"},ol={class:"tag-info"},il=["onUpdate:modelValue","onBlur"],rl={class:"tag-stats"},dl={class:"card-count"},ul={class:"tag-controls"},cl=["onUpdate:modelValue","onChange"],vl={class:"tag-order"},pl=["onUpdate:modelValue","onBlur"],ml={class:"tag-actions"},gl=["onClick"],hl={__name:"TagManage",setup(o){const s=x([]),i=x(""),T=x("#2566d8");ae(t);function t(){return M(this,null,function*(){const m=yield Se();s.value=m.data;for(const k of s.value)try{const C=yield ds(k.id);k.cardCount=C.data.count}catch(C){k.cardCount=0}})}function r(){return M(this,null,function*(){var V,b;if(!i.value.trim())return;const m=s.value.length?Math.max(...s.value.map(g=>g.order||0)):0,k=i.value.trim(),C=T.value,y={id:Date.now(),name:k,color:C,order:m+1,cardCount:0,_temp:!0};s.value.push(y),i.value="",T.value="#2566d8";try{const g=yield us({name:k,color:C,order:m+1}),h=s.value.findIndex(v=>v.id===y.id);h>-1&&(s.value[h]=ne(q({},g.data),{cardCount:0}))}catch(g){const h=s.value.findIndex(v=>v.id===y.id);h>-1&&s.value.splice(h,1),alert("æ·»åŠ æ ‡ç­¾å¤±è´¥ï¼š"+(((b=(V=g.response)==null?void 0:V.data)==null?void 0:b.error)||g.message))}})}function d(m){return M(this,null,function*(){var k,C;if(!m._temp)try{yield cs(m.id,{name:m.name,color:m.color,order:m.order})}catch(y){alert("æ›´æ–°æ ‡ç­¾å¤±è´¥ï¼š"+(((C=(k=y.response)==null?void 0:k.data)==null?void 0:C.error)||y.message)),t()}})}function c(m){return M(this,null,function*(){var V,b;const k=s.value.find(g=>g.id===m);if(!k)return;const C=k.cardCount>0?`ç¡®å®šè¦åˆ é™¤æ ‡ç­¾"${k.name}"å—ï¼Ÿè¿™å°†å–æ¶ˆ ${k.cardCount} å¼ å¡ç‰‡çš„å…³è”ã€‚`:`ç¡®å®šè¦åˆ é™¤æ ‡ç­¾"${k.name}"å—ï¼Ÿ`;if(!confirm(C))return;const y=s.value.findIndex(g=>g.id===m);y>-1&&s.value.splice(y,1);try{yield vs(m)}catch(g){alert("åˆ é™¤æ ‡ç­¾å¤±è´¥ï¼š"+(((b=(V=g.response)==null?void 0:V.data)==null?void 0:b.error)||g.message)),t()}})}return(m,k)=>(l(),a("div",el,[e("div",sl,[k[3]||(k[3]=e("div",{class:"header-content"},[e("h2",{class:"page-title"},"ç®¡ç†æ ‡ç­¾"),e("p",{class:"page-desc"},"ä¸ºå¡ç‰‡åˆ›å»ºå¤šç»´åº¦åˆ†ç±»æ ‡ç­¾")],-1)),e("div",tl,[$(e("input",{"onUpdate:modelValue":k[0]||(k[0]=C=>i.value=C),placeholder:"æ ‡ç­¾åç§°",class:"input",maxlength:"20"},null,512),[[L,i.value]]),$(e("input",{"onUpdate:modelValue":k[1]||(k[1]=C=>T.value=C),type:"color",class:"color-input",title:"é€‰æ‹©æ ‡ç­¾é¢œè‰²"},null,512),[[L,T.value]]),e("button",{class:"btn btn-primary",onClick:r},[...k[2]||(k[2]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),W(" æ·»åŠ æ ‡ç­¾ ",-1)])])])]),e("div",nl,[s.value.length===0?(l(),a("div",ll,[...k[4]||(k[4]=[e("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1"},[e("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"}),e("line",{x1:"7",y1:"7",x2:"7.01",y2:"7"})],-1),e("p",null,"æš‚æ— æ ‡ç­¾",-1),e("p",{class:"hint"},"åˆ›å»ºç¬¬ä¸€ä¸ªæ ‡ç­¾ï¼Œå¼€å§‹ä¸ºå¡ç‰‡æ·»åŠ å¤šç»´åº¦åˆ†ç±»",-1)])])):(l(),a("div",al,[(l(!0),a(N,null,F(s.value,C=>(l(),a("div",{key:C.id,class:"tag-item"},[e("div",{class:"tag-preview",style:ve({backgroundColor:C.color})},[...k[5]||(k[5]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"}),e("line",{x1:"7",y1:"7",x2:"7.01",y2:"7"})],-1)])],4),e("div",ol,[$(e("input",{"onUpdate:modelValue":y=>C.name=y,onBlur:y=>d(C),class:"tag-name-input",maxlength:"20"},null,40,il),[[L,C.name]]),e("div",rl,[e("span",dl,u(C.cardCount||0)+" å¼ å¡ç‰‡",1)])]),e("div",ul,[$(e("input",{"onUpdate:modelValue":y=>C.color=y,type:"color",onChange:y=>d(C),class:"color-picker",title:"æ›´æ”¹é¢œè‰²"},null,40,cl),[[L,C.color]]),e("div",vl,[k[6]||(k[6]=e("span",{class:"order-label"},"æ’åº",-1)),$(e("input",{"onUpdate:modelValue":y=>C.order=y,type:"number",onBlur:y=>d(C),class:"order-input"},null,40,pl),[[L,C.order,void 0,{number:!0}]])])]),e("div",ml,[e("button",{class:"btn btn-danger btn-icon",onClick:y=>c(C.id),title:"åˆ é™¤æ ‡ç­¾"},[...k[7]||(k[7]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)])],8,gl)])]))),128))]))])]))}},fl=Y(hl,[["__scopeId","data-v-56efcb56"]]),bl={class:"promo-manage"},yl={key:0,class:"loading-overlay"},kl={class:"promo-header"},wl={class:"promo-form"},_l=["disabled"],Cl={class:"promo-section"},$l={class:"promo-list"},Ml={key:0,class:"empty-state"},xl={class:"promo-preview"},Sl=["src"],Tl={class:"promo-info"},Ul={class:"promo-field"},Vl=["onUpdate:modelValue","onBlur"],Al={class:"promo-field"},Il=["onUpdate:modelValue","onBlur"],Bl={class:"promo-actions"},Dl=["onClick"],Pl={class:"promo-section"},El={class:"promo-list"},Ll={key:0,class:"empty-state"},Rl={class:"promo-preview"},Wl=["src"],zl={class:"promo-info"},Kl={class:"promo-field"},Nl=["onUpdate:modelValue","onBlur"],Fl={class:"promo-field"},Ol=["onUpdate:modelValue","onBlur"],Hl={class:"promo-actions"},Gl=["onClick"],ke="/api",jl={__name:"PromoManage",setup(o){const s=()=>localStorage.getItem("token")||"",i=()=>({Authorization:`Bearer ${s()}`}),T=x([]),t=x(!1),r=x("åŠ è½½ä¸­..."),d=x({img:"",url:"",position:"left"}),c=de(()=>T.value.filter(g=>g.position==="left")),m=de(()=>T.value.filter(g=>g.position==="right"));ae(()=>{k()});function k(){return M(this,null,function*(){var g,h;t.value=!0,r.value="åŠ è½½ä¸­...";try{const v=yield ye.get(`${ke}/promos`);let B=[];Array.isArray(v.data)?B=v.data:v.data&&Array.isArray(v.data.data)&&(B=v.data.data),T.value=B}catch(v){console.error("åŠ è½½å®£ä¼ å¤±è´¥:",v),alert("åŠ è½½å®£ä¼ å¤±è´¥: "+(((h=(g=v.response)==null?void 0:g.data)==null?void 0:h.error)||v.message))}finally{t.value=!1}})}function C(){return M(this,null,function*(){var g,h;if(!d.value.img||!d.value.url){alert("è¯·å¡«å†™å®£ä¼ å›¾ç‰‡é“¾æ¥å’Œè·³è½¬é“¾æ¥");return}t.value=!0,r.value="æ·»åŠ ä¸­...";try{yield ye.post(`${ke}/promos`,d.value,{headers:i()}),d.value={img:"",url:"",position:"left"},yield k()}catch(v){alert("æ·»åŠ å¤±è´¥: "+(((h=(g=v.response)==null?void 0:g.data)==null?void 0:h.error)||v.message)),t.value=!1}})}function y(g){return M(this,null,function*(){var h,v;try{yield ye.put(`${ke}/promos/${g.id}`,{img:g.img,url:g.url},{headers:i()})}catch(B){alert("æ›´æ–°å¤±è´¥: "+(((v=(h=B.response)==null?void 0:h.data)==null?void 0:v.error)||B.message)),yield k()}})}function V(g){return M(this,null,function*(){var h,v;if(confirm("ç¡®å®šåˆ é™¤è¿™ä¸ªå®£ä¼ å—ï¼Ÿ")){t.value=!0,r.value="åˆ é™¤ä¸­...";try{yield ye.delete(`${ke}/promos/${g.id}`,{headers:i()}),yield k()}catch(B){alert("åˆ é™¤å¤±è´¥: "+(((v=(h=B.response)==null?void 0:h.data)==null?void 0:v.error)||B.message)),t.value=!1}}})}function b(g){g.target.src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="60"><rect fill="%23f0f0f0" width="100" height="60"/><text x="50" y="35" text-anchor="middle" fill="%23999" font-size="12">å›¾ç‰‡åŠ è½½å¤±è´¥</text></svg>'}return(g,h)=>(l(),a("div",bl,[t.value?(l(),a("div",yl,[h[3]||(h[3]=e("div",{class:"loading-spinner"},null,-1)),e("span",null,u(r.value),1)])):I("",!0),e("div",kl,[h[5]||(h[5]=e("h2",{class:"page-title"},"å®£ä¼ ç®¡ç†",-1)),e("div",wl,[$(e("input",{"onUpdate:modelValue":h[0]||(h[0]=v=>d.value.img=v),placeholder:"å®£ä¼ å›¾ç‰‡é“¾æ¥",class:"input"},null,512),[[L,d.value.img]]),$(e("input",{"onUpdate:modelValue":h[1]||(h[1]=v=>d.value.url=v),placeholder:"å®£ä¼ è·³è½¬é“¾æ¥",class:"input"},null,512),[[L,d.value.url]]),$(e("select",{"onUpdate:modelValue":h[2]||(h[2]=v=>d.value.position=v),class:"input select"},[...h[4]||(h[4]=[e("option",{value:"left"},"å·¦ä¾§å®£ä¼ ",-1),e("option",{value:"right"},"å³ä¾§å®£ä¼ ",-1)])],512),[[ie,d.value.position]]),e("button",{class:"btn btn-primary",onClick:C,disabled:!d.value.img||!d.value.url}," + æ·»åŠ å®£ä¼  ",8,_l)])]),e("div",Cl,[h[8]||(h[8]=e("h3",{class:"section-title"},"ğŸ“ å·¦ä¾§å®£ä¼ ",-1)),e("div",$l,[c.value.length===0?(l(),a("div",Ml,"æš‚æ— å·¦ä¾§å®£ä¼ ")):I("",!0),(l(!0),a(N,null,F(c.value,v=>(l(),a("div",{key:v.id,class:"promo-card"},[e("div",xl,[e("img",{src:v.img,alt:"å®£ä¼ å›¾ç‰‡",onError:b},null,40,Sl)]),e("div",Tl,[e("div",Ul,[h[6]||(h[6]=e("label",null,"å›¾ç‰‡é“¾æ¥",-1)),$(e("input",{"onUpdate:modelValue":B=>v.img=B,class:"input",onBlur:B=>y(v)},null,40,Vl),[[L,v.img]])]),e("div",Al,[h[7]||(h[7]=e("label",null,"è·³è½¬é“¾æ¥",-1)),$(e("input",{"onUpdate:modelValue":B=>v.url=B,class:"input",onBlur:B=>y(v)},null,40,Il),[[L,v.url]])])]),e("div",Bl,[e("button",{class:"btn btn-danger",onClick:B=>V(v)},"åˆ é™¤",8,Dl)])]))),128))])]),e("div",Pl,[h[11]||(h[11]=e("h3",{class:"section-title"},"ğŸ“ å³ä¾§å®£ä¼ ",-1)),e("div",El,[m.value.length===0?(l(),a("div",Ll,"æš‚æ— å³ä¾§å®£ä¼ ")):I("",!0),(l(!0),a(N,null,F(m.value,v=>(l(),a("div",{key:v.id,class:"promo-card"},[e("div",Rl,[e("img",{src:v.img,alt:"å®£ä¼ å›¾ç‰‡",onError:b},null,40,Wl)]),e("div",zl,[e("div",Kl,[h[9]||(h[9]=e("label",null,"å›¾ç‰‡é“¾æ¥",-1)),$(e("input",{"onUpdate:modelValue":B=>v.img=B,class:"input",onBlur:B=>y(v)},null,40,Nl),[[L,v.img]])]),e("div",Fl,[h[10]||(h[10]=e("label",null,"è·³è½¬é“¾æ¥",-1)),$(e("input",{"onUpdate:modelValue":B=>v.url=B,class:"input",onBlur:B=>y(v)},null,40,Ol),[[L,v.url]])])]),e("div",Hl,[e("button",{class:"btn btn-danger",onClick:B=>V(v)},"åˆ é™¤",8,Gl)])]))),128))])])]))}},ql=Y(jl,[["__scopeId","data-v-0221fbc3"]]),Jl={class:"friend-manage"},Ql={class:"friend-add"},Xl={class:"friend-card"},Yl={class:"friend-table"},Zl=["onUpdate:modelValue","onBlur"],ea=["onUpdate:modelValue","onBlur"],sa=["onUpdate:modelValue","onBlur"],ta=["onClick"],na={__name:"FriendLinkManage",setup(o){const s=x([]),i=x(""),T=x(""),t=x("");ae(r);function r(){return M(this,null,function*(){const k=yield ps();s.value=k.data})}function d(){return M(this,null,function*(){!i.value||!T.value||(yield ms({title:i.value,url:T.value,logo:t.value}),i.value="",T.value="",t.value="",r())})}function c(k){return M(this,null,function*(){yield gs(k.id,{title:k.title,url:k.url,logo:k.logo}),r()})}function m(k){return M(this,null,function*(){if(!confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå‹é“¾å—ï¼Ÿ"))return;const C=s.value.findIndex(y=>y.id===k);C>-1&&s.value.splice(C,1);try{yield hs(k)}catch(y){console.error("åˆ é™¤å‹é“¾å¤±è´¥:",y),yield r()}})}return(k,C)=>(l(),a("div",Jl,[C[4]||(C[4]=e("div",{class:"friend-header"},null,-1)),e("div",Ql,[$(e("input",{"onUpdate:modelValue":C[0]||(C[0]=y=>i.value=y),placeholder:"ç½‘ç«™å",class:"input"},null,512),[[L,i.value]]),$(e("input",{"onUpdate:modelValue":C[1]||(C[1]=y=>T.value=y),placeholder:"ç½‘ç«™é“¾æ¥",class:"input"},null,512),[[L,T.value]]),$(e("input",{"onUpdate:modelValue":C[2]||(C[2]=y=>t.value=y),placeholder:"logoé“¾æ¥(å¯é€‰)",class:"input"},null,512),[[L,t.value]]),e("button",{class:"btn",onClick:d},"æ·»åŠ å‹é“¾")]),e("div",Xl,[e("table",Yl,[C[3]||(C[3]=e("thead",null,[e("tr",null,[e("th",null,"ç½‘ç«™å"),e("th",null,"é“¾æ¥"),e("th",null,"Logo"),e("th",null,"æ“ä½œ")])],-1)),e("tbody",null,[(l(!0),a(N,null,F(s.value,y=>(l(),a("tr",{key:y.id},[e("td",null,[$(e("input",{"onUpdate:modelValue":V=>y.title=V,onBlur:V=>c(y),class:"input"},null,40,Zl),[[L,y.title]])]),e("td",null,[$(e("input",{"onUpdate:modelValue":V=>y.url=V,onBlur:V=>c(y),class:"input"},null,40,ea),[[L,y.url]])]),e("td",null,[$(e("input",{"onUpdate:modelValue":V=>y.logo=V,onBlur:V=>c(y),class:"input",placeholder:"logoé“¾æ¥(å¯é€‰)"},null,40,sa),[[L,y.logo]])]),e("td",null,[e("button",{class:"btn btn-danger",onClick:V=>m(y.id)},"åˆ é™¤",8,ta)])]))),128))])])])]))}},la=Y(na,[["__scopeId","data-v-c25e838c"]]),aa={class:"user-manage"},oa={class:"user-card"},ia={class:"username-section"},ra={class:"username-form"},da={class:"current-username"},ua={class:"username-display"},ca={class:"form-group"},va={class:"form-actions"},pa=["disabled"],ma={class:"password-section"},ga={class:"password-form"},ha={class:"form-group"},fa={class:"form-group"},ba={class:"form-group"},ya={class:"form-actions"},ka=["disabled"],wa={__name:"UserManage",setup(o){const s=x(""),i=x(""),T=x(""),t=x(!1),r=x(""),d=x("success"),c=x({}),m=x(""),k=x(!1),C=x(""),y=x("success");ae(()=>M(null,null,function*(){yield V()}));function V(){return M(this,null,function*(){try{const B=yield fs();c.value=B.data.data||B.data}catch(B){console.error("è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:",B)}})}function b(){return M(this,null,function*(){var B,U;if(!m.value){g("è¯·è¾“å…¥æ–°ç”¨æˆ·å","error");return}if(m.value.length<3||m.value.length>20){g("ç”¨æˆ·åé•¿åº¦åº”ä¸º3-20ä½","error");return}if(m.value===c.value.username){g("æ–°ç”¨æˆ·åä¸èƒ½ä¸å½“å‰ç”¨æˆ·åç›¸åŒ","error");return}k.value=!0,C.value="";try{yield bs(m.value),g("ç”¨æˆ·åä¿®æ”¹æˆåŠŸï¼2ç§’åè‡ªåŠ¨é€€å‡ºï¼Œè¯·ä½¿ç”¨æ–°ç”¨æˆ·åé‡æ–°ç™»å½•...","success"),m.value="",setTimeout(()=>{localStorage.removeItem("token"),window.location.href="/admin"},2e3)}catch(A){g(((U=(B=A.response)==null?void 0:B.data)==null?void 0:U.message)||"ç”¨æˆ·åä¿®æ”¹å¤±è´¥","error")}finally{k.value=!1}})}function g(B,U){C.value=B,y.value=U,setTimeout(()=>{C.value=""},3e3)}function h(){return M(this,null,function*(){var B,U;if(!s.value||!i.value||!T.value){v("è¯·å¡«å†™æ‰€æœ‰å¯†ç å­—æ®µ","error");return}if(i.value!==T.value){v("ä¸¤æ¬¡è¾“å…¥çš„æ–°å¯†ç ä¸ä¸€è‡´","error");return}if(i.value.length<6){v("æ–°å¯†ç é•¿åº¦è‡³å°‘6ä½","error");return}t.value=!0,r.value="";try{yield ys(s.value,i.value),v("å¯†ç ä¿®æ”¹æˆåŠŸ","success"),s.value="",i.value="",T.value=""}catch(A){v(((U=(B=A.response)==null?void 0:B.data)==null?void 0:U.message)||"å¯†ç ä¿®æ”¹å¤±è´¥","error")}finally{t.value=!1}})}function v(B,U){r.value=B,d.value=U,B==="å¯†ç ä¿®æ”¹æˆåŠŸ"&&U==="success"?setTimeout(()=>{r.value="2ç§’åè‡ªåŠ¨é€€å‡ºç™»å½•,è¯·ä½¿ç”¨æ–°å¯†ç é‡æ–°ç™»å½•...",setTimeout(()=>{localStorage.removeItem("token"),window.location.reload()},2e3)},500):setTimeout(()=>{r.value=""},3e3)}return(B,U)=>(l(),a("div",aa,[U[11]||(U[11]=e("div",{class:"user-header"},null,-1)),e("div",oa,[e("div",ia,[U[6]||(U[6]=e("h3",{class:"section-title"},"ä¿®æ”¹ç”¨æˆ·å",-1)),e("div",ra,[e("div",da,[U[4]||(U[4]=e("label",null,"å½“å‰ç”¨æˆ·åï¼š",-1)),e("span",ua,u(c.value.username||"admin"),1)]),e("div",ca,[U[5]||(U[5]=e("label",null,"æ–°ç”¨æˆ·åï¼š",-1)),$(e("input",{"onUpdate:modelValue":U[0]||(U[0]=A=>m.value=A),type:"text",placeholder:"è¯·è¾“å…¥æ–°ç”¨æˆ·åï¼ˆ3-20ä½ï¼‰",class:"input"},null,512),[[L,m.value]])]),e("div",va,[e("button",{onClick:b,class:"btn",disabled:k.value},u(k.value?"ä¿®æ”¹ä¸­...":"ä¿®æ”¹ç”¨æˆ·å"),9,pa)]),C.value?(l(),a("p",{key:0,class:z(["message",y.value])},u(C.value),3)):I("",!0)])]),e("div",ma,[U[10]||(U[10]=e("h3",{class:"section-title"},"ä¿®æ”¹å¯†ç ",-1)),e("div",ga,[e("div",ha,[U[7]||(U[7]=e("label",null,"å½“å‰å¯†ç ï¼š",-1)),$(e("input",{"onUpdate:modelValue":U[1]||(U[1]=A=>s.value=A),type:"password",placeholder:"è¯·è¾“å…¥å½“å‰å¯†ç ",class:"input"},null,512),[[L,s.value]])]),e("div",fa,[U[8]||(U[8]=e("label",null,"æ–°å¯†ç ï¼š",-1)),$(e("input",{"onUpdate:modelValue":U[2]||(U[2]=A=>i.value=A),type:"password",placeholder:"è¯·è¾“å…¥æ–°å¯†ç ",class:"input"},null,512),[[L,i.value]])]),e("div",ba,[U[9]||(U[9]=e("label",null,"ç¡®è®¤æ–°å¯†ç ï¼š",-1)),$(e("input",{"onUpdate:modelValue":U[3]||(U[3]=A=>T.value=A),type:"password",placeholder:"è¯·å†æ¬¡è¾“å…¥æ–°å¯†ç ",class:"input"},null,512),[[L,T.value]])]),e("div",ya,[e("button",{onClick:h,class:"btn",disabled:t.value},u(t.value?"ä¿®æ”¹ä¸­...":"ä¿®æ”¹å¯†ç "),9,ka)]),r.value?(l(),a("p",{key:0,class:z(["message",d.value])},u(r.value),3)):I("",!0)])])])]))}},_a=Y(wa,[["__scopeId","data-v-40392133"]]),Ca={class:"backup-manage"},$a={class:"tabs"},Ma={class:"tab-content"},xa={class:"toolbar"},Sa=["disabled"],Ta=["disabled"],Ua=["disabled"],Va={class:"backup-list"},Aa={key:0,class:"empty-state"},Ia={key:1,class:"backup-grid"},Ba={class:"backup-info"},Da={class:"backup-name"},Pa={class:"backup-meta"},Ea={class:"backup-size"},La={class:"backup-date"},Ra={key:0,class:"backup-signed",title:"å·²ç­¾åéªŒè¯"},Wa={key:1,class:"backup-unsigned",title:"æœªç­¾åï¼ˆå¤–éƒ¨ä¸Šä¼ ï¼‰"},za={class:"backup-actions"},Ka=["onClick"],Na=["onClick"],Fa=["onClick"],Oa=["onClick"],Ha={class:"tab-content"},Ga={class:"toolbar"},ja=["disabled"],qa=["disabled"],Ja={key:1,class:"info-box"},Qa={class:"backup-list"},Xa={key:0,class:"empty-state"},Ya={key:1,class:"backup-grid"},Za={class:"backup-info"},eo={class:"backup-name"},so={class:"backup-meta"},to={class:"backup-size"},no={class:"backup-date"},lo={class:"backup-actions"},ao=["onClick"],oo=["onClick"],io={class:"tab-content"},ro={class:"config-section"},uo={class:"config-card"},co={class:"config-header"},vo={class:"switch"},po={key:0,class:"config-fields"},mo={class:"field-row"},go={class:"field-row"},ho={class:"config-card"},fo={class:"config-header"},bo={class:"switch"},yo={key:0,class:"config-fields"},ko={class:"field-row"},wo={class:"time-input"},_o={class:"field-row"},Co={class:"field-row checkbox-row"},$o={class:"checkbox-label"},Mo={class:"config-card"},xo={class:"config-header"},So={class:"switch"},To={class:"config-info"},Uo={key:0,class:"warning-text"},Vo={key:0,class:"config-fields"},Ao={class:"field-row checkbox-row"},Io={class:"checkbox-label"},Bo={class:"field-row checkbox-row"},Do={class:"checkbox-label"},Po={class:"config-card"},Eo={class:"config-header"},Lo={class:"switch"},Ro={key:0,class:"stats-card"},Wo={class:"stats-grid"},zo={class:"stat-item"},Ko={class:"stat-value"},No={class:"stat-item"},Fo={class:"stat-value"},Oo={class:"stat-item"},Ho={class:"stat-value"},Go={class:"stat-item"},jo={class:"stat-value"},qo={class:"config-actions"},Jo=["disabled"],Qo={key:0,class:"modal-overlay"},Xo={class:"modal-content config-modal"},Yo={class:"form-group"},Zo={class:"form-group"},ei={class:"form-group"},si=["placeholder"],ti={key:0},ni={key:1},li={class:"modal-actions"},ai=["disabled"],oi={key:1,class:"modal-overlay"},ii={class:"modal-content"},ri={style:{"white-space":"pre-line"}},di={class:"modal-actions"},ui=["disabled"],ci=["disabled"],vi={key:2,class:"modal-overlay"},pi={class:"modal-content config-modal"},mi={class:"form-group"},gi={class:"form-group"},hi={class:"modal-actions"},fi=["disabled"],bi={key:3,class:"modal-overlay"},yi={class:"modal-content config-modal"},ki={class:"form-group"},wi={class:"modal-actions"},_i=["disabled"],Ci={__name:"BackupManage",setup(o){const s=x("local"),i=x([]),T=x([]),t=x(!1),r=x(!1),d=x(!1),c=x(null),m=oe({create:!1,list:!1,delete:!1,restore:!1,upload:!1,rename:!1,webdavConfig:!1,webdavBackup:!1,webdavList:!1,webdavRestore:!1,webdavDelete:!1,autoBackupConfig:!1}),k=oe({name:"",description:""}),C=oe({oldName:"",newName:""}),y=x({text:"",type:""}),V=oe({show:!1,filename:"",action:null,title:"",message:"",confirmClass:"",signed:!0,processing:!1}),b=oe({configured:!1,url:"",username:""}),g=oe({url:"",username:"",password:""}),h=oe({debounce:{enabled:!0,delay:5,keep:5},scheduled:{enabled:!0,hour:2,minute:0,keep:7,onlyIfModified:!0},webdav:{enabled:!1,syncDaily:!0,syncIncremental:!0},autoClean:!0}),v=x(null),B=localStorage.getItem("token");function U(G){return M(this,arguments,function*(w,n={}){return(yield fetch(w,ne(q({},n),{headers:q({Authorization:`Bearer ${B}`,"Content-Type":"application/json"},n.headers)}))).json()})}const A=(w,n="success",G=4e3)=>{y.value={text:w,type:n},setTimeout(()=>{y.value={text:"",type:""}},n==="error"?6e3:G)};function H(){try{window.dispatchEvent(new CustomEvent("nav-menus-updated")),console.log("[å¤‡ä»½ç®¡ç†] å·²é€šçŸ¥æ‰©å±•åˆ·æ–°å³é”®èœå•")}catch(w){console.warn("[å¤‡ä»½ç®¡ç†] é€šçŸ¥æ‰©å±•å¤±è´¥:",w)}}function X(){return M(this,null,function*(){try{const w=yield U("/api/ai/config/verify");w.success&&(w.status==="decrypt_failed"?(A("âš ï¸ AI é…ç½®æ¢å¤å¼‚å¸¸ï¼šAPI Key è§£å¯†å¤±è´¥ï¼Œè¯·å‰å¾€ AI è®¾ç½®é‡æ–°é…ç½®","warning",8e3),setTimeout(()=>{confirm(`AI é…ç½®çš„ API Key è§£å¯†å¤±è´¥ï¼Œå¯èƒ½æ˜¯å› ä¸ºå¤‡ä»½æ¥è‡ªä¸åŒçš„æœåŠ¡å™¨ã€‚

æ˜¯å¦ç°åœ¨å‰å¾€ AI è®¾ç½®é¡µé¢é‡æ–°é…ç½®ï¼Ÿ`)&&(window.location.href="/admin/ai-settings")},1e3)):w.status==="ok"&&console.log("[å¤‡ä»½ç®¡ç†] AI é…ç½®éªŒè¯é€šè¿‡"))}catch(w){console.warn("[å¤‡ä»½ç®¡ç†] AI é…ç½®éªŒè¯å¤±è´¥:",w)}})}const ee=()=>{k.name="",k.description="",r.value=!0},se=()=>M(null,null,function*(){m.create=!0;const w=yield U("/api/backup/create",{method:"POST",body:JSON.stringify({name:k.name||null,description:k.description||null})});w.success?(A("å¤‡ä»½åˆ›å»ºæˆåŠŸï¼"),r.value=!1,yield K()):A(w.message||"å¤‡ä»½åˆ›å»ºå¤±è´¥","error"),m.create=!1}),le=w=>{C.oldName=w,C.newName=w.replace(".zip",""),d.value=!0},te=()=>M(null,null,function*(){if(!C.newName.trim()){A("è¯·è¾“å…¥æ–°åç§°","error");return}m.rename=!0;const w=yield U(`/api/backup/rename/${C.oldName}`,{method:"PUT",body:JSON.stringify({newName:C.newName})});w.success?(A("é‡å‘½åæˆåŠŸï¼"),d.value=!1,yield K()):A(w.message||"é‡å‘½åå¤±è´¥","error"),m.rename=!1}),K=()=>M(null,null,function*(){m.list=!0;const w=yield U("/api/backup/list");w.success?i.value=w.backups:A("è·å–å¤‡ä»½åˆ—è¡¨å¤±è´¥","error"),m.list=!1}),R=w=>{window.open(`/api/backup/download/${w}?token=${B}`,"_blank")},_=(w,n)=>{const G=typeof n=="object"?n:{name:n},S=G.name;V.show=!0,V.filename=S,V.action=w,V.signed=G.signed,V.processing=!1,w==="delete"?(V.title="åˆ é™¤",V.message=`ç¡®å®šè¦åˆ é™¤å¤‡ä»½æ–‡ä»¶ ${S} å—ï¼Ÿ`,V.confirmClass="btn-danger"):w==="restore"?(V.title="æ¢å¤",G.signed?V.message=`ç¡®å®šè¦æ¢å¤å¤‡ä»½æ–‡ä»¶ ${S} å—ï¼Ÿ`:V.message=`âš ï¸ è­¦å‘Šï¼šæ­¤å¤‡ä»½æ–‡ä»¶æœªç­¾åï¼ˆå¯èƒ½æ˜¯å¤–éƒ¨ä¸Šä¼ çš„ï¼‰ï¼Œæ— æ³•éªŒè¯å…¶å®Œæ•´æ€§ã€‚

ç¡®å®šè¦æ¢å¤å¤‡ä»½æ–‡ä»¶ ${S} å—ï¼Ÿ`,V.confirmClass="btn-restore"):w==="webdav-restore"?(V.title="ä»WebDAVæ¢å¤",V.message=`ç¡®å®šè¦ä»WebDAVæ¢å¤å¤‡ä»½ ${S} å—ï¼Ÿè¿™å°†è¦†ç›–å½“å‰æ•°æ®ã€‚`,V.confirmClass="btn-restore"):w==="webdav-delete"&&(V.title="åˆ é™¤WebDAVå¤‡ä»½",V.message=`ç¡®å®šè¦åˆ é™¤WebDAVå¤‡ä»½ ${S} å—ï¼Ÿ`,V.confirmClass="btn-danger")},D=()=>M(null,null,function*(){const{action:w,filename:n,signed:G}=V;V.show=!1,V.processing=!1;try{if(w==="delete"){A("æ­£åœ¨åˆ é™¤å¤‡ä»½...");const S=yield U(`/api/backup/delete/${n}`,{method:"DELETE"});S.success?(A("âœ“ åˆ é™¤æˆåŠŸ"),yield K()):A("âœ— "+(S.message||"åˆ é™¤å¤±è´¥"),"error")}else if(w==="restore"){A("æ­£åœ¨æ¢å¤å¤‡ä»½ï¼Œè¯·ç¨å€™...");const S=G?{}:{forceRestore:!0},j=yield U(`/api/backup/restore/${n}`,{method:"POST",body:JSON.stringify(S)});if(j.success)A("âœ“ å¤‡ä»½å·²æ¢å¤ï¼Œæ­£åœ¨é‡æ–°åŠ è½½æ•°æ®..."),yield new Promise(ce=>setTimeout(ce,2e3)),yield Promise.all([K(),Q(),Z(),E()]),H(),j.checkAIConfig&&(yield X()),A("âœ“ æ¢å¤å®Œæˆï¼æ•°æ®å·²æ›´æ–°","success",5e3);else if(j.requireConfirm&&j.code==="NO_SIGNATURE"){if(confirm(j.message+`

ç‚¹å‡»"ç¡®å®š"ç»§ç»­æ¢å¤ï¼Œç‚¹å‡»"å–æ¶ˆ"æ”¾å¼ƒæ“ä½œã€‚`)){const ce=yield U(`/api/backup/restore/${n}`,{method:"POST",body:JSON.stringify({forceRestore:!0})});ce.success?(A("âœ“ å¤‡ä»½å·²æ¢å¤ï¼Œæ­£åœ¨é‡æ–°åŠ è½½æ•°æ®..."),yield new Promise(ze=>setTimeout(ze,2e3)),yield Promise.all([K(),Q(),Z(),E()]),H(),ce.checkAIConfig&&(yield X()),A("âœ“ æ¢å¤å®Œæˆï¼æ•°æ®å·²æ›´æ–°","success",5e3)):A("âœ— "+(ce.message||"æ¢å¤å¤±è´¥"),"error")}}else A("âœ— "+(j.message||"æ¢å¤å¤±è´¥"),"error")}else w==="webdav-restore"?yield fe(n):w==="webdav-delete"&&(yield be(n))}catch(S){A("âœ— æ“ä½œå¤±è´¥: "+S.message,"error")}}),P=w=>w?new Date(w).toLocaleString("zh-CN",{hour12:!1}):"--",f=()=>{c.value.click()},p=w=>M(null,null,function*(){const n=w.target.files[0];if(n){if(!n.name.endsWith(".zip")){A("åªæ”¯æŒ.zipæ ¼å¼çš„å¤‡ä»½æ–‡ä»¶","error"),w.target.value="";return}if(n.size>500*1024*1024){A("å¤‡ä»½æ–‡ä»¶è¿‡å¤§ï¼Œæœ€å¤§æ”¯æŒ500MB","error"),w.target.value="";return}m.upload=!0;try{const G=new FormData;G.append("backup",n);const j=yield(yield fetch("/api/backup/upload",{method:"POST",headers:{Authorization:`Bearer ${B}`},body:G})).json();j.success?(A("å¤‡ä»½æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼"),yield K()):A(j.message||"å¤‡ä»½æ–‡ä»¶ä¸Šä¼ å¤±è´¥","error")}catch(G){console.error("ä¸Šä¼ å¤±è´¥:",G),A("å¤‡ä»½æ–‡ä»¶ä¸Šä¼ å¤±è´¥","error")}finally{m.upload=!1,w.target.value=""}}}),Q=()=>M(null,null,function*(){const w=yield U("/api/backup/webdav/config");w.success&&w.config&&(b.configured=w.config.configured,b.url=w.config.url||"",b.username=w.config.username||"")}),pe=()=>M(null,null,function*(){yield Q(),g.url=b.url,g.username=b.username,g.password="",t.value=!0}),me=()=>M(null,null,function*(){if(!g.url||!g.username){A("è¯·å¡«å†™URLå’Œç”¨æˆ·å","error");return}if(!b.configured&&!g.password){A("é¦–æ¬¡é…ç½®æ—¶å¯†ç ä¸èƒ½ä¸ºç©º","error");return}m.webdavConfig=!0;const w=yield U("/api/backup/webdav/config",{method:"POST",body:JSON.stringify(g)});w.success?(t.value=!1,yield Q(),b.configured?(yield Z(),yield E(),h.webdav.enabled?A("WebDAVé…ç½®ä¿å­˜æˆåŠŸï¼"):(h.webdav.enabled=!0,(yield U("/api/backup/auto/config",{method:"POST",body:JSON.stringify(h)})).success?A("WebDAVé…ç½®ä¿å­˜æˆåŠŸï¼Œå·²è‡ªåŠ¨å¼€å¯WebDAVè‡ªåŠ¨åŒæ­¥ï¼"):A("WebDAVé…ç½®ä¿å­˜æˆåŠŸï¼Œä½†è‡ªåŠ¨åŒæ­¥å¼€å¯å¤±è´¥","error"))):A("WebDAVé…ç½®ä¿å­˜æˆåŠŸï¼")):A(w.message||"WebDAVé…ç½®ä¿å­˜å¤±è´¥","error"),m.webdavConfig=!1}),ge=()=>M(null,null,function*(){m.webdavBackup=!0;const w=yield U("/api/backup/webdav/backup",{method:"POST"});w.success?(A("å¤‡ä»½åˆ°WebDAVæˆåŠŸï¼"),yield Z()):(A(w.message||"å¤‡ä»½åˆ°WebDAVå¤±è´¥","error"),w.needReconfigure&&(b.configured=!1,b.url="",b.username="")),m.webdavBackup=!1}),he=w=>{w.target.checked&&!b.configured&&(h.webdav.enabled=!1,A('è¯·å…ˆåœ¨"WebDAVå¤‡ä»½"æ ‡ç­¾é¡µé…ç½®WebDAVè¿æ¥',"error"),s.value="webdav")},Z=()=>M(null,null,function*(){m.webdavList=!0;const w=yield U("/api/backup/webdav/list");w.success?(T.value=w.backups||[],w.configured===!1&&(b.configured=!1,b.url="",b.username="",w.message&&A(w.message,"error"))):A(w.message||"è·å–WebDAVå¤‡ä»½åˆ—è¡¨å¤±è´¥","error"),m.webdavList=!1}),fe=w=>M(null,null,function*(){A("æ­£åœ¨ä» WebDAV æ¢å¤å¤‡ä»½ï¼Œè¯·ç¨å€™..."),m.webdavRestore=!0;try{const n=yield U("/api/backup/webdav/restore",{method:"POST",body:JSON.stringify({filename:w})});n.success?(A("âœ“ å¤‡ä»½å·²æ¢å¤ï¼Œæ­£åœ¨é‡æ–°åŠ è½½æ•°æ®..."),yield new Promise(G=>setTimeout(G,2e3)),yield Promise.all([K(),Q(),Z(),E()]),H(),n.checkAIConfig&&(yield X()),A("âœ“ æ¢å¤å®Œæˆï¼æ•°æ®å·²æ›´æ–°","success",5e3)):(A("âœ— "+(n.message||"ä» WebDAV æ¢å¤å¤±è´¥"),"error"),n.needReconfigure&&(b.configured=!1,b.url="",b.username=""))}catch(n){A("âœ— æ¢å¤å¤±è´¥: "+n.message,"error")}finally{m.webdavRestore=!1}}),be=w=>M(null,null,function*(){A("æ­£åœ¨åˆ é™¤ WebDAV å¤‡ä»½..."),m.webdavDelete=!0;try{const n=yield U(`/api/backup/webdav/delete/${w}`,{method:"DELETE"});n.success?(A("âœ“ åˆ é™¤æˆåŠŸ"),yield Z()):(A("âœ— "+(n.message||"åˆ é™¤å¤±è´¥"),"error"),n.needReconfigure&&(b.configured=!1,b.url="",b.username=""))}catch(n){A("âœ— åˆ é™¤å¤±è´¥: "+n.message,"error")}finally{m.webdavDelete=!1}}),E=()=>M(null,null,function*(){const w=yield U("/api/backup/auto/config");w.success&&w.config?(Object.assign(h,w.config),v.value=w.stats||null):A("åŠ è½½è‡ªåŠ¨å¤‡ä»½é…ç½®å¤±è´¥","error")}),O=()=>M(null,null,function*(){m.autoBackupConfig=!0;const w=yield U("/api/backup/auto/config",{method:"POST",body:JSON.stringify(h)});w.success?(A("è‡ªåŠ¨å¤‡ä»½é…ç½®ä¿å­˜æˆåŠŸï¼"),yield E()):A(w.message||"è‡ªåŠ¨å¤‡ä»½é…ç½®ä¿å­˜å¤±è´¥","error"),m.autoBackupConfig=!1}),Re=()=>{if(!h.scheduled.enabled)return"æœªå¯ç”¨";const w=String(h.scheduled.hour).padStart(2,"0"),n=String(h.scheduled.minute).padStart(2,"0");return`æ¯å¤© ${w}:${n}`},We=()=>{confirm("ç¡®å®šè¦æ¢å¤ä¸ºé»˜è®¤é…ç½®å—ï¼Ÿè¿™å°†é‡ç½®æ‰€æœ‰è‡ªåŠ¨å¤‡ä»½è®¾ç½®ã€‚")&&(h.debounce={enabled:!0,delay:5,keep:5},h.scheduled={enabled:!0,hour:2,minute:0,keep:7,onlyIfModified:!0},h.webdav={enabled:!1,syncDaily:!0,syncIncremental:!0},h.autoClean=!0,A('å·²æ¢å¤é»˜è®¤é…ç½®ï¼Œè¯·ç‚¹å‡»"ä¿å­˜é…ç½®"ä»¥ç”Ÿæ•ˆ'))};return ae(()=>M(null,null,function*(){yield K(),yield Q(),b.configured&&(yield Z()),yield E()})),(w,n)=>{var G;return l(),a("div",Ca,[e("div",$a,[e("button",{class:z(["tab",{active:s.value==="local"}]),onClick:n[0]||(n[0]=S=>s.value="local")}," ğŸ“¦ æœ¬åœ°å¤‡ä»½ ",2),e("button",{class:z(["tab",{active:s.value==="webdav"}]),onClick:n[1]||(n[1]=S=>s.value="webdav")}," â˜ï¸ WebDAVå¤‡ä»½ ",2),e("button",{class:z(["tab",{active:s.value==="auto"}]),onClick:n[2]||(n[2]=S=>s.value="auto")}," âš™ï¸ è‡ªåŠ¨å¤‡ä»½é…ç½® ",2)]),$(e("div",Ma,[e("div",xa,[e("button",{class:"btn btn-primary",onClick:ee,disabled:m.create},[n[25]||(n[25]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"})],-1)),W(" "+u(m.create?"å¤‡ä»½ä¸­...":"åˆ›å»ºå¤‡ä»½"),1)],8,Sa),e("button",{class:"btn btn-success",onClick:f,disabled:m.upload},[n[26]||(n[26]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5-5 5 5M12 15V3"})],-1)),W(" "+u(m.upload?"ä¸Šä¼ ä¸­...":"ä¸Šä¼ å¤‡ä»½"),1)],8,Ta),e("button",{class:"btn btn-secondary",onClick:K,disabled:m.list},[n[27]||(n[27]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)),W(" "+u(m.list?"åˆ·æ–°ä¸­...":"åˆ·æ–°åˆ—è¡¨"),1)],8,Ua),e("input",{ref_key:"fileInput",ref:c,type:"file",accept:".zip",onChange:p,style:{display:"none"}},null,544)]),y.value.text?(l(),a("div",{key:0,class:z(["message",y.value.type])},u(y.value.text),3)):I("",!0),e("div",Va,[i.value.length===0&&!m.list?(l(),a("div",Aa,[...n[28]||(n[28]=[e("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"#ccc","stroke-width":"1.5"},[e("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e("circle",{cx:"12",cy:"7",r:"4"})],-1),e("p",null,"æš‚æ— å¤‡ä»½æ–‡ä»¶",-1)])])):(l(),a("div",Ia,[(l(!0),a(N,null,F(i.value,S=>(l(),a("div",{key:S.name,class:"backup-card"},[n[33]||(n[33]=e("div",{class:"backup-icon"},[e("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2"},[e("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e("polyline",{points:"14 2 14 8 20 8"})])],-1)),e("div",Ba,[e("div",Da,u(S.name),1),e("div",Pa,[e("span",Ea,u(S.size),1),e("span",La,u(P(S.created)),1),S.signed?(l(),a("span",Ra,"ğŸ”’")):(l(),a("span",Wa,"âš ï¸"))])]),e("div",za,[e("button",{class:"btn-icon btn-restore",onClick:j=>_("restore",S),title:"æ¢å¤å¤‡ä»½"},[...n[29]||(n[29]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)])],8,Ka),e("button",{class:"btn-icon btn-rename",onClick:j=>le(S.name),title:"é‡å‘½å"},[...n[30]||(n[30]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,Na),e("button",{class:"btn-icon",onClick:j=>R(S.name),title:"ä¸‹è½½å¤‡ä»½"},[...n[31]||(n[31]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"})],-1)])],8,Fa),e("button",{class:"btn-icon btn-danger",onClick:j=>_("delete",S.name),title:"åˆ é™¤å¤‡ä»½"},[...n[32]||(n[32]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"3 6 5 6 21 6"}),e("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})],-1)])],8,Oa)])]))),128))]))])],512),[[we,s.value==="local"]]),$(e("div",Ha,[e("div",Ga,[e("button",{class:"btn btn-primary",onClick:pe},[...n[34]||(n[34]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"3"}),e("path",{d:"M12 1v6m0 6v6M5.64 5.64l4.24 4.24m4.24 4.24l4.24 4.24M1 12h6m6 0h6M5.64 18.36l4.24-4.24m4.24-4.24l4.24-4.24"})],-1),W(" WebDAVé…ç½® ",-1)])]),e("button",{class:"btn btn-primary",onClick:ge,disabled:m.webdavBackup||!b.configured},[n[35]||(n[35]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"})],-1)),W(" "+u(m.webdavBackup?"å¤‡ä»½ä¸­...":"å¤‡ä»½åˆ°WebDAV"),1)],8,ja),e("button",{class:"btn btn-secondary",onClick:Z,disabled:m.webdavList||!b.configured},[n[36]||(n[36]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)),W(" "+u(m.webdavList?"åˆ·æ–°ä¸­...":"åˆ·æ–°åˆ—è¡¨"),1)],8,qa)]),y.value.text?(l(),a("div",{key:0,class:z(["message",y.value.type])},u(y.value.text),3)):I("",!0),b.configured?I("",!0):(l(),a("div",Ja,[...n[37]||(n[37]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),e("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})],-1),e("p",null,"è¯·å…ˆé…ç½®WebDAVè¿æ¥ä¿¡æ¯ï¼ˆæ”¯æŒï¼šåšæœäº‘ã€Nextcloudã€é˜¿é‡Œäº‘ç›˜WebDAVã€Dropboxç­‰ï¼‰",-1)])])),e("div",Qa,[T.value.length===0&&!m.webdavList?(l(),a("div",Xa,[...n[38]||(n[38]=[e("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"#ccc","stroke-width":"1.5"},[e("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e("circle",{cx:"12",cy:"7",r:"4"})],-1),e("p",null,"æš‚æ— WebDAVå¤‡ä»½",-1)])])):(l(),a("div",Ya,[(l(!0),a(N,null,F(T.value,S=>(l(),a("div",{key:S.name,class:"backup-card"},[n[41]||(n[41]=re('<div class="backup-icon" data-v-19fdb4a7><svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#16a34a" stroke-width="2" data-v-19fdb4a7><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" data-v-19fdb4a7></path><polyline points="14 2 14 8 20 8" data-v-19fdb4a7></polyline><path d="M12 18v-6M9 15l3 3 3-3" data-v-19fdb4a7></path></svg></div>',1)),e("div",Za,[e("div",eo,u(S.name),1),e("div",so,[e("span",to,u(S.size),1),e("span",no,u(P(S.created)),1)])]),e("div",lo,[e("button",{class:"btn-icon btn-restore",onClick:j=>_("webdav-restore",S.name),title:"ä»WebDAVæ¢å¤"},[...n[39]||(n[39]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)])],8,ao),e("button",{class:"btn-icon btn-danger",onClick:j=>_("webdav-delete",S.name),title:"åˆ é™¤WebDAVå¤‡ä»½"},[...n[40]||(n[40]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"3 6 5 6 21 6"}),e("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})],-1)])],8,oo)])]))),128))]))])],512),[[we,s.value==="webdav"]]),$(e("div",io,[y.value.text?(l(),a("div",{key:0,class:z(["message",y.value.type])},u(y.value.text),3)):I("",!0),e("div",ro,[n[76]||(n[76]=e("h3",null,"âš¡ è‡ªåŠ¨å¤‡ä»½é…ç½®",-1)),n[77]||(n[77]=e("p",{class:"config-description"},"é…ç½®ç³»ç»Ÿè‡ªåŠ¨å¤‡ä»½ç­–ç•¥ï¼ŒåŒ…æ‹¬å¢é‡å¤‡ä»½å’Œå®šæ—¶å¤‡ä»½ã€‚",-1)),e("div",uo,[e("div",co,[n[43]||(n[43]=e("h4",null,"å¢é‡å¤‡ä»½ï¼ˆé˜²æŠ–ï¼‰",-1)),e("label",vo,[$(e("input",{type:"checkbox","onUpdate:modelValue":n[3]||(n[3]=S=>h.debounce.enabled=S)},null,512),[[J,h.debounce.enabled]]),n[42]||(n[42]=e("span",{class:"slider"},null,-1))])]),n[48]||(n[48]=e("p",{class:"config-info"},"å½“æ•°æ®å˜æ›´æ—¶ï¼Œå»¶è¿Ÿä¸€æ®µæ—¶é—´åè‡ªåŠ¨å¤‡ä»½ã€‚é€‚åˆé¢‘ç¹ä¿®æ”¹çš„åœºæ™¯ã€‚",-1)),h.debounce.enabled?(l(),a("div",po,[e("div",mo,[n[44]||(n[44]=e("label",null,"å»¶è¿Ÿæ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰",-1)),$(e("input",{type:"number","onUpdate:modelValue":n[4]||(n[4]=S=>h.debounce.delay=S),min:"5",max:"1440",class:"form-input"},null,512),[[L,h.debounce.delay,void 0,{number:!0}]]),n[45]||(n[45]=e("small",null,"æ•°æ®ä¿®æ”¹åå»¶è¿Ÿå¤šä¹…è§¦å‘å¤‡ä»½ï¼ŒèŒƒå›´ï¼š5-1440åˆ†é’Ÿ",-1))]),e("div",go,[n[46]||(n[46]=e("label",null,"ä¿ç•™å¤‡ä»½æ•°é‡",-1)),$(e("input",{type:"number","onUpdate:modelValue":n[5]||(n[5]=S=>h.debounce.keep=S),min:"1",max:"30",class:"form-input"},null,512),[[L,h.debounce.keep,void 0,{number:!0}]]),n[47]||(n[47]=e("small",null,"è‡ªåŠ¨æ¸…ç†æ—¶ä¿ç•™æœ€æ–°çš„Nä¸ªå¤‡ä»½ï¼ŒèŒƒå›´ï¼š1-30ä¸ª",-1))])])):I("",!0)]),e("div",ho,[e("div",fo,[n[50]||(n[50]=e("h4",null,"å®šæ—¶å¤‡ä»½ï¼ˆæ¯æ—¥ï¼‰",-1)),e("label",bo,[$(e("input",{type:"checkbox","onUpdate:modelValue":n[6]||(n[6]=S=>h.scheduled.enabled=S)},null,512),[[J,h.scheduled.enabled]]),n[49]||(n[49]=e("span",{class:"slider"},null,-1))])]),n[58]||(n[58]=e("p",{class:"config-info"},"æ¯å¤©åœ¨å›ºå®šæ—¶é—´è‡ªåŠ¨æ‰§è¡Œå¤‡ä»½ã€‚",-1)),h.scheduled.enabled?(l(),a("div",yo,[e("div",ko,[n[52]||(n[52]=e("label",null,"å¤‡ä»½æ—¶é—´",-1)),e("div",wo,[$(e("input",{type:"number","onUpdate:modelValue":n[7]||(n[7]=S=>h.scheduled.hour=S),min:"0",max:"23",class:"form-input time-field",placeholder:"æ—¶"},null,512),[[L,h.scheduled.hour,void 0,{number:!0}]]),n[51]||(n[51]=e("span",null,":",-1)),$(e("input",{type:"number","onUpdate:modelValue":n[8]||(n[8]=S=>h.scheduled.minute=S),min:"0",max:"59",class:"form-input time-field",placeholder:"åˆ†"},null,512),[[L,h.scheduled.minute,void 0,{number:!0}]])]),n[53]||(n[53]=e("small",null,"æ ¼å¼ï¼š24å°æ—¶åˆ¶ï¼Œå¦‚ 02:00",-1))]),e("div",_o,[n[54]||(n[54]=e("label",null,"ä¿ç•™å¤‡ä»½æ•°é‡",-1)),$(e("input",{type:"number","onUpdate:modelValue":n[9]||(n[9]=S=>h.scheduled.keep=S),min:"1",max:"30",class:"form-input"},null,512),[[L,h.scheduled.keep,void 0,{number:!0}]]),n[55]||(n[55]=e("small",null,"è‡ªåŠ¨æ¸…ç†æ—¶ä¿ç•™æœ€æ–°çš„Nä¸ªå¤‡ä»½ï¼ŒèŒƒå›´ï¼š1-30ä¸ª",-1))]),e("div",Co,[e("label",$o,[$(e("input",{type:"checkbox","onUpdate:modelValue":n[10]||(n[10]=S=>h.scheduled.onlyIfModified=S)},null,512),[[J,h.scheduled.onlyIfModified]]),n[56]||(n[56]=e("span",null,"ä»…åœ¨æœ‰ä¿®æ”¹æ—¶å¤‡ä»½",-1))]),n[57]||(n[57]=e("small",null,"å¦‚æœ24å°æ—¶å†…å·²æœ‰å¢é‡å¤‡ä»½ï¼Œè·³è¿‡å®šæ—¶å¤‡ä»½ï¼ˆé¿å…é‡å¤ï¼‰",-1))])])):I("",!0)]),e("div",Mo,[e("div",xo,[n[60]||(n[60]=e("h4",null,"â˜ï¸ WebDAV è‡ªåŠ¨åŒæ­¥",-1)),e("label",So,[$(e("input",{type:"checkbox","onUpdate:modelValue":n[11]||(n[11]=S=>h.webdav.enabled=S),onChange:he},null,544),[[J,h.webdav.enabled]]),n[59]||(n[59]=e("span",{class:"slider"},null,-1))])]),e("p",To,[n[61]||(n[61]=W(" è‡ªåŠ¨å°†æœ¬åœ°å¤‡ä»½åŒæ­¥åˆ° WebDAV äº‘ç«¯ã€‚ ",-1)),b.configured?I("",!0):(l(),a("span",Uo,'âš ï¸ è¯·å…ˆåœ¨"WebDAVå¤‡ä»½"æ ‡ç­¾é¡µé…ç½®è¿æ¥'))]),h.webdav.enabled?(l(),a("div",Vo,[e("div",Ao,[e("label",Io,[$(e("input",{type:"checkbox","onUpdate:modelValue":n[12]||(n[12]=S=>h.webdav.syncDaily=S)},null,512),[[J,h.webdav.syncDaily]]),n[62]||(n[62]=e("span",null,"åŒæ­¥æ¯æ—¥å®šæ—¶å¤‡ä»½",-1))]),n[63]||(n[63]=e("small",null,"æ¯å¤©å®šæ—¶å¤‡ä»½åè‡ªåŠ¨ä¸Šä¼ åˆ° WebDAV",-1))]),e("div",Bo,[e("label",Do,[$(e("input",{type:"checkbox","onUpdate:modelValue":n[13]||(n[13]=S=>h.webdav.syncIncremental=S)},null,512),[[J,h.webdav.syncIncremental]]),n[64]||(n[64]=e("span",null,"åŒæ­¥å¢é‡å¤‡ä»½",-1))]),n[65]||(n[65]=e("small",null,"å¢é‡å¤‡ä»½åè‡ªåŠ¨ä¸Šä¼ åˆ° WebDAV",-1))])])):I("",!0)]),e("div",Po,[e("div",Eo,[n[67]||(n[67]=e("h4",null,"è‡ªåŠ¨æ¸…ç†",-1)),e("label",Lo,[$(e("input",{type:"checkbox","onUpdate:modelValue":n[14]||(n[14]=S=>h.autoClean=S)},null,512),[[J,h.autoClean]]),n[66]||(n[66]=e("span",{class:"slider"},null,-1))])]),n[68]||(n[68]=e("p",{class:"config-info"},"è‡ªåŠ¨åˆ é™¤è¶…å‡ºä¿ç•™æ•°é‡çš„æ—§å¤‡ä»½æ–‡ä»¶ï¼ˆæŒ‰æ—¶é—´æ’åºï¼Œä¿ç•™æœ€æ–°çš„ï¼‰ã€‚",-1))]),v.value?(l(),a("div",Ro,[n[73]||(n[73]=e("h4",null,"ğŸ“Š å¤‡ä»½ç»Ÿè®¡",-1)),e("div",Wo,[e("div",zo,[n[69]||(n[69]=e("span",{class:"stat-label"},"å¢é‡å¤‡ä»½æ•°é‡",-1)),e("span",Ko,u(((G=v.value.incremental)==null?void 0:G.count)||0)+" ä¸ª",1)]),e("div",No,[n[70]||(n[70]=e("span",{class:"stat-label"},"æœ€åå¢é‡å¤‡ä»½",-1)),e("span",Fo,u(P(v.value.lastDebounce)||"æ— "),1)]),e("div",Oo,[n[71]||(n[71]=e("span",{class:"stat-label"},"æœ€åå®šæ—¶å¤‡ä»½",-1)),e("span",Ho,u(P(v.value.lastScheduled)||"æ— "),1)]),e("div",Go,[n[72]||(n[72]=e("span",{class:"stat-label"},"ä¸‹æ¬¡å®šæ—¶å¤‡ä»½",-1)),e("span",jo,u(Re()),1)])])])):I("",!0),e("div",qo,[e("button",{class:"btn btn-secondary",onClick:We},[...n[74]||(n[74]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1),W(" æ¢å¤é»˜è®¤ ",-1)])]),e("button",{class:"btn btn-primary",onClick:O,disabled:m.autoBackupConfig},[n[75]||(n[75]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),e("polyline",{points:"17 21 17 13 7 13 7 21"}),e("polyline",{points:"7 3 7 8 15 8"})],-1)),W(" "+u(m.autoBackupConfig?"ä¿å­˜ä¸­...":"ä¿å­˜é…ç½®"),1)],8,Jo)])])],512),[[we,s.value==="auto"]]),t.value?(l(),a("div",Qo,[e("div",Xo,[n[82]||(n[82]=e("h3",null,"WebDAVé…ç½®",-1)),e("div",Yo,[n[78]||(n[78]=e("label",null,[W("WebDAV URL "),e("span",{class:"required"},"*")],-1)),$(e("input",{type:"text","onUpdate:modelValue":n[15]||(n[15]=S=>g.url=S),placeholder:"https://dav.jianguoyun.com/dav/",class:"form-input"},null,512),[[L,g.url]]),n[79]||(n[79]=e("small",null,"ä¾‹ï¼šåšæœäº‘ https://dav.jianguoyun.com/dav/",-1))]),e("div",Zo,[n[80]||(n[80]=e("label",null,[W("ç”¨æˆ·å "),e("span",{class:"required"},"*")],-1)),$(e("input",{type:"text","onUpdate:modelValue":n[16]||(n[16]=S=>g.username=S),placeholder:"é‚®ç®±æˆ–ç”¨æˆ·å",class:"form-input"},null,512),[[L,g.username]])]),e("div",ei,[n[81]||(n[81]=e("label",null,[W("å¯†ç  "),e("span",{class:"required"},"*")],-1)),$(e("input",{type:"password","onUpdate:modelValue":n[17]||(n[17]=S=>g.password=S),placeholder:b.configured?"ç•™ç©ºåˆ™ä¿æŒåŸå¯†ç ä¸å˜":"åº”ç”¨å¯†ç æˆ–è®¿é—®ä»¤ç‰Œ",class:"form-input"},null,8,si),[[L,g.password]]),b.configured?(l(),a("small",ni,"å¦‚éœ€ä¿®æ”¹å¯†ç è¯·è¾“å…¥æ–°å¯†ç ï¼Œç•™ç©ºåˆ™ä¿æŒåŸå¯†ç ä¸å˜")):(l(),a("small",ti,"æ³¨æ„ï¼šæŸäº›æœåŠ¡éœ€è¦ä½¿ç”¨åº”ç”¨ä¸“ç”¨å¯†ç ï¼Œè€Œä¸æ˜¯ç™»å½•å¯†ç "))]),e("div",li,[e("button",{class:"btn btn-secondary",onClick:n[18]||(n[18]=S=>t.value=!1)},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:me,disabled:m.webdavConfig},u(m.webdavConfig?"æµ‹è¯•è¿æ¥ä¸­...":"ä¿å­˜"),9,ai)])])])):I("",!0),V.show?(l(),a("div",oi,[e("div",ii,[e("h3",null,"ç¡®è®¤"+u(V.title),1),e("p",ri,u(V.message),1),e("div",di,[e("button",{class:"btn btn-secondary",onClick:n[19]||(n[19]=S=>V.show=!1),disabled:V.processing},"å–æ¶ˆ",8,ui),e("button",{class:z(["btn",V.confirmClass]),onClick:D,disabled:V.processing},u(V.processing?"å¤„ç†ä¸­...":"ç¡®è®¤"),11,ci)])])])):I("",!0),r.value?(l(),a("div",vi,[e("div",pi,[n[86]||(n[86]=e("h3",null,"åˆ›å»ºå¤‡ä»½",-1)),e("div",mi,[n[83]||(n[83]=e("label",null,"å¤‡ä»½åç§°ï¼ˆå¯é€‰ï¼‰",-1)),$(e("input",{type:"text","onUpdate:modelValue":n[20]||(n[20]=S=>k.name=S),placeholder:"ä¾‹å¦‚ï¼šæ·»åŠ ä¹¦ç­¾åçš„å¤‡ä»½",class:"form-input",maxlength:"50"},null,512),[[L,k.name]]),n[84]||(n[84]=e("small",null,"ç•™ç©ºåˆ™ä½¿ç”¨é»˜è®¤åç§°ï¼ˆbackup-æ—¶é—´æˆ³ï¼‰",-1))]),e("div",gi,[n[85]||(n[85]=e("label",null,"å¤‡ä»½æè¿°ï¼ˆå¯é€‰ï¼‰",-1)),$(e("textarea",{"onUpdate:modelValue":n[21]||(n[21]=S=>k.description=S),placeholder:"æè¿°è¿™æ¬¡å¤‡ä»½çš„å†…å®¹æˆ–ç›®çš„...",class:"form-input",rows:"3"},null,512),[[L,k.description]])]),e("div",hi,[e("button",{class:"btn btn-secondary",onClick:n[22]||(n[22]=S=>r.value=!1)},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:se,disabled:m.create},u(m.create?"å¤‡ä»½ä¸­...":"åˆ›å»ºå¤‡ä»½"),9,fi)])])])):I("",!0),d.value?(l(),a("div",bi,[e("div",yi,[n[88]||(n[88]=e("h3",null,"é‡å‘½åå¤‡ä»½",-1)),e("div",ki,[n[87]||(n[87]=e("label",null,[W("æ–°åç§° "),e("span",{class:"required"},"*")],-1)),$(e("input",{type:"text","onUpdate:modelValue":n[23]||(n[23]=S=>C.newName=S),placeholder:"è¾“å…¥æ–°çš„å¤‡ä»½åç§°",class:"form-input",maxlength:"50"},null,512),[[L,C.newName]]),e("small",null,"åŸåç§°ï¼š"+u(C.oldName),1)]),e("div",wi,[e("button",{class:"btn btn-secondary",onClick:n[24]||(n[24]=S=>d.value=!1)},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:te,disabled:m.rename||!C.newName.trim()},u(m.rename?"é‡å‘½åä¸­...":"ç¡®è®¤é‡å‘½å"),9,_i)])])])):I("",!0)])}}},$i=Y(Ci,[["__scopeId","data-v-19fdb4a7"]]),Mi={name:"AIBatchWizard",props:{visible:Boolean,activeTask:{type:Object,default:()=>({running:!1})}},emits:["close","start"],data(){return{step:0,stepNames:["é€‰æ‹©èŒƒå›´","ç”Ÿæˆç­–ç•¥","æ•ˆæœé¢„è§ˆ","æ‰§è¡Œä»»åŠ¡"],fieldLabels:{name:"åç§°",description:"æè¿°",tags:"æ ‡ç­¾"},menus:[],subMenus:[],tags:[],filters:{status:["empty_name","empty_desc"],menuId:"",subMenuId:""},filteredCards:[],filtering:!1,strategy:{types:["name","description"],mode:"fill",style:"default",customPrompt:""},previews:[],previewing:!1,taskDone:!1,localTaskStatus:{current:0,total:0,successCount:0,failCount:0,currentCard:"",errors:[]},pendingRetryErrors:[],pendingSuccessCount:0,isRetrying:!1,starting:!1,stopping:!1,eventSource:null}},computed:{canNext(){return this.step===0?this.filteredCards.length>0:this.step===1?this.strategy.types.length>0:!0},taskStatus(){const o=this.activeTask.running?this.activeTask:this.localTaskStatus;if(this.isRetrying){const s=o.errors||[];if(this.pendingRetryErrors.length>0){const i=new Set(s.map(t=>t.cardId)),T=[...s,...this.pendingRetryErrors.filter(t=>!i.has(t.cardId))];return ne(q({},o),{errors:T,failCount:T.length,successCount:this.pendingSuccessCount+(o.successCount||0)})}else return ne(q({},o),{successCount:this.pendingSuccessCount+(o.successCount||0)})}return o},taskRunning(){return this.activeTask.running},progressPercent(){const o=this.taskStatus;return o.total?Math.round(o.current/o.total*100):0},displayErrors(){return this.taskStatus.errors||[]},hasRealErrors(){return this.displayErrors.some(o=>!o.isWarning)},hasErrorsOrWarnings(){return this.displayErrors.length>0}},watch:{visible(o){o&&this.init()},"activeTask.running"(o,s){o===!0&&(this.taskDone=!1),s===!0&&o===!1&&this.step===3&&(this.taskDone=!0,this.isRetrying=!1,this.pendingRetryErrors=[],this.pendingSuccessCount=0,this.applyFilter())},activeTask:{handler(o){o&&(this.localTaskStatus=q({},o))},deep:!0}},methods:{init(){return M(this,null,function*(){this.step=0,this.previews=[],this.taskDone=!1,this.localTaskStatus={current:0,total:0,successCount:0,failCount:0,currentCard:"",errors:[]},this.pendingRetryErrors=[],this.pendingSuccessCount=0,this.isRetrying=!1;try{const[o,s]=yield Promise.all([xe(),Se()]);this.menus=o.data||[],this.tags=s.data||[]}catch(o){}this.applyFilter()})},onMenuChange(){return M(this,null,function*(){this.filters.subMenuId="";const o=this.menus.find(s=>s.id===this.filters.menuId);this.subMenus=(o==null?void 0:o.subMenus)||[],this.applyFilter()})},applyFilter(){return M(this,null,function*(){this.filtering=!0;try{const o={status:this.filters.status};this.filters.menuId&&(o.menuIds=[this.filters.menuId]),this.filters.subMenuId&&(o.subMenuIds=[this.filters.subMenuId]);const{data:s}=yield ws(o);this.filteredCards=s.cards||[]}catch(o){this.filteredCards=[]}this.filtering=!1})},nextStep(){this.step<3&&this.step++},runPreview(){return M(this,null,function*(){var o,s;this.previewing=!0,this.previews=[];try{const i=this.filteredCards.slice(0,3).map(t=>t.id),{data:T}=yield ks({cardIds:i,types:this.strategy.types,strategy:{mode:this.strategy.mode,style:this.strategy.style,customPrompt:this.strategy.customPrompt}});this.previews=T.previews||[]}catch(i){alert("é¢„è§ˆå¤±è´¥: "+(((s=(o=i.response)==null?void 0:o.data)==null?void 0:s.message)||i.message))}this.previewing=!1})},startTask(){return M(this,null,function*(){this.pendingRetryErrors=[],this.pendingSuccessCount=0,this.isRetrying=!1,yield this.doStartTask(this.filteredCards.map(o=>o.id))})},retryCard(o){return M(this,null,function*(){if(!o.cardId){alert("æ— æ³•é‡è¯•ï¼šè¯¥é”™è¯¯æ²¡æœ‰å…³è”çš„å¡ç‰‡ ID");return}const s=o.cardId;this.pendingRetryErrors=(this.taskStatus.errors||[]).filter(i=>i.cardId!==s),this.pendingSuccessCount=this.taskStatus.successCount||0,this.isRetrying=!0,yield this.doStartTask([s])})},retryAllFailed(){return M(this,null,function*(){const o=(this.taskStatus.errors||[]).filter(i=>!i.isWarning);if(o.length===0){alert("æ²¡æœ‰éœ€è¦é‡è¯•çš„å¤±è´¥å¡ç‰‡");return}const s=o.map(i=>i.cardId).filter(i=>!!i&&i!==0);if(s.length===0){alert("æ²¡æœ‰å¯é‡è¯•çš„å¡ç‰‡ï¼ˆéƒ¨åˆ†ç³»ç»Ÿé”™è¯¯æ— æ³•ç›´æ¥é‡è¯•ï¼‰");return}this.pendingSuccessCount=this.taskStatus.successCount||0,this.pendingRetryErrors=[],this.isRetrying=!0,yield this.doStartTask(s)})},doStartTask(o){return M(this,null,function*(){var i,T;this.starting=!0,this.taskDone=!1,this.localTaskStatus.errors=[];const s={cardIds:o,types:this.strategy.types,strategy:{mode:this.strategy.mode,style:this.strategy.style,customPrompt:this.strategy.customPrompt}};try{const{data:t}=yield Me(s);if(!t.success||t.total===0){alert(t.message||"æ²¡æœ‰éœ€è¦å¤„ç†çš„å¡ç‰‡"),this.starting=!1;return}this.$emit("start",{total:t.total||s.cardIds.length,types:s.types,mode:s.strategy.mode,current:0,successCount:0,failCount:0,currentCard:"ä»»åŠ¡å·²å¯åŠ¨...",errors:[]})}catch(t){alert("å¯åŠ¨å¤±è´¥: "+(((T=(i=t.response)==null?void 0:i.data)==null?void 0:T.message)||t.message))}this.starting=!1})},stopTask(){return M(this,null,function*(){this.stopping=!0;try{yield Le()}catch(o){}setTimeout(()=>{this.stopping=!1},2e3)})},extractDomain(o){try{return new URL(o).hostname.replace("www.","")}catch(s){return o}},formatFieldValue(o,s){return!o||Array.isArray(o)&&o.length===0?"(ç©º)":s==="tags"&&Array.isArray(o)?o.join("ã€"):o},formatTime(o){if(!o)return"";const s=new Date(o);return`${s.getHours().toString().padStart(2,"0")}:${s.getMinutes().toString().padStart(2,"0")}:${s.getSeconds().toString().padStart(2,"0")}`}}},xi={class:"wizard-modal"},Si={class:"wizard-header"},Ti={class:"steps"},Ui={class:"step-num"},Vi={class:"step-name"},Ai={class:"wizard-body"},Ii={key:0,class:"step-content"},Bi={class:"filter-section"},Di={class:"checkbox-group"},Pi={class:"filter-section"},Ei=["value"],Li=["value"],Ri={class:"filter-result"},Wi={class:"result-count"},zi=["disabled"],Ki={key:0,class:"card-preview-list"},Ni={class:"card-title"},Fi={class:"card-url"},Oi={key:0,class:"more-hint"},Hi={key:1,class:"step-content"},Gi={class:"filter-section"},ji={class:"checkbox-group"},qi={class:"filter-section"},Ji={class:"radio-group"},Qi={class:"filter-section"},Xi={class:"filter-section"},Yi={key:2,class:"step-content"},Zi={class:"preview-actions"},er=["disabled"],sr={key:0,class:"preview-list"},tr={class:"preview-title"},nr={class:"field-label"},lr={class:"diff-view"},ar={class:"diff-old"},or={key:1,class:"preview-hint"},ir={key:3,class:"step-content"},rr={key:0,class:"execute-confirm"},dr=["disabled"],ur={key:1,class:"task-progress"},cr={class:"progress-header"},vr={class:"progress-bar"},pr={class:"progress-info"},mr={key:0},gr={key:1},hr={class:"task-stats"},fr={class:"stat success"},br={class:"stat fail"},yr=["disabled"],kr={class:"error-log-header"},wr={key:0,class:"header-hint"},_r={key:0,class:"error-log"},Cr={class:"error-info"},$r={class:"error-row"},Mr=["title"],xr={key:0,class:"warning-icon"},Sr={class:"error-time"},Tr=["title"],Ur=["onClick","disabled"],Vr={key:1,class:"error-empty-hint"},Ar={key:1,class:"task-actions"},Ir=["disabled"],Br={class:"wizard-footer"},Dr=["disabled"],Pr={class:"footer-right"},Er=["disabled"];function Lr(o,s,i,T,t,r){return i.visible?(l(),a("div",{key:0,class:"wizard-overlay",onClick:s[27]||(s[27]=ue(d=>o.$emit("close"),["self"]))},[e("div",xi,[e("div",Si,[s[28]||(s[28]=e("h3",null,"ğŸ¤– AI æ‰¹é‡ç”Ÿæˆå‘å¯¼",-1)),e("button",{class:"close-btn",onClick:s[0]||(s[0]=d=>o.$emit("close"))},"âœ•")]),e("div",Ti,[(l(!0),a(N,null,F(t.stepNames,(d,c)=>(l(),a("div",{key:c,class:z(["step",{active:t.step===c,done:t.step>c}])},[e("span",Ui,u(t.step>c?"âœ“":c+1),1),e("span",Vi,u(d),1)],2))),128))]),e("div",Ai,[t.step===0?(l(),a("div",Ii,[e("div",Bi,[s[32]||(s[32]=e("h4",null,"çŠ¶æ€ç­›é€‰",-1)),e("div",Di,[e("label",null,[$(e("input",{type:"checkbox","onUpdate:modelValue":s[1]||(s[1]=d=>t.filters.status=d),value:"empty_name",onChange:s[2]||(s[2]=(...d)=>r.applyFilter&&r.applyFilter(...d))},null,544),[[J,t.filters.status]]),s[29]||(s[29]=W(" ç¼ºåç§°",-1))]),e("label",null,[$(e("input",{type:"checkbox","onUpdate:modelValue":s[3]||(s[3]=d=>t.filters.status=d),value:"empty_desc",onChange:s[4]||(s[4]=(...d)=>r.applyFilter&&r.applyFilter(...d))},null,544),[[J,t.filters.status]]),s[30]||(s[30]=W(" ç¼ºæè¿°",-1))]),e("label",null,[$(e("input",{type:"checkbox","onUpdate:modelValue":s[5]||(s[5]=d=>t.filters.status=d),value:"empty_tags",onChange:s[6]||(s[6]=(...d)=>r.applyFilter&&r.applyFilter(...d))},null,544),[[J,t.filters.status]]),s[31]||(s[31]=W(" ç¼ºæ ‡ç­¾",-1))])])]),e("div",Pi,[s[35]||(s[35]=e("h4",null,"èœå•ç­›é€‰",-1)),$(e("select",{"onUpdate:modelValue":s[7]||(s[7]=d=>t.filters.menuId=d),onChange:s[8]||(s[8]=(...d)=>r.onMenuChange&&r.onMenuChange(...d)),class:"input"},[s[33]||(s[33]=e("option",{value:""},"å…¨éƒ¨èœå•",-1)),(l(!0),a(N,null,F(t.menus,d=>(l(),a("option",{key:d.id,value:d.id},u(d.name),9,Ei))),128))],544),[[ie,t.filters.menuId]]),t.subMenus.length?$((l(),a("select",{key:0,"onUpdate:modelValue":s[9]||(s[9]=d=>t.filters.subMenuId=d),onChange:s[10]||(s[10]=(...d)=>r.applyFilter&&r.applyFilter(...d)),class:"input",style:{"margin-top":"8px"}},[s[34]||(s[34]=e("option",{value:""},"å…¨éƒ¨å­èœå•",-1)),(l(!0),a(N,null,F(t.subMenus,d=>(l(),a("option",{key:d.id,value:d.id},u(d.name),9,Li))),128))],544)),[[ie,t.filters.subMenuId]]):I("",!0)]),e("div",Ri,[e("span",Wi,[s[36]||(s[36]=W("å·²é€‰ä¸­ ",-1)),e("strong",null,u(t.filteredCards.length),1),s[37]||(s[37]=W(" ä¸ªå¡ç‰‡",-1))]),e("button",{class:"btn sm",onClick:s[11]||(s[11]=(...d)=>r.applyFilter&&r.applyFilter(...d)),disabled:t.filtering},u(t.filtering?"ç­›é€‰ä¸­...":"ğŸ”„ åˆ·æ–°"),9,zi)]),t.filteredCards.length?(l(),a("div",Ki,[(l(!0),a(N,null,F(t.filteredCards.slice(0,10),d=>(l(),a("div",{key:d.id,class:"card-preview-item"},[e("span",Ni,u(d.title||r.extractDomain(d.url)),1),e("span",Fi,u(d.url),1)]))),128)),t.filteredCards.length>10?(l(),a("div",Oi,"è¿˜æœ‰ "+u(t.filteredCards.length-10)+" ä¸ª...",1)):I("",!0)])):I("",!0)])):I("",!0),t.step===1?(l(),a("div",Hi,[e("div",Gi,[s[41]||(s[41]=e("h4",null,"ç”Ÿæˆå­—æ®µ",-1)),e("div",ji,[e("label",null,[$(e("input",{type:"checkbox","onUpdate:modelValue":s[12]||(s[12]=d=>t.strategy.types=d),value:"name"},null,512),[[J,t.strategy.types]]),s[38]||(s[38]=W(" åç§°",-1))]),e("label",null,[$(e("input",{type:"checkbox","onUpdate:modelValue":s[13]||(s[13]=d=>t.strategy.types=d),value:"description"},null,512),[[J,t.strategy.types]]),s[39]||(s[39]=W(" æè¿°",-1))]),e("label",null,[$(e("input",{type:"checkbox","onUpdate:modelValue":s[14]||(s[14]=d=>t.strategy.types=d),value:"tags"},null,512),[[J,t.strategy.types]]),s[40]||(s[40]=W(" æ ‡ç­¾",-1))])])]),e("div",qi,[s[44]||(s[44]=e("h4",null,"ç”Ÿæˆæ¨¡å¼",-1)),e("div",Ji,[e("label",null,[$(e("input",{type:"radio","onUpdate:modelValue":s[15]||(s[15]=d=>t.strategy.mode=d),value:"fill"},null,512),[[Ae,t.strategy.mode]]),s[42]||(s[42]=W(" è¡¥å…¨æ¨¡å¼ï¼ˆä»…å¡«å……ç©ºå­—æ®µï¼‰",-1))]),e("label",null,[$(e("input",{type:"radio","onUpdate:modelValue":s[16]||(s[16]=d=>t.strategy.mode=d),value:"overwrite"},null,512),[[Ae,t.strategy.mode]]),s[43]||(s[43]=W(" è¦†ç›–æ¨¡å¼ï¼ˆé‡æ–°ç”Ÿæˆæ‰€æœ‰ï¼‰",-1))])])]),e("div",Qi,[s[46]||(s[46]=e("h4",null,"ç”Ÿæˆé£æ ¼",-1)),$(e("select",{"onUpdate:modelValue":s[17]||(s[17]=d=>t.strategy.style=d),class:"input"},[...s[45]||(s[45]=[re('<option value="default" data-v-5b66643c>é»˜è®¤</option><option value="concise" data-v-5b66643c>ç®€æ´æœ‰åŠ›</option><option value="professional" data-v-5b66643c>ä¸“ä¸šæ­£å¼</option><option value="friendly" data-v-5b66643c>å‹å¥½è½»æ¾</option><option value="seo" data-v-5b66643c>SEO ä¼˜åŒ–</option>',5)])],512),[[ie,t.strategy.style]])]),e("div",Xi,[s[47]||(s[47]=e("h4",null,"è‡ªå®šä¹‰æç¤ºï¼ˆå¯é€‰ï¼‰",-1)),$(e("textarea",{"onUpdate:modelValue":s[18]||(s[18]=d=>t.strategy.customPrompt=d),class:"input",rows:"2",placeholder:"ä¾‹å¦‚ï¼šè¯·ä½¿ç”¨ä¸­æ–‡ï¼Œæè¿°æ§åˆ¶åœ¨30å­—ä»¥å†…"},null,512),[[L,t.strategy.customPrompt]])])])):I("",!0),t.step===2?(l(),a("div",Yi,[e("div",Zi,[e("button",{class:"btn primary",onClick:s[19]||(s[19]=(...d)=>r.runPreview&&r.runPreview(...d)),disabled:t.previewing},u(t.previewing?"â³ ç”Ÿæˆé¢„è§ˆä¸­...":"ğŸ”® è¯•è¿è¡Œï¼ˆéšæœº3ä¸ªï¼‰"),9,er)]),t.previews.length?(l(),a("div",sr,[(l(!0),a(N,null,F(t.previews,d=>(l(),a("div",{key:d.cardId,class:"preview-card"},[e("div",tr,u(d.title||r.extractDomain(d.url)),1),(l(!0),a(N,null,F(d.fields,(c,m)=>(l(),a("div",{key:m,class:"preview-field"},[e("span",nr,u(t.fieldLabels[m]),1),e("div",lr,[e("div",ar,u(r.formatFieldValue(c.original,m)),1),s[48]||(s[48]=e("div",{class:"diff-arrow"},"â†’",-1)),e("div",{class:z(["diff-new",{error:c.error}])},u(c.error||r.formatFieldValue(c.generated,m)),3)])]))),128))]))),128))])):t.previewing?I("",!0):(l(),a("div",or,' ç‚¹å‡»"è¯•è¿è¡Œ"é¢„è§ˆ AI ç”Ÿæˆæ•ˆæœï¼Œä¸æ»¡æ„å¯è¿”å›è°ƒæ•´ç­–ç•¥ '))])):I("",!0),t.step===3?(l(),a("div",ir,[!r.taskRunning&&!t.taskDone?(l(),a("div",rr,[e("p",null,[s[49]||(s[49]=W("å³å°†å¤„ç† ",-1)),e("strong",null,u(t.filteredCards.length),1),s[50]||(s[50]=W(" ä¸ªå¡ç‰‡",-1))]),e("p",null,"ç”Ÿæˆå­—æ®µï¼š"+u(t.strategy.types.map(d=>t.fieldLabels[d]).join("ã€")),1),e("p",null,"ç”Ÿæˆæ¨¡å¼ï¼š"+u(t.strategy.mode==="fill"?"è¡¥å…¨æ¨¡å¼":"è¦†ç›–æ¨¡å¼"),1),e("button",{class:"btn primary lg",onClick:s[20]||(s[20]=(...d)=>r.startTask&&r.startTask(...d)),disabled:t.starting},u(t.starting?"å¯åŠ¨ä¸­...":"ğŸš€ å¼€å§‹æ‰§è¡Œ"),9,dr)])):I("",!0),r.taskRunning||t.taskDone?(l(),a("div",ur,[e("div",cr,[e("span",null,u(t.taskDone?"âœ… ä»»åŠ¡å®Œæˆ":"â³ æ­£åœ¨å¤„ç†..."),1),e("span",null,u(r.taskStatus.current)+" / "+u(r.taskStatus.total),1)]),e("div",vr,[e("div",{class:"progress-fill",style:ve({width:r.progressPercent+"%"})},null,4)]),e("div",pr,[r.taskStatus.currentCard?(l(),a("span",mr,"å½“å‰ï¼š"+u(r.taskStatus.currentCard),1)):I("",!0),r.taskStatus.eta?(l(),a("span",gr,"é¢„è®¡å‰©ä½™ï¼š"+u(r.taskStatus.eta),1)):I("",!0)]),e("div",hr,[e("span",fr,"âœ“ æˆåŠŸ "+u(r.taskStatus.successCount||0),1),e("span",br,"âœ— å¤±è´¥ "+u(r.taskStatus.failCount||0),1),t.taskDone&&r.hasRealErrors?(l(),a("button",{key:0,class:"btn sm outline retry-all-btn",onClick:s[21]||(s[21]=(...d)=>r.retryAllFailed&&r.retryAllFailed(...d)),disabled:t.starting||r.taskRunning}," ğŸ”„ é‡è¯•å…¨éƒ¨å¤±è´¥ ",8,yr)):I("",!0)]),r.hasErrorsOrWarnings?(l(),a("div",{key:0,class:z(["error-log-container",{"warning-only":!r.hasRealErrors}])},[e("div",kr,[e("span",null,u(r.hasRealErrors?"å¤±è´¥è¯¦æƒ…":"è­¦å‘Šä¿¡æ¯")+" ("+u(r.displayErrors.length)+")",1),r.hasRealErrors?(l(),a("span",wr,"å¯ç‚¹å‡»å³ä¾§æŒ‰é’®å•ç‹¬é‡è¯•")):I("",!0)]),r.displayErrors.length>0?(l(),a("div",_r,[(l(!0),a(N,null,F(r.displayErrors,(d,c)=>(l(),a("div",{key:c,class:z(["error-item",{"is-warning":d.isWarning}])},[e("div",Cr,[e("div",$r,[e("span",{class:"error-title",title:d.cardTitle},[d.isWarning?(l(),a("span",xr,"âš ï¸")):I("",!0),W(" "+u(d.cardTitle||"æœªçŸ¥å¡ç‰‡"),1)],8,Mr),e("span",Sr,u(r.formatTime(d.time)),1)]),e("div",{class:z(["error-msg",{"warning-msg":d.isWarning}]),title:d.error},u(d.error||"æœªçŸ¥é”™è¯¯åŸå› "),11,Tr)]),d.isWarning?I("",!0):(l(),a("button",{key:0,class:"btn xs outline retry-btn",onClick:ue(m=>r.retryCard(d),["stop"]),disabled:t.starting||r.taskRunning,title:"é‡è¯•æ­¤å¡ç‰‡"}," é‡è¯• ",8,Ur))],2))),128))])):(l(),a("div",Vr,u(r.taskRunning?"æ­£åœ¨å®æ—¶åŒæ­¥å¤±è´¥è¯¦æƒ…...":"æœªè·å–åˆ°è¯¦ç»†é”™è¯¯è®°å½•"),1))],2)):I("",!0),r.taskRunning?(l(),a("div",Ar,[e("button",{class:"btn danger",onClick:s[22]||(s[22]=(...d)=>r.stopTask&&r.stopTask(...d)),disabled:t.stopping},u(t.stopping?"åœæ­¢ä¸­...":"â¹ï¸ åœæ­¢ä»»åŠ¡"),9,Ir)])):I("",!0)])):I("",!0)])):I("",!0)]),e("div",Br,[e("button",{class:"btn",onClick:s[23]||(s[23]=d=>o.$emit("close")),disabled:r.taskRunning},"å–æ¶ˆ",8,Dr),e("div",Pr,[t.step>0&&!r.taskRunning?(l(),a("button",{key:0,class:"btn",onClick:s[24]||(s[24]=d=>t.step--)},"ä¸Šä¸€æ­¥")):I("",!0),t.step<3?(l(),a("button",{key:1,class:"btn primary",onClick:s[25]||(s[25]=(...d)=>r.nextStep&&r.nextStep(...d)),disabled:!r.canNext},u(t.step===2?"ä¸‹ä¸€æ­¥ï¼šæ‰§è¡Œ":"ä¸‹ä¸€æ­¥"),9,Er)):I("",!0),t.step===3&&t.taskDone?(l(),a("button",{key:2,class:"btn primary",onClick:s[26]||(s[26]=d=>o.$emit("close"))},"å®Œæˆ")):I("",!0)])])])])):I("",!0)}const Rr=Y(Mi,[["render",Lr],["__scopeId","data-v-5b66643c"]]),Ce={deepseek:{name:"DeepSeek",icon:"ğŸ³",recommended:!0,docsUrl:"https://platform.deepseek.com/",needsApiKey:!0,needsBaseUrl:!1,defaultModel:"deepseek-chat",models:["deepseek-chat","deepseek-reasoner"]},openai:{name:"OpenAI",icon:"ğŸ¤–",docsUrl:"https://platform.openai.com/",needsApiKey:!0,needsBaseUrl:!1,defaultModel:"gpt-4o-mini",models:["gpt-4o-mini","gpt-4o","gpt-3.5-turbo"]},gemini:{name:"Google Gemini",icon:"â™Š",docsUrl:"https://aistudio.google.com/",needsApiKey:!0,needsBaseUrl:!1,defaultModel:"gemini-1.5-flash",models:["gemini-1.5-flash","gemini-1.5-pro"]},anthropic:{name:"Anthropic",icon:"ğŸ¨",docsUrl:"https://console.anthropic.com/",needsApiKey:!0,needsBaseUrl:!1,defaultModel:"claude-3-haiku-20240307",models:["claude-3-5-sonnet-20240620","claude-3-haiku-20240307"]},zhipu:{name:"æ™ºè°± AI",icon:"ğŸ§ ",docsUrl:"https://open.bigmodel.cn/",needsApiKey:!0,needsBaseUrl:!1,defaultModel:"glm-4-flash",models:["glm-4-flash","glm-4"]},ollama:{name:"Ollama",icon:"ğŸ¦™",local:!0,docsUrl:"https://ollama.com/",needsApiKey:!1,needsBaseUrl:!0,defaultBaseUrl:"http://localhost:11434",defaultModel:"llama3",models:["llama3","qwen2","mistral"]},custom:{name:"è‡ªå®šä¹‰",icon:"ğŸ› ï¸",needsApiKey:!0,needsBaseUrl:!0,defaultModel:"",models:[]}},Wr={name:"AISettings",components:{AIBatchWizard:Rr},data(){return{providers:Ce,config:{provider:"deepseek",apiKey:"",baseUrl:"",model:"deepseek-chat",autoGenerate:!1,hasApiKey:!1},modelSelect:"deepseek-chat",showApiKey:!1,testing:!1,saving:!1,clearing:!1,showClearConfirm:!1,refreshing:!1,starting:!1,stopping:!1,connectionTested:!1,connectionOk:!1,stats:null,task:{running:!1,type:"",mode:"",current:0,total:0,currentCard:"",startTime:0,errors:[],successCount:0,failCount:0},eventSource:null,toast:{show:!1,msg:"",type:"info"},showWizard:!1}},computed:{currentProvider(){return Ce[this.config.provider]||Ce.deepseek},canTest(){return!(this.currentProvider.needsApiKey&&!this.config.apiKey&&!this.config.hasApiKey||this.currentProvider.needsBaseUrl&&!this.config.baseUrl)},connectionStatus(){return!this.config.hasApiKey&&!this.config.apiKey?"none":this.connectionTested?this.connectionOk?"ok":"err":"pending"},statusText(){return{none:"æœªé…ç½®",ok:"å·²è¿æ¥",err:"è¿æ¥å¤±è´¥",pending:"å¾…æµ‹è¯•"}[this.connectionStatus]},totalMissing(){return this.stats?this.stats.emptyName+this.stats.emptyDesc+this.stats.emptyTags:0},taskPercent(){return this.task.total?Math.round(this.task.current/this.task.total*100):0},taskTitle(){const o={name:"åç§°",description:"æè¿°",tags:"æ ‡ç­¾"},s=this.task.types||[this.task.type];return Array.isArray(s)&&s.length>0?`æ­£åœ¨ç”Ÿæˆ${s.map(i=>o[i]||i).join("ã€")}`:"æ­£åœ¨ç”Ÿæˆå†…å®¹"},taskEta(){if(!this.task.startTime||this.task.current<2)return"";const s=(Date.now()-this.task.startTime)/this.task.current,i=(this.task.total-this.task.current)*s;return i<6e4?`${Math.round(i/1e3)}ç§’`:`${Math.round(i/6e4)}åˆ†é’Ÿ`},actionItems(){var o,s,i;return[{type:"name",label:"åç§°",icon:"ğŸ“",emptyCount:((o=this.stats)==null?void 0:o.emptyName)||0},{type:"description",label:"æè¿°",icon:"ğŸ“„",emptyCount:((s=this.stats)==null?void 0:s.emptyDesc)||0},{type:"tags",label:"æ ‡ç­¾",icon:"ğŸ·ï¸",emptyCount:((i=this.stats)==null?void 0:i.emptyTags)||0}]}},mounted(){return M(this,null,function*(){yield Promise.all([this.loadConfig(),this.refreshStats()]),this.initRealtimeUpdates(),document.addEventListener("visibilitychange",this.handleVisibilityChange)})},beforeUnmount(){this.closeEventSource(),document.removeEventListener("visibilitychange",this.handleVisibilityChange)},methods:{handleVisibilityChange(){document.visibilityState==="visible"&&(this.refreshStats(),this.eventSource||this.initRealtimeUpdates())},selectProvider(o){var s;this.config.provider=o,this.config.model=this.currentProvider.defaultModel,this.modelSelect=(s=this.currentProvider.models)!=null&&s.includes(this.config.model)?this.config.model:"",this.config.baseUrl=this.currentProvider.defaultBaseUrl||"",this.config.apiKey="",this.config.hasApiKey=!1,this.connectionTested=!1},onModelChange(){this.modelSelect&&(this.config.model=this.modelSelect)},loadConfig(){return M(this,null,function*(){var o;try{const{data:s}=yield xs();if(s.success){const i=s.config;this.config.provider=i.provider||"deepseek",this.config.hasApiKey=i.hasApiKey,this.config.baseUrl=i.baseUrl||"",this.config.model=i.model||this.currentProvider.defaultModel,this.modelSelect=(o=this.currentProvider.models)!=null&&o.includes(this.config.model)?this.config.model:"",this.config.autoGenerate=i.autoGenerate||!1,i.lastTestedOk?(this.connectionTested=!0,this.connectionOk=!0):i.hasApiKey&&(this.connectionTested=!1,this.connectionOk=!1)}}catch(s){}})},saveConfig(){return M(this,null,function*(){var o,s;this.saving=!0;try{const{data:i}=yield Ms({provider:this.config.provider,apiKey:this.config.apiKey||void 0,baseUrl:this.config.baseUrl||this.currentProvider.defaultBaseUrl,model:this.config.model,autoGenerate:this.config.autoGenerate});i.success?(this.showToast("é…ç½®å·²ä¿å­˜","success"),this.config.hasApiKey=!0,this.config.apiKey="",this.testConnection()):this.showToast(i.message,"error")}catch(i){this.showToast(((s=(o=i.response)==null?void 0:o.data)==null?void 0:s.message)||"ä¿å­˜å¤±è´¥","error")}this.saving=!1})},testConnection(){return M(this,null,function*(){this.testing=!0;try{const{data:o}=yield $s();this.connectionTested=!0,this.connectionOk=o.success,this.showToast(o.success?"è¿æ¥æˆåŠŸ":o.message,o.success?"success":"error")}catch(o){this.connectionTested=!0,this.connectionOk=!1,this.showToast("è¿æ¥å¤±è´¥","error")}this.testing=!1})},clearConfig(){return M(this,null,function*(){var o,s;this.clearing=!0;try{const{data:i}=yield Cs();i.success?(this.showToast("é…ç½®å·²æ¸…é™¤","success"),this.config.hasApiKey=!1,this.config.apiKey="",this.config.baseUrl="",this.config.model=this.currentProvider.defaultModel,this.connectionTested=!1,this.connectionOk=!1,this.showClearConfirm=!1):this.showToast(i.message||"æ¸…é™¤å¤±è´¥","error")}catch(i){this.showToast(((s=(o=i.response)==null?void 0:o.data)==null?void 0:s.message)||"æ¸…é™¤å¤±è´¥","error")}this.clearing=!1})},refreshStats(){return M(this,null,function*(){this.refreshing=!0;try{const{data:o}=yield _s();o.success&&(this.stats=o.stats)}catch(o){console.error("Failed to refresh stats:",o)}this.refreshing=!1})},initRealtimeUpdates(){return M(this,null,function*(){this.closeEventSource();const o=localStorage.getItem("token"),s=`/api/ai/batch-task/stream${o?"?token="+encodeURIComponent(o):""}`;this.eventSource=new EventSource(s),this.eventSource.onmessage=i=>{try{const T=JSON.parse(i.data);this.updateTaskState(T)}catch(T){console.error("Failed to parse SSE data:",T)}},this.eventSource.onerror=i=>{console.warn("SSE connection error, falling back to polling...",i),this.closeEventSource()}})},closeEventSource(){this.eventSource&&(this.eventSource.close(),this.eventSource=null)},updateTaskState(o){if(o){if(this.task.running&&!o.running){this.task.current=this.task.total,this.task.total>0&&o.successCount!==void 0&&this.showToast(`ä»»åŠ¡ç»“æŸï¼æˆåŠŸ ${o.successCount||0}ï¼Œå¤±è´¥ ${o.failCount||0}`,o.failCount>0?"info":"success"),this.refreshStats(),this.task=ne(q(q({},this.task),o),{running:!0}),setTimeout(()=>{this.task.running=!1,this.refreshStats()},2e3);return}if(o.running||this.task.running){const s=this.task.running&&!o.running;this.task=ne(q(q({},this.task),o),{running:s?!0:!!o.running,startTime:o.startTime||this.task.startTime||Date.now()})}else this.task=ne(q(q({},this.task),o),{running:!1})}},startTask(o,s){return M(this,null,function*(){var i,T;if(!(this.starting||this.task.running)&&!(s==="all"&&!confirm(`ç¡®å®šè¦é‡æ–°ç”Ÿæˆæ‰€æœ‰å¡ç‰‡çš„${o==="name"?"åç§°":o==="description"?"æè¿°":"æ ‡ç­¾"}å—ï¼Ÿ`))){this.starting=!0;try{this.task={running:!0,type:o,mode:s,current:0,total:0,successCount:0,failCount:0,currentCard:"å‡†å¤‡ä¸­...",startTime:Date.now(),errors:[],types:o==="all"?["name","description","tags"]:[o]};const{data:t}=yield Me({type:o,mode:s});if(!t.success){this.showToast(t.message||"å¯åŠ¨å¤±è´¥","error"),this.task.running=!1;return}if(t.total===0){this.showToast("æ²¡æœ‰éœ€è¦å¤„ç†çš„å¡ç‰‡","info"),this.task.running=!1,this.refreshStats();return}this.task.total=t.total,this.showToast(`ä»»åŠ¡å·²å¯åŠ¨ï¼Œæ­£åœ¨å¤„ç† ${t.total} ä¸ªå¡ç‰‡`,"success"),this.initRealtimeUpdates()}catch(t){this.showToast(((T=(i=t.response)==null?void 0:i.data)==null?void 0:T.message)||"å¯åŠ¨å¤±è´¥","error"),this.task.running=!1}finally{this.starting=!1}}})},stopTask(){return M(this,null,function*(){this.stopping=!0;try{yield Le(),this.showToast("æ­£åœ¨åœæ­¢...","info"),this.refreshStats()}catch(o){}setTimeout(()=>{this.stopping=!1},2e3)})},retryCard(o){return M(this,null,function*(){o.cardId&&(yield this.doStartBatchTask([o.cardId],this.task.types||["name","description","tags"]))})},retryAllFailed(){return M(this,null,function*(){const o=this.task.errors.map(s=>s.cardId).filter(s=>!!s);o.length!==0&&(yield this.doStartBatchTask(o,this.task.types||["name","description","tags"]))})},doStartBatchTask(o,s){return M(this,null,function*(){var i,T;if(!(this.starting||this.task.running)){this.starting=!0;try{this.task={running:!0,current:0,total:o.length,successCount:0,failCount:0,currentCard:"å‡†å¤‡ä¸­...",startTime:Date.now(),errors:[],types:s};const{data:t}=yield Me({cardIds:o,types:s});if(!t.success){this.showToast(t.message||"å¯åŠ¨å¤±è´¥","error"),this.task.running=!1;return}this.showToast("é‡è¯•ä»»åŠ¡å·²å¯åŠ¨","success"),this.initRealtimeUpdates()}catch(t){this.showToast(((T=(i=t.response)==null?void 0:i.data)==null?void 0:T.message)||"å¯åŠ¨å¤±è´¥","error"),this.task.running=!1}finally{this.starting=!1}}})},showToast(o,s="info"){this.toast={show:!0,msg:o,type:s},setTimeout(()=>{this.toast.show=!1},3e3)},onWizardClose(){this.showWizard=!1,this.refreshStats(),this.task.running||this.initRealtimeUpdates()},onWizardStart(o){const s=o.running!==!1;this.task=ne(q(q({},this.task),o),{running:s,startTime:s?Date.now():this.task.startTime}),s&&this.initRealtimeUpdates()}}},zr={class:"ai-settings"},Kr={class:"page-header"},Nr={key:0,class:"quick-start"},Fr={class:"section"},Or={class:"provider-grid"},Hr=["onClick"],Gr={class:"provider-icon"},jr={class:"provider-info"},qr={class:"provider-name"},Jr={key:0,class:"provider-tag"},Qr={key:1,class:"provider-tag local"},Xr={class:"section"},Yr={class:"section-header"},Zr=["href"],ed={class:"config-form"},sd={key:0,class:"form-item"},td={class:"input-group"},nd=["type","placeholder"],ld={key:1,class:"form-item"},ad=["placeholder"],od={class:"form-item"},id={class:"model-select"},rd=["value"],dd=["placeholder"],ud={class:"form-item switch-item"},cd={class:"switch"},vd={class:"form-actions"},pd=["disabled"],md=["disabled"],gd=["disabled"],hd={class:"section"},fd={class:"section-header"},bd=["disabled"],yd={key:0,class:"stats"},kd={class:"stat"},wd={key:1,class:"task-panel"},_d={class:"task-header"},Cd={class:"task-title"},$d={class:"task-counts"},Md={class:"count-item success"},xd={key:0,class:"count-item fail"},Sd={class:"count-item total"},Td={class:"progress-wrap"},Ud={class:"progress-bar"},Vd={class:"progress-text"},Ad={class:"task-info"},Id=["title"],Bd={key:1,class:"task-eta"},Dd={key:0,class:"task-errors"},Pd={class:"error-header"},Ed=["disabled"],Ld={key:0,class:"error-list"},Rd={class:"err-info"},Wd=["title"],zd=["title"],Kd=["onClick","disabled"],Nd={key:1,class:"error-empty-hint"},Fd={class:"task-actions"},Od={key:0,class:"task-concurrency"},Hd={key:0,class:"rate-limit-tag"},Gd=["disabled"],jd={key:2,class:"batch-actions"},qd={class:"action-bar"},Jd=["disabled"],Qd=["disabled"],Xd={key:0,class:"action-hint"},Yd={class:"modal-header"},Zd={class:"modal-footer"},eu=["disabled"];function su(o,s,i,T,t,r){const d=Ge("AIBatchWizard");return l(),a("div",zr,[e("div",Kr,[s[21]||(s[21]=e("h2",null,"ğŸ¤– AI æ™ºèƒ½ç”Ÿæˆ",-1)),e("div",{class:z(["connection-status",r.connectionStatus])},[s[20]||(s[20]=e("span",{class:"status-dot"},null,-1)),e("span",null,u(r.statusText),1)],2)]),!t.config.hasApiKey&&!t.config.apiKey?(l(),a("div",Nr,[...s[22]||(s[22]=[re('<div class="quick-start-icon" data-v-82585991>ğŸš€</div><div class="quick-start-content" data-v-82585991><h4 data-v-82585991>å¿«é€Ÿå¼€å§‹</h4><p data-v-82585991>é…ç½® AI æœåŠ¡åï¼Œå¯è‡ªåŠ¨ä¸ºå¡ç‰‡ç”Ÿæˆåç§°ã€æè¿°å’Œæ ‡ç­¾</p><div class="quick-start-steps" data-v-82585991><span class="step" data-v-82585991>1. é€‰æ‹©æä¾›å•†</span><span class="step" data-v-82585991>2. å¡«å†™ API Key</span><span class="step" data-v-82585991>3. æµ‹è¯•è¿æ¥</span></div></div>',2)])])):I("",!0),e("div",Fr,[s[23]||(s[23]=e("div",{class:"section-header"},[e("h3",null,"é€‰æ‹© AI æä¾›å•†"),e("span",{class:"section-hint"},"æ¨èä½¿ç”¨ DeepSeekï¼Œæ€§ä»·æ¯”é«˜")],-1)),e("div",Or,[(l(!0),a(N,null,F(t.providers,(c,m)=>(l(),a("div",{key:m,class:z(["provider-card",{active:t.config.provider===m}]),onClick:k=>r.selectProvider(m)},[e("div",Gr,u(c.icon),1),e("div",jr,[e("span",qr,u(c.name),1),c.recommended?(l(),a("span",Jr,"æ¨è")):I("",!0),c.local?(l(),a("span",Qr,"æœ¬åœ°")):I("",!0)])],10,Hr))),128))])]),e("div",Xr,[e("div",Yr,[s[24]||(s[24]=e("h3",null,"API é…ç½®",-1)),r.currentProvider.docsUrl?(l(),a("a",{key:0,href:r.currentProvider.docsUrl,target:"_blank",class:"docs-link"}," ğŸ“– è·å– API Key ",8,Zr)):I("",!0)]),e("div",ed,[r.currentProvider.needsApiKey?(l(),a("div",sd,[e("label",null,[s[25]||(s[25]=e("span",null,"API Key",-1)),e("span",{class:z(["label-status",{ok:t.config.hasApiKey}])},u(t.config.hasApiKey?"âœ“ å·²é…ç½®":"æœªé…ç½®"),3)]),e("div",td,[$(e("input",{type:t.showApiKey?"text":"password","onUpdate:modelValue":s[0]||(s[0]=c=>t.config.apiKey=c),placeholder:t.config.hasApiKey?"å·²é…ç½®ï¼ˆç•™ç©ºä¿æŒä¸å˜ï¼‰":"è¯·è¾“å…¥ API Key",class:"input"},null,8,nd),[[Ee,t.config.apiKey]]),e("button",{type:"button",class:"input-btn",onClick:s[1]||(s[1]=c=>t.showApiKey=!t.showApiKey)},u(t.showApiKey?"ğŸ™ˆ":"ğŸ‘ï¸"),1)])])):I("",!0),r.currentProvider.needsBaseUrl?(l(),a("div",ld,[s[26]||(s[26]=e("label",null,"Base URL",-1)),$(e("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=c=>t.config.baseUrl=c),placeholder:r.currentProvider.defaultBaseUrl,class:"input"},null,8,ad),[[L,t.config.baseUrl]])])):I("",!0),e("div",od,[s[28]||(s[28]=e("label",null,"æ¨¡å‹",-1)),e("div",id,[$(e("select",{"onUpdate:modelValue":s[3]||(s[3]=c=>t.modelSelect=c),class:"input",onChange:s[4]||(s[4]=(...c)=>r.onModelChange&&r.onModelChange(...c))},[s[27]||(s[27]=e("option",{value:""},"è‡ªå®šä¹‰æ¨¡å‹",-1)),(l(!0),a(N,null,F(r.currentProvider.models,c=>(l(),a("option",{key:c,value:c},u(c),9,rd))),128))],544),[[ie,t.modelSelect]]),t.modelSelect===""?$((l(),a("input",{key:0,type:"text","onUpdate:modelValue":s[5]||(s[5]=c=>t.config.model=c),placeholder:r.currentProvider.defaultModel||"è¾“å…¥æ¨¡å‹åç§°",class:"input"},null,8,dd)),[[L,t.config.model]]):I("",!0)])]),e("div",ud,[s[30]||(s[30]=e("span",null,[e("strong",null,"è‡ªåŠ¨ç”Ÿæˆ"),e("small",null,"æ·»åŠ å¡ç‰‡æ—¶è‡ªåŠ¨ç”Ÿæˆåç§°ã€æè¿°å’Œæ ‡ç­¾")],-1)),e("label",cd,[$(e("input",{type:"checkbox","onUpdate:modelValue":s[6]||(s[6]=c=>t.config.autoGenerate=c)},null,512),[[J,t.config.autoGenerate]]),s[29]||(s[29]=e("span",{class:"slider"},null,-1))])]),e("div",vd,[e("button",{class:"btn",onClick:s[7]||(s[7]=(...c)=>r.testConnection&&r.testConnection(...c)),disabled:t.testing||!r.canTest},u(t.testing?"â³ æµ‹è¯•ä¸­...":"ğŸ”— æµ‹è¯•è¿æ¥"),9,pd),e("button",{class:"btn primary",onClick:s[8]||(s[8]=(...c)=>r.saveConfig&&r.saveConfig(...c)),disabled:t.saving},u(t.saving?"â³ ä¿å­˜ä¸­...":"ğŸ’¾ ä¿å­˜é…ç½®"),9,md),t.config.hasApiKey?(l(),a("button",{key:0,class:"btn danger",onClick:s[9]||(s[9]=c=>t.showClearConfirm=!0),disabled:t.clearing},u(t.clearing?"â³ æ¸…é™¤ä¸­...":"ğŸ—‘ï¸ æ¸…é™¤é…ç½®"),9,gd)):I("",!0)])])]),e("div",hd,[e("div",fd,[s[31]||(s[31]=e("h3",null,"æ‰¹é‡ç”Ÿæˆ",-1)),e("button",{class:"icon-btn",onClick:s[10]||(s[10]=(...c)=>r.refreshStats&&r.refreshStats(...c)),disabled:t.refreshing},u(t.refreshing?"â³":"ğŸ”„"),9,bd)]),t.stats?(l(),a("div",yd,[e("div",kd,[e("span",null,u(t.stats.total),1),s[32]||(s[32]=W("æ€»æ•°",-1))]),e("div",{class:z(["stat",{warn:t.stats.emptyName}])},[e("span",null,u(t.stats.emptyName),1),s[33]||(s[33]=W("ç¼ºåç§°",-1))],2),e("div",{class:z(["stat",{warn:t.stats.emptyDesc}])},[e("span",null,u(t.stats.emptyDesc),1),s[34]||(s[34]=W("ç¼ºæè¿°",-1))],2),e("div",{class:z(["stat",{warn:t.stats.emptyTags}])},[e("span",null,u(t.stats.emptyTags),1),s[35]||(s[35]=W("ç¼ºæ ‡ç­¾",-1))],2)])):I("",!0),t.task.running&&!t.showWizard?(l(),a("div",wd,[e("div",_d,[e("span",Cd,u(r.taskTitle),1),e("div",$d,[e("span",Md,"æˆåŠŸ: "+u(t.task.successCount||0),1),t.task.failCount?(l(),a("span",xd,"å¤±è´¥: "+u(t.task.failCount),1)):I("",!0),e("span",Sd,u(t.task.current)+" / "+u(t.task.total),1)])]),e("div",Td,[e("div",Ud,[e("div",{class:"progress-fill",style:ve({width:r.taskPercent+"%"})},null,4)]),e("span",Vd,u(r.taskPercent)+"%",1)]),e("div",Ad,[t.task.currentCard?(l(),a("span",{key:0,class:"task-current",title:t.task.currentCard},"æ­£åœ¨å¤„ç†: "+u(t.task.currentCard),9,Id)):I("",!0),r.taskEta?(l(),a("span",Bd,"å‰©ä½™çº¦ "+u(r.taskEta),1)):I("",!0)]),t.task.failCount>0?(l(),a("div",Dd,[e("div",Pd,[e("span",null,"å¤±è´¥è¯¦æƒ… ("+u(t.task.errors?t.task.errors.length:0)+"/"+u(t.task.failCount)+")",1),!t.task.running&&t.task.failCount>0?(l(),a("button",{key:0,class:"btn xs outline retry-all-btn",onClick:s[11]||(s[11]=(...c)=>r.retryAllFailed&&r.retryAllFailed(...c)),disabled:t.starting}," ğŸ”„ é‡è¯•å…¨éƒ¨å¤±è´¥ ",8,Ed)):I("",!0)]),t.task.errors&&t.task.errors.length>0?(l(),a("div",Ld,[(l(!0),a(N,null,F(t.task.errors,(c,m)=>(l(),a("div",{key:m,class:"error-item"},[e("div",Rd,[e("span",{class:"err-title",title:c.cardTitle},u(c.cardTitle)+":",9,Wd),e("span",{class:"err-msg",title:c.error},u(c.error),9,zd)]),e("button",{class:"btn xs outline",onClick:k=>r.retryCard(c),disabled:t.starting||t.task.running},"é‡è¯•",8,Kd)]))),128))])):(l(),a("div",Nd," æ­£åœ¨åŒæ­¥å¤±è´¥è¯¦æƒ…... "))])):I("",!0),e("div",Fd,[t.task.concurrency?(l(),a("div",Od,[W(" å¹¶å‘æ•°: "+u(t.task.concurrency)+" ",1),t.task.isRateLimited?(l(),a("span",Hd,"é™æµä¸­")):I("",!0)])):I("",!0),e("button",{class:"btn danger sm",onClick:s[12]||(s[12]=(...c)=>r.stopTask&&r.stopTask(...c)),disabled:t.stopping},u(t.stopping?"åœæ­¢ä¸­...":"â¹ï¸ åœæ­¢ä»»åŠ¡"),9,Gd)])])):(l(),a("div",jd,[e("div",qd,[e("button",{class:"btn primary lg main-action",onClick:s[13]||(s[13]=c=>r.startTask("all","empty")),disabled:!t.config.hasApiKey||t.starting||r.totalMissing===0}," âœ¨ æ™ºèƒ½è¡¥å…¨ç¼ºå¤±å†…å®¹ ("+u(r.totalMissing)+") ",9,Jd),e("button",{class:"btn lg outline wizard-action",onClick:s[14]||(s[14]=c=>t.showWizard=!0),disabled:!t.config.hasApiKey}," ğŸ¯ é«˜çº§æ‰¹é‡ç”Ÿæˆå‘å¯¼ ",8,Qd)]),r.totalMissing>0?(l(),a("p",Xd," è¡¥å…¨å°†è‡ªåŠ¨åˆ†æ URL å¹¶ç”Ÿæˆç¼ºå¤±çš„åç§°ã€æè¿°å’Œæ ‡ç­¾ã€‚ ")):I("",!0)]))]),Pe(d,{visible:t.showWizard,"active-task":t.task,onClose:r.onWizardClose,onStart:r.onWizardStart},null,8,["visible","active-task","onClose","onStart"]),t.showClearConfirm?(l(),a("div",{key:1,class:"modal-overlay",onClick:s[19]||(s[19]=c=>t.showClearConfirm=!1)},[e("div",{class:"modal-content",onClick:s[18]||(s[18]=ue(()=>{},["stop"]))},[e("div",Yd,[s[36]||(s[36]=e("h3",null,"âš ï¸ ç¡®è®¤æ¸…é™¤",-1)),e("button",{onClick:s[15]||(s[15]=c=>t.showClearConfirm=!1),class:"close-btn"},"Ã—")]),s[37]||(s[37]=e("div",{class:"modal-body"},[e("p",{class:"warning-text"},"æ¸…é™¤åï¼Œæ‰€æœ‰ AI åŠŸèƒ½å°†ä¸å¯ç”¨ï¼ŒåŒ…æ‹¬ï¼š"),e("ul",{class:"warning-list"},[e("li",null,"è‡ªåŠ¨ç”Ÿæˆå¡ç‰‡åç§°ã€æè¿°å’Œæ ‡ç­¾"),e("li",null,"æ‰¹é‡æ™ºèƒ½è¡¥å…¨åŠŸèƒ½"),e("li",null,"æ‰‹åŠ¨ AI ç”ŸæˆåŠŸèƒ½")]),e("p",{class:"warning-text"},"ç¡®å®šè¦æ¸…é™¤ API é…ç½®å—ï¼Ÿ")],-1)),e("div",Zd,[e("button",{class:"btn",onClick:s[16]||(s[16]=c=>t.showClearConfirm=!1)},"å–æ¶ˆ"),e("button",{class:"btn danger",onClick:s[17]||(s[17]=(...c)=>r.clearConfig&&r.clearConfig(...c)),disabled:t.clearing},u(t.clearing?"æ¸…é™¤ä¸­...":"ç¡®è®¤æ¸…é™¤"),9,eu)])])])):I("",!0),e("div",{class:z(["toast",[t.toast.type,{show:t.toast.show}]])},u(t.toast.msg),3)])}const tu=Y(Wr,[["render",su],["__scopeId","data-v-82585991"]]),nu={key:0,class:"login-container"},lu={class:"login-card"},au={class:"login-form"},ou={class:"password-input-wrapper"},iu=["type"],ru={key:0,width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},du={key:1,width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},uu={class:"login-buttons"},cu=["disabled"],vu={key:0,class:"login-error"},pu={key:1,class:"admin-layout"},mu={class:"menu-list"},gu={class:"admin-main"},hu={class:"admin-header"},fu={class:"header-title"},bu={class:"admin-content"},De=1800*1e3,yu={__name:"Admin",setup(o){const s=x("welcome");let i=null,T=Date.now();function t(){T=Date.now(),localStorage.setItem("lastActivityTime",T.toString()),i&&clearTimeout(i),v.value&&(i=setTimeout(()=>{r()},De))}function r(){v.value&&(alert("ç”±äºé•¿æ—¶é—´æœªæ“ä½œï¼Œå·²è‡ªåŠ¨é€€å‡ºç™»å½•"),K())}function d(){const P=localStorage.getItem("lastActivityTime");return P&&Date.now()-parseInt(P)>=De?(localStorage.removeItem("token"),localStorage.removeItem("lastActivityTime"),!0):!1}const c=["mousedown","mousemove","keydown","scroll","touchstart","click"];function m(){c.forEach(P=>{document.addEventListener(P,t,{passive:!0})})}function k(){c.forEach(P=>{document.removeEventListener(P,t)})}je(()=>{i&&clearTimeout(i),k()});const C={welcome:Es,menu:Ut,card:hn,duplicate:Zn,tag:fl,promo:ql,friend:la,user:_a,backup:$i,ai:tu},y=de(()=>C[s.value]),V=de(()=>s.value==="welcome"?{lastLoginTime:b.value,lastLoginIp:g.value,currentUsername:h.value}:{}),b=x(""),g=x(""),h=x("admin"),v=x(!1),B=x(""),U=x(""),A=x(!1),H=x(""),X=x(!1),ee=x(!1),se=de(()=>{switch(s.value){case"menu":return"æ ç›®ç®¡ç†";case"card":return"å¡ç‰‡ç®¡ç†";case"duplicate":return"å»é‡ç®¡ç†";case"tag":return"æ ‡ç­¾ç®¡ç†";case"promo":return"å®£ä¼ ç®¡ç†";case"friend":return"å‹é“¾ç®¡ç†";case"user":return"ç”¨æˆ·ç®¡ç†";case"backup":return"å¤‡ä»½ç®¡ç†";case"ai":return"AI è®¾ç½®";default:return""}});ae(()=>M(null,null,function*(){if(d()){v.value=!1;return}localStorage.getItem("token")?(v.value=!0,yield le(),v.value&&(t(),m())):v.value=!1}));function le(){return M(this,null,function*(){try{const P=yield fetch("/api/users/me",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(P.ok){const f=yield P.json();b.value=f.last_login_time||"",g.value=f.last_login_ip||"",h.value=f.username||"admin"}else P.status===401&&(console.warn("TokenéªŒè¯å¤±è´¥ï¼Œè‡ªåŠ¨é€€å‡ºç™»å½•"),K())}catch(P){console.error("è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:",P)}})}function te(){return M(this,null,function*(){var P,f;if(!B.value||!U.value){H.value="è¯·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ";return}A.value=!0,H.value="";try{const p=yield Ss(B.value,U.value);p.data.token&&(localStorage.setItem("token",p.data.token),v.value=!0,b.value=p.data.lastLoginTime||"",g.value=p.data.lastLoginIp||"",yield le(),t(),m())}catch(p){H.value=((f=(P=p.response)==null?void 0:P.data)==null?void 0:f.message)||"ç™»å½•å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç”¨æˆ·åå’Œå¯†ç "}finally{A.value=!1}})}function K(){i&&(clearTimeout(i),i=null),k(),localStorage.removeItem("token"),localStorage.removeItem("lastActivityTime"),v.value=!1,B.value="",U.value="",H.value=""}function R(){window.open("/","_blank")}function _(){ee.value=!ee.value}function D(){ee.value=!1}return(P,f)=>v.value?(l(),a("div",pu,[e("aside",{class:z(["admin-sider",{open:ee.value}]),onClick:ue(D,["self"])},[e("div",{class:"logo clickable",onClick:f[3]||(f[3]=p=>{s.value="welcome",D()})},"Admin"),e("ul",mu,[e("li",{class:z({active:s.value==="menu"}),onClick:f[4]||(f[4]=p=>{s.value="menu",D()})},"æ ç›®ç®¡ç†",2),e("li",{class:z({active:s.value==="card"}),onClick:f[5]||(f[5]=p=>{s.value="card",D()})},"å¡ç‰‡ç®¡ç†",2),e("li",{class:z({active:s.value==="duplicate"}),onClick:f[6]||(f[6]=p=>{s.value="duplicate",D()})},"å»é‡ç®¡ç†",2),e("li",{class:z({active:s.value==="tag"}),onClick:f[7]||(f[7]=p=>{s.value="tag",D()})},"æ ‡ç­¾ç®¡ç†",2),e("li",{class:z({active:s.value==="promo"}),onClick:f[8]||(f[8]=p=>{s.value="promo",D()})},"å®£ä¼ ç®¡ç†",2),e("li",{class:z({active:s.value==="friend"}),onClick:f[9]||(f[9]=p=>{s.value="friend",D()})},"å‹é“¾ç®¡ç†",2),e("li",{class:z({active:s.value==="user"}),onClick:f[10]||(f[10]=p=>{s.value="user",D()})},"ç”¨æˆ·ç®¡ç†",2),e("li",{class:z({active:s.value==="backup"}),onClick:f[11]||(f[11]=p=>{s.value="backup",D()})},"å¤‡ä»½ç®¡ç†",2),e("li",{class:z({active:s.value==="ai"}),onClick:f[12]||(f[12]=p=>{s.value="ai",D()})},"AI è®¾ç½®",2)])],2),e("main",gu,[e("div",hu,[e("button",{class:"menu-toggle",onClick:_}," â˜° "),e("div",fu,u(se.value),1),e("div",{class:"header-actions"},[e("span",{class:"home-icon",onClick:R,title:"è¿›å…¥ä¸»é¡µ"},[...f[17]||(f[17]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},[e("path",{d:"M3 10.5L12 4l9 6.5V20a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1v-4h-4v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V10.5z",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])]),e("button",{class:"btn logout-btn",onClick:K},"é€€å‡ºç™»å½•")])]),e("div",bu,[Pe(Je,{name:"fade",mode:"out-in"},{default:qe(()=>[(l(),Qe(Xe(y.value),Ye({key:s.value},V.value),null,16))]),_:1})]),f[18]||(f[18]=e("footer",{class:"admin-footer"},[e("p",{class:"admin-copyright"},[W("Copyright Â© 2025 Con-Nav-Item | "),e("a",{href:"https://github.com/zczy-k/Con-Nav-Item",target:"_blank",class:"footer-link"},"Powered by zczy-k")])],-1))])])):(l(),a("div",nu,[e("div",lu,[f[16]||(f[16]=e("h2",{class:"login-title"},"åå°ç®¡ç†ç™»å½•",-1)),e("div",au,[$(e("input",{"onUpdate:modelValue":f[0]||(f[0]=p=>B.value=p),type:"text",placeholder:"ç”¨æˆ·åï¼ˆé»˜è®¤ï¼šadminï¼‰",class:"login-input",onKeyup:$e(te,["enter"])},null,544),[[L,B.value]]),e("div",ou,[$(e("input",{"onUpdate:modelValue":f[1]||(f[1]=p=>U.value=p),type:X.value?"text":"password",placeholder:"å¯†ç ï¼ˆé»˜è®¤ï¼š123456ï¼‰",class:"login-input password-input",onKeyup:$e(te,["enter"])},null,40,iu),[[Ee,U.value]]),e("span",{class:"toggle-password",onClick:f[2]||(f[2]=p=>X.value=!X.value)},[X.value?(l(),a("svg",ru,[...f[13]||(f[13]=[e("path",{d:"M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12z"},null,-1),e("circle",{cx:"12",cy:"12",r:"3"},null,-1)])])):(l(),a("svg",du,[...f[14]||(f[14]=[e("path",{d:"M17.94 17.94A10.94 10.94 0 0 1 12 19c-7 0-11-7-11-7a21.77 21.77 0 0 1 5.06-6.06"},null,-1),e("path",{d:"M1 1l22 22"},null,-1),e("path",{d:"M9.53 9.53A3 3 0 0 0 12 15a3 3 0 0 0 2.47-5.47"},null,-1)])]))])]),e("div",uu,[e("button",{onClick:R,class:"back-btn"},[...f[15]||(f[15]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1),W(" è¿”å›é¦–é¡µ ",-1)])]),e("button",{onClick:te,class:"login-btn",disabled:A.value},u(A.value?"ç™»å½•ä¸­...":"ç™»å½•"),9,cu)]),H.value?(l(),a("p",vu,u(H.value),1)):I("",!0)])])]))}},Cu=Y(yu,[["__scopeId","data-v-52d75759"]]);export{Cu as default};
