var Re=Object.defineProperty,Ne=Object.defineProperties;var Fe=Object.getOwnPropertyDescriptors;var Se=Object.getOwnPropertySymbols;var Oe=Object.prototype.hasOwnProperty,He=Object.prototype.propertyIsEnumerable;var Ve=(d,s,i)=>s in d?Re(d,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):d[s]=i,le=(d,s)=>{for(var i in s||(s={}))Oe.call(s,i)&&Ve(d,i,s[i]);if(Se)for(var i of Se(s))He.call(s,i)&&Ve(d,i,s[i]);return d},re=(d,s)=>Ne(d,Fe(s));var A=(d,s,i)=>new Promise((U,t)=>{var f=u=>{try{n(i.next(u))}catch(h){t(h)}},P=u=>{try{n(i.throw(u))}catch(h){t(h)}},n=u=>u.done?U(u.value):Promise.resolve(u.value).then(f,P);n((i=i.apply(d,s)).next())});import{_ as X,c as a,b as o,f as e,t as r,A as ie,r as $,o as ne,d as B,k as C,v as K,m as Me,F as N,e as F,i as ce,w as Ae,B as ae,s as W,y as pe,h as we,g as z,C as oe,z as _e,q as G,D as Te,j as Le,E as Ke,G as qe,a as je,l as Ge,T as Je,H as Qe,I as Xe,J as Ye}from"./index-DQamno5O.js";import{g as xe,m as Ze,w as es,t as ss,u as ts,n as ls,o as ns,c as Ue,k as os,p as Be,x as Ie,f as as,z as is,A as rs,B as Ce,C as ds,D as us,E as cs,F as vs,i as ue,b as ps,G as ms,H as fs,I as gs,J as hs,K as bs,L as ks,M as ys,N as ws,O as _s,P as Cs,Q as $s}from"./urlNormalizer-DEF32Z9D.js";const Ms={class:"welcome-page"},xs={class:"welcome-title"},Us={class:"welcome-cards"},Ss={class:"welcome-card"},Vs={class:"welcome-value"},As={class:"welcome-card"},Ts={class:"welcome-value"},Bs={__name:"WelcomePage",props:{lastLoginTime:String,lastLoginIp:String,currentUsername:String},setup(d){return(s,i)=>(o(),a("div",Ms,[e("h2",xs,"æ¬¢è¿æ‚¨ï¼Œ"+r(d.currentUsername||"admin")+"ï¼",1),e("div",Us,[e("div",Ss,[i[0]||(i[0]=ie('<div class="welcome-icon time-icon" data-v-5cc4f846><svg width="32" height="32" viewBox="0 0 24 24" fill="none" data-v-5cc4f846><circle cx="12" cy="12" r="10" stroke="#1abc9c" stroke-width="2" data-v-5cc4f846></circle><path d="M12 6v6l4 2" stroke="#1abc9c" stroke-width="2" stroke-linecap="round" data-v-5cc4f846></path></svg></div><div class="welcome-label" data-v-5cc4f846>ä¸Šæ¬¡ç™»å½•æ—¶é—´</div>',2)),e("div",Vs,r(d.lastLoginTime||"--"),1)]),e("div",As,[i[1]||(i[1]=ie('<div class="welcome-icon ip-icon" data-v-5cc4f846><svg width="32" height="32" viewBox="0 0 24 24" fill="none" data-v-5cc4f846><circle cx="12" cy="12" r="10" stroke="#1abc9c" stroke-width="2" data-v-5cc4f846></circle><path d="M12 8a4 4 0 1 1 0 8 4 4 0 0 1 0-8z" stroke="#1abc9c" stroke-width="2" data-v-5cc4f846></path><circle cx="12" cy="12" r="2" fill="#1abc9c" data-v-5cc4f846></circle></svg></div><div class="welcome-label" data-v-5cc4f846>ä¸Šæ¬¡ç™»å½•IP</div>',2)),e("div",Ts,r(d.lastLoginIp||"--"),1)])])]))}},Is=X(Bs,[["__scopeId","data-v-5cc4f846"]]),Ds={class:"menu-manage"},Ps={key:0,class:"loading-overlay"},Ls={class:"menu-header"},Ks={class:"menu-add"},Es=["disabled"],Ws={class:"menu-content"},zs={key:0,class:"empty-state"},Rs={class:"menu-card-header"},Ns={class:"menu-title"},Fs={class:"menu-name"},Os={class:"menu-order"},Hs={class:"menu-actions"},qs=["onClick"],js=["onClick"],Gs=["onClick"],Js={key:0,class:"sub-menu-list"},Qs={class:"sub-menu-name"},Xs={class:"sub-menu-order"},Ys={class:"sub-menu-actions"},Zs=["onClick"],et=["onClick"],st={key:1,class:"no-sub-menu"},tt={key:1,class:"modal-overlay"},lt={class:"modal"},nt={class:"modal-header"},ot={class:"modal-body"},at={class:"form-group"},it={class:"form-group"},rt={class:"modal-footer"},dt=["disabled"],ut={key:2,class:"modal-overlay"},ct={class:"modal"},vt={class:"modal-header"},pt={class:"modal-body"},mt={class:"form-group"},ft={class:"form-group"},gt={class:"modal-footer"},ht=["disabled"],bt={key:3,class:"modal-overlay"},kt={class:"modal"},yt={class:"modal-body"},wt={class:"form-group"},_t={class:"form-group"},Ct={class:"modal-footer"},$t=["disabled"],Mt={__name:"MenuManage",setup(d){const s=$([]),i=$(!1),U=$("åŠ è½½ä¸­..."),t=$(""),f=$(!1),P=$(null),n=$({name:"",order:0}),u=$(!1),h=$(null),_=$(""),k=$({name:"",order:0}),S=$(!1),b=$(null),p=$({name:"",order:0});ne(()=>{c()});function m(){try{window.dispatchEvent(new CustomEvent("nav-menus-updated")),console.log("[æ ç›®ç®¡ç†] å·²é€šçŸ¥æ‰©å±•åˆ·æ–°å³é”®èœå•")}catch(E){console.warn("[æ ç›®ç®¡ç†] é€šçŸ¥æ‰©å±•å¤±è´¥:",E)}}function c(E=!1){return A(this,null,function*(){var w,I;i.value=!0,U.value="åŠ è½½ä¸­...";try{const D=yield xe(!0);s.value=D.data||[],E&&m()}catch(D){alert("åŠ è½½å¤±è´¥: "+(((I=(w=D.response)==null?void 0:w.data)==null?void 0:I.error)||D.message))}finally{i.value=!1}})}function T(){return A(this,null,function*(){var E,w;if(t.value.trim()){i.value=!0,U.value="æ·»åŠ ä¸­...";try{const I=s.value.length?Math.max(...s.value.map(D=>D.order||0)):0;yield Ze({name:t.value.trim(),order:I+1}),t.value="",yield c(!0)}catch(I){alert("æ·»åŠ å¤±è´¥: "+(((w=(E=I.response)==null?void 0:E.data)==null?void 0:w.error)||I.message)),i.value=!1}}})}function x(E){P.value=E,n.value={name:E.name,order:E.order},f.value=!0}function V(){return A(this,null,function*(){var D,g;if(!n.value.name.trim()||!P.value)return;const E=P.value.id,w=n.value.name.trim(),I=n.value.order;R(),i.value=!0,U.value="ä¿å­˜ä¸­...";try{yield ts(E,{name:w,order:I}),yield c(!0)}catch(v){alert("ä¿å­˜å¤±è´¥: "+(((g=(D=v.response)==null?void 0:D.data)==null?void 0:g.error)||v.message)),i.value=!1}})}function H(E){return A(this,null,function*(){var w,I;if(confirm(`ç¡®å®šåˆ é™¤ä¸»èœå•ã€Œ${E.name}ã€å—ï¼Ÿ
å°†åŒæ—¶åˆ é™¤å…¶ä¸‹æ‰€æœ‰å­èœå•å’Œå¡ç‰‡ï¼`)){i.value=!0,U.value="åˆ é™¤ä¸­...";try{yield es(E.id),yield c(!0)}catch(D){alert("åˆ é™¤å¤±è´¥: "+(((I=(w=D.response)==null?void 0:w.data)==null?void 0:I.error)||D.message)),i.value=!1}}})}function Q(E){h.value=E.id,_.value=E.name;const w=E.subMenus||[],I=w.length?Math.max(...w.map(D=>D.order||0)):0;k.value={name:"",order:I+1},u.value=!0}function Z(){return A(this,null,function*(){var D,g;if(!k.value.name.trim()||!h.value)return;const E=h.value,w=k.value.name.trim(),I=k.value.order;R(),i.value=!0,U.value="æ·»åŠ ä¸­...";try{yield ls(E,{name:w,order:I}),yield c(!0)}catch(v){alert("æ·»åŠ å¤±è´¥: "+(((g=(D=v.response)==null?void 0:D.data)==null?void 0:g.error)||v.message)),i.value=!1}})}function ee(E,w){b.value=w,p.value={name:w.name,order:w.order},S.value=!0}function te(){return A(this,null,function*(){var D,g;if(!p.value.name.trim()||!b.value)return;const E=b.value.id,w=p.value.name.trim(),I=p.value.order;R(),i.value=!0,U.value="ä¿å­˜ä¸­...";try{yield ns(E,{name:w,order:I}),yield c(!0)}catch(v){alert("ä¿å­˜å¤±è´¥: "+(((g=(D=v.response)==null?void 0:D.data)==null?void 0:g.error)||v.message)),i.value=!1}})}function se(E){return A(this,null,function*(){var w,I;if(confirm(`ç¡®å®šåˆ é™¤å­èœå•ã€Œ${E.name}ã€å—ï¼Ÿ
å°†åŒæ—¶åˆ é™¤å…¶ä¸‹æ‰€æœ‰å¡ç‰‡ï¼`)){i.value=!0,U.value="åˆ é™¤ä¸­...";try{yield ss(E.id),yield c(!0)}catch(D){alert("åˆ é™¤å¤±è´¥: "+(((I=(w=D.response)==null?void 0:w.data)==null?void 0:I.error)||D.message)),i.value=!1}}})}function R(){f.value=!1,u.value=!1,S.value=!1,P.value=null,b.value=null}return(E,w)=>(o(),a("div",Ds,[i.value?(o(),a("div",Ps,[w[7]||(w[7]=e("div",{class:"loading-spinner"},null,-1)),e("span",null,r(U.value),1)])):B("",!0),e("div",Ls,[w[8]||(w[8]=e("h2",{class:"page-title"},"æ ç›®ç®¡ç†",-1)),e("div",Ks,[C(e("input",{"onUpdate:modelValue":w[0]||(w[0]=I=>t.value=I),placeholder:"è¾“å…¥ä¸»èœå•åç§°",class:"input",onKeyup:Me(T,["enter"])},null,544),[[K,t.value]]),e("button",{class:"btn btn-primary",onClick:T,disabled:i.value||!t.value.trim()}," + æ·»åŠ ä¸»èœå• ",8,Es)])]),e("div",Ws,[s.value.length===0?(o(),a("div",zs,[...w[9]||(w[9]=[e("p",null,"æš‚æ— èœå•ï¼Œè¯·æ·»åŠ ç¬¬ä¸€ä¸ªä¸»èœå•",-1)])])):B("",!0),(o(!0),a(N,null,F(s.value,I=>(o(),a("div",{key:I.id,class:"menu-card"},[e("div",Rs,[e("div",Ns,[e("span",Fs,r(I.name),1),e("span",Os,"æ’åº: "+r(I.order),1)]),e("div",Hs,[e("button",{class:"btn-icon btn-edit",onClick:D=>x(I),title:"ç¼–è¾‘"},[...w[10]||(w[10]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,qs),e("button",{class:"btn-icon btn-add",onClick:D=>Q(I),title:"æ·»åŠ å­èœå•"},[...w[11]||(w[11]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1)])],8,js),e("button",{class:"btn-icon btn-delete",onClick:D=>H(I),title:"åˆ é™¤"},[...w[12]||(w[12]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"})],-1)])],8,Gs)])]),I.subMenus&&I.subMenus.length>0?(o(),a("div",Js,[(o(!0),a(N,null,F(I.subMenus,D=>(o(),a("div",{key:D.id,class:"sub-menu-item"},[e("span",Qs,r(D.name),1),e("span",Xs,"æ’åº: "+r(D.order),1),e("div",Ys,[e("button",{class:"btn-icon-sm btn-edit",onClick:g=>ee(I,D),title:"ç¼–è¾‘"},[...w[13]||(w[13]=[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,Zs),e("button",{class:"btn-icon-sm btn-delete",onClick:g=>se(D),title:"åˆ é™¤"},[...w[14]||(w[14]=[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"})],-1)])],8,et)])]))),128))])):(o(),a("div",st,[...w[15]||(w[15]=[e("span",null,"æš‚æ— å­èœå•",-1)])]))]))),128))]),f.value?(o(),a("div",tt,[e("div",lt,[e("div",nt,[e("h3",null,r(P.value?"ç¼–è¾‘ä¸»èœå•":"æ·»åŠ å­èœå•"),1),e("button",{class:"modal-close",onClick:R},"Ã—")]),e("div",ot,[e("div",at,[w[16]||(w[16]=e("label",null,"åç§°",-1)),C(e("input",{"onUpdate:modelValue":w[1]||(w[1]=I=>n.value.name=I),type:"text",class:"input",placeholder:"è¯·è¾“å…¥åç§°"},null,512),[[K,n.value.name]])]),e("div",it,[w[17]||(w[17]=e("label",null,"æ’åº",-1)),C(e("input",{"onUpdate:modelValue":w[2]||(w[2]=I=>n.value.order=I),type:"number",class:"input",placeholder:"æ•°å­—è¶Šå°è¶Šé å‰"},null,512),[[K,n.value.order,void 0,{number:!0}]])])]),e("div",rt,[e("button",{class:"btn btn-cancel",onClick:R},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:V,disabled:!n.value.name.trim()},"ä¿å­˜",8,dt)])])])):B("",!0),u.value?(o(),a("div",ut,[e("div",ct,[e("div",vt,[e("h3",null,"æ·»åŠ å­èœå•åˆ°ã€Œ"+r(_.value)+"ã€",1),e("button",{class:"modal-close",onClick:R},"Ã—")]),e("div",pt,[e("div",mt,[w[18]||(w[18]=e("label",null,"å­èœå•åç§°",-1)),C(e("input",{"onUpdate:modelValue":w[3]||(w[3]=I=>k.value.name=I),type:"text",class:"input",placeholder:"è¯·è¾“å…¥å­èœå•åç§°"},null,512),[[K,k.value.name]])]),e("div",ft,[w[19]||(w[19]=e("label",null,"æ’åº",-1)),C(e("input",{"onUpdate:modelValue":w[4]||(w[4]=I=>k.value.order=I),type:"number",class:"input",placeholder:"æ•°å­—è¶Šå°è¶Šé å‰"},null,512),[[K,k.value.order,void 0,{number:!0}]])])]),e("div",gt,[e("button",{class:"btn btn-cancel",onClick:R},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:Z,disabled:!k.value.name.trim()},"æ·»åŠ ",8,ht)])])])):B("",!0),S.value?(o(),a("div",bt,[e("div",kt,[e("div",{class:"modal-header"},[w[20]||(w[20]=e("h3",null,"ç¼–è¾‘å­èœå•",-1)),e("button",{class:"modal-close",onClick:R},"Ã—")]),e("div",yt,[e("div",wt,[w[21]||(w[21]=e("label",null,"å­èœå•åç§°",-1)),C(e("input",{"onUpdate:modelValue":w[5]||(w[5]=I=>p.value.name=I),type:"text",class:"input",placeholder:"è¯·è¾“å…¥å­èœå•åç§°"},null,512),[[K,p.value.name]])]),e("div",_t,[w[22]||(w[22]=e("label",null,"æ’åº",-1)),C(e("input",{"onUpdate:modelValue":w[6]||(w[6]=I=>p.value.order=I),type:"number",class:"input",placeholder:"æ•°å­—è¶Šå°è¶Šé å‰"},null,512),[[K,p.value.order,void 0,{number:!0}]])])]),e("div",Ct,[e("button",{class:"btn btn-cancel",onClick:R},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:te,disabled:!p.value.name.trim()},"ä¿å­˜",8,$t)])])])):B("",!0)]))}},xt=X(Mt,[["__scopeId","data-v-7671c3a1"]]),Ut={class:"card-manage"},St={class:"card-header"},Vt={class:"card-add"},At=["value"],Tt=["value"],Bt={class:"card-card"},It={class:"card-table"},Dt=["onUpdate:modelValue","onBlur"],Pt=["onUpdate:modelValue","onBlur"],Lt=["onUpdate:modelValue","onBlur"],Kt=["onUpdate:modelValue","onBlur"],Et=["onClick"],Wt={key:0,class:"selected-tags"},zt={key:1,class:"tag-placeholder"},Rt=["onUpdate:modelValue","onBlur"],Nt=["onClick"],Ft={class:"modal-body"},Ot={key:0,class:"empty-tags"},Ht={key:1,class:"tag-options"},qt=["checked","onChange"],jt={class:"modal-body"},Gt={class:"duplicate-comparison"},Jt={class:"card-info-box existing"},Qt={class:"card-details"},Xt={class:"detail-row"},Yt={class:"detail-value"},Zt={class:"detail-row"},el={class:"detail-value url"},sl={key:0,class:"detail-row"},tl={class:"detail-value url"},ll={class:"card-info-box pending"},nl={class:"card-details"},ol={class:"detail-row"},al={class:"detail-value"},il={class:"detail-row"},rl={class:"detail-value url"},dl={key:0,class:"detail-row"},ul={class:"detail-value url"},cl={__name:"CardManage",setup(d){const s=$([]),i=$([]),U=$(),t=$(""),f=$(""),P=$(""),n=$(""),u=$([]),h=$(!1),_=$(null),k=$([]),S=$(!1),b=$(null),p=$(null),m=ce(()=>{if(!U.value)return[];const g=s.value.find(v=>v.id===U.value);return(g==null?void 0:g.subMenus)||[]});ne(()=>A(null,null,function*(){const g=yield xe();s.value=g.data,s.value.length&&(U.value=s.value[0].id,t.value="");const v=yield Ue();u.value=v.data})),Ae(U,()=>{t.value="",x()}),Ae(t,x);function c(){t.value=""}function T(){x()}function x(){return A(this,null,function*(){if(!U.value)return;const g=yield as(U.value,t.value||null);i.value=g.data})}function V(){return A(this,null,function*(){if(!f.value||!P.value)return;const g=i.value.find(v=>os({title:f.value,url:P.value},v));g?(b.value=g,p.value={menu_id:U.value,sub_menu_id:t.value||null,title:f.value,url:P.value,logo_url:n.value},S.value=!0):yield R({menu_id:U.value,sub_menu_id:t.value||null,title:f.value,url:P.value,logo_url:n.value})})}function H(g){return A(this,null,function*(){yield Be(g.id,{menu_id:U.value,sub_menu_id:t.value||null,title:g.title,url:g.url,logo_url:g.logo_url,desc:g.desc,order:g.order,tagIds:g.tags?g.tags.map(v=>v.id):[]}),x()})}function Q(g){return A(this,null,function*(){if(!confirm("ç¡®å®šè¦åˆ é™¤è¿™å¼ å¡ç‰‡å—ï¼Ÿ"))return;const v=i.value.findIndex(J=>J.id===g);v>-1&&i.value.splice(v,1);try{yield Ie(g)}catch(J){console.error("åˆ é™¤å¡ç‰‡å¤±è´¥:",J),yield x()}})}function Z(g){_.value=g,k.value=g.tags?g.tags.map(v=>v.id):[],h.value=!0}function ee(){h.value=!1,_.value=null,k.value=[]}function te(g){const v=k.value.indexOf(g);v>-1?k.value.splice(v,1):k.value.push(g)}function se(){return A(this,null,function*(){_.value&&(yield Be(_.value.id,{menu_id:_.value.menu_id,sub_menu_id:_.value.sub_menu_id,title:_.value.title,url:_.value.url,logo_url:_.value.logo_url,desc:_.value.desc,order:_.value.order,tagIds:k.value}),ee(),x())})}function R(g){return A(this,null,function*(){yield is(g),f.value="",P.value="",n.value="",x()})}function E(){S.value=!1,b.value=null,p.value=null}function w(){E(),f.value="",P.value="",n.value=""}function I(){return A(this,null,function*(){!p.value||!b.value||(yield Ie(b.value.id),yield R(p.value),E())})}function D(){p.value&&(f.value=p.value.title,P.value=p.value.url,n.value=p.value.logo_url||"",E(),alert("è¯·ä¿®æ”¹å¡ç‰‡ä¿¡æ¯åå†æ¬¡ç‚¹å‡»â€œæ·»åŠ å¡ç‰‡â€æŒ‰é’®"))}return(g,v)=>{var J,me,fe,ge,he,Y,be,ke;return o(),a("div",Ut,[e("div",St,[v[9]||(v[9]=e("div",{class:"header-content"},[e("h2",{class:"page-title"},"ç®¡ç†ç½‘ç«™å¯¼èˆªå¡ç‰‡ï¼Œæ”¯æŒä¸»èœå•å’Œå­èœå•åˆ†ç±»")],-1)),e("div",Vt,[C(e("select",{"onUpdate:modelValue":v[0]||(v[0]=L=>U.value=L),class:"input narrow",onChange:c},[(o(!0),a(N,null,F(s.value,L=>(o(),a("option",{value:L.id,key:L.id},r(L.name),9,At))),128))],544),[[ae,U.value]]),C(e("select",{"onUpdate:modelValue":v[1]||(v[1]=L=>t.value=L),class:"input narrow",onChange:T},[v[7]||(v[7]=e("option",{value:""},"ä¸»èœå•",-1)),(o(!0),a(N,null,F(m.value,L=>(o(),a("option",{value:L.id,key:L.id},r(L.name),9,Tt))),128))],544),[[ae,t.value]]),C(e("input",{"onUpdate:modelValue":v[2]||(v[2]=L=>f.value=L),placeholder:"å¡ç‰‡æ ‡é¢˜",class:"input narrow"},null,512),[[K,f.value]]),C(e("input",{"onUpdate:modelValue":v[3]||(v[3]=L=>P.value=L),placeholder:"å¡ç‰‡é“¾æ¥",class:"input wide"},null,512),[[K,P.value]]),C(e("input",{"onUpdate:modelValue":v[4]||(v[4]=L=>n.value=L),placeholder:"logoé“¾æ¥(å¯é€‰)",class:"input wide"},null,512),[[K,n.value]]),e("button",{class:"btn",onClick:V},[...v[8]||(v[8]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),W(" æ·»åŠ å¡ç‰‡ ",-1)])])])]),e("div",Bt,[e("table",It,[v[11]||(v[11]=e("thead",null,[e("tr",null,[e("th",null,"æ ‡é¢˜"),e("th",null,"ç½‘å€"),e("th",null,"Logoé“¾æ¥"),e("th",null,"æè¿°"),e("th",null,"æ ‡ç­¾"),e("th",null,"æ’åº"),e("th",null,"æ“ä½œ")])],-1)),e("tbody",null,[(o(!0),a(N,null,F(i.value,L=>(o(),a("tr",{key:L.id},[e("td",null,[C(e("input",{"onUpdate:modelValue":O=>L.title=O,onBlur:O=>H(L),class:"table-input"},null,40,Dt),[[K,L.title]])]),e("td",null,[C(e("input",{"onUpdate:modelValue":O=>L.url=O,onBlur:O=>H(L),class:"table-input"},null,40,Pt),[[K,L.url]])]),e("td",null,[C(e("input",{"onUpdate:modelValue":O=>L.logo_url=O,onBlur:O=>H(L),class:"table-input",placeholder:"logoé“¾æ¥(å¯é€‰)"},null,40,Lt),[[K,L.logo_url]])]),e("td",null,[C(e("input",{"onUpdate:modelValue":O=>L.desc=O,onBlur:O=>H(L),class:"table-input",placeholder:"æè¿°ï¼ˆå¯é€‰ï¼‰"},null,40,Kt),[[K,L.desc]])]),e("td",null,[e("div",{class:"tag-selector",onClick:O=>Z(L)},[L.tags&&L.tags.length>0?(o(),a("div",Wt,[(o(!0),a(N,null,F(L.tags,O=>(o(),a("span",{key:O.id,class:"mini-tag",style:pe({backgroundColor:O.color})},r(O.name),5))),128))])):(o(),a("span",zt,"é€‰æ‹©æ ‡ç­¾"))],8,Et)]),e("td",null,[C(e("input",{"onUpdate:modelValue":O=>L.order=O,type:"number",onBlur:O=>H(L),class:"table-input order-input"},null,40,Rt),[[K,L.order,void 0,{number:!0}]])]),e("td",null,[e("button",{class:"btn btn-danger btn-icon",onClick:O=>Q(L.id),title:"åˆ é™¤"},[...v[10]||(v[10]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)])],8,Nt)])]))),128))])])]),h.value?(o(),a("div",{key:0,class:"modal-overlay",onClick:ee},[e("div",{class:"modal-content",onClick:v[5]||(v[5]=we(()=>{},["stop"]))},[e("div",{class:"modal-header"},[v[12]||(v[12]=e("h3",null,"é€‰æ‹©æ ‡ç­¾",-1)),e("button",{class:"close-btn",onClick:ee},"Ã—")]),e("div",Ft,[u.value.length===0?(o(),a("div",Ot,[...v[13]||(v[13]=[e("p",null,"æš‚æ— æ ‡ç­¾ï¼Œè¯·å…ˆåœ¨æ ‡ç­¾ç®¡ç†é¡µé¢åˆ›å»º",-1)])])):(o(),a("div",Ht,[(o(!0),a(N,null,F(u.value,L=>(o(),a("label",{key:L.id,class:"tag-option"},[e("input",{type:"checkbox",checked:k.value.includes(L.id),onChange:O=>te(L.id)},null,40,qt),e("span",{class:"tag-label",style:pe({backgroundColor:L.color})},r(L.name),5)]))),128))]))]),e("div",{class:"modal-footer"},[e("button",{class:"btn btn-secondary",onClick:ee},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:se},"ç¡®å®š")])])])):B("",!0),S.value?(o(),a("div",{key:1,class:"modal-overlay",onClick:E},[e("div",{class:"modal-content duplicate-modal",onClick:v[6]||(v[6]=we(()=>{},["stop"]))},[e("div",{class:"modal-header"},[v[14]||(v[14]=ie('<div class="header-with-icon" data-v-edd548d5><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#dc2626" stroke-width="2" data-v-edd548d5><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z" data-v-edd548d5></path><line x1="12" y1="9" x2="12" y2="13" data-v-edd548d5></line><line x1="12" y1="17" x2="12.01" y2="17" data-v-edd548d5></line></svg><h3 data-v-edd548d5>æ£€æµ‹åˆ°é‡å¤å¡ç‰‡</h3></div>',1)),e("button",{class:"close-btn",onClick:E},"Ã—")]),e("div",jt,[v[24]||(v[24]=e("div",{class:"duplicate-warning"},[e("p",{class:"warning-text"},"æ‚¨è¦æ·»åŠ çš„å¡ç‰‡ä¸ä»¥ä¸‹ç°æœ‰å¡ç‰‡é‡å¤ï¼š")],-1)),e("div",Gt,[e("div",Jt,[v[18]||(v[18]=e("div",{class:"box-header"},[e("span",{class:"box-label"},"ç°æœ‰å¡ç‰‡")],-1)),e("div",Qt,[e("div",Xt,[v[15]||(v[15]=e("span",{class:"detail-label"},"æ ‡é¢˜ï¼š",-1)),e("span",Yt,r((J=b.value)==null?void 0:J.title),1)]),e("div",Zt,[v[16]||(v[16]=e("span",{class:"detail-label"},"ç½‘å€ï¼š",-1)),e("span",el,r((me=b.value)==null?void 0:me.url),1)]),(fe=b.value)!=null&&fe.logo_url?(o(),a("div",sl,[v[17]||(v[17]=e("span",{class:"detail-label"},"Logoï¼š",-1)),e("span",tl,r((ge=b.value)==null?void 0:ge.logo_url),1)])):B("",!0)])]),v[23]||(v[23]=e("div",{class:"arrow-divider"},[e("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"#9ca3af","stroke-width":"2"},[e("path",{d:"M5 12h14M12 5l7 7-7 7"})])],-1)),e("div",ll,[v[22]||(v[22]=e("div",{class:"box-header"},[e("span",{class:"box-label"},"å¾…æ·»åŠ å¡ç‰‡")],-1)),e("div",nl,[e("div",ol,[v[19]||(v[19]=e("span",{class:"detail-label"},"æ ‡é¢˜ï¼š",-1)),e("span",al,r((he=p.value)==null?void 0:he.title),1)]),e("div",il,[v[20]||(v[20]=e("span",{class:"detail-label"},"ç½‘å€ï¼š",-1)),e("span",rl,r((Y=p.value)==null?void 0:Y.url),1)]),(be=p.value)!=null&&be.logo_url?(o(),a("div",dl,[v[21]||(v[21]=e("span",{class:"detail-label"},"Logoï¼š",-1)),e("span",ul,r((ke=p.value)==null?void 0:ke.logo_url),1)])):B("",!0)])])]),v[25]||(v[25]=e("div",{class:"duplicate-actions-info"},[e("p",null,"è¯·é€‰æ‹©å¦‚ä½•å¤„ç†ï¼š")],-1))]),e("div",{class:"modal-footer duplicate-footer"},[e("button",{class:"btn btn-secondary",onClick:w},[...v[26]||(v[26]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M18 6L6 18M6 6l12 12"})],-1),W(" è·³è¿‡ ",-1)])]),e("button",{class:"btn btn-warning",onClick:I},[...v[27]||(v[27]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 12a9 9 0 11-9-9c2.52 0 4.93 1 6.74 2.74L21 8"}),e("path",{d:"M21 3v5h-5"})],-1),W(" æ›¿æ¢ ",-1)])]),e("button",{class:"btn btn-primary",onClick:D},[...v[28]||(v[28]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1),W(" ç¼–è¾‘åæ·»åŠ  ",-1)])])])])])):B("",!0)])}}},vl=X(cl,[["__scopeId","data-v-edd548d5"]]),pl={class:"duplicate-manage"},ml={class:"section-header"},fl=["disabled"],gl={key:0,class:"duplicate-results"},hl={class:"result-summary"},bl={class:"summary-card"},kl={class:"summary-value"},yl={class:"summary-card warning"},wl={class:"summary-value"},_l={class:"summary-card danger"},Cl={class:"summary-value"},$l={class:"duplicate-groups"},Ml={class:"group-header"},xl={class:"group-count"},Ul={class:"card-item original"},Sl={class:"card-info"},Vl={class:"card-title"},Al={class:"card-url"},Tl={key:0,class:"card-desc"},Bl={class:"card-id"},Il={class:"duplicates-list"},Dl={class:"card-info"},Pl={class:"card-title"},Ll={class:"card-url"},Kl={key:0,class:"card-desc"},El={class:"card-actions"},Wl={class:"card-id"},zl=["onClick","disabled"],Rl={class:"group-actions"},Nl=["onClick","disabled"],Fl={class:"global-actions"},Ol=["disabled"],Hl={key:1,class:"no-duplicates"},ql={key:2,class:"initial-hint"},jl={key:3,class:"error"},Gl={__name:"DuplicateManage",setup(d){const s=$(!1),i=$(!1),U=$(!1),t=$([]),f=$(0),P=$(0),n=$("");function u(){return A(this,null,function*(){var S,b;s.value=!0,n.value="";try{const p=yield rs();f.value=p.data.total,t.value=p.data.duplicateGroups,P.value=p.data.duplicateCount,U.value=!0}catch(p){n.value=((b=(S=p.response)==null?void 0:S.data)==null?void 0:b.error)||"æ£€æµ‹å¤±è´¥",console.error("æ£€æµ‹é‡å¤å¤±è´¥:",p)}finally{s.value=!1}})}function h(S){return A(this,null,function*(){var b,p,m;if(confirm("ç¡®å®šè¦åˆ é™¤è¿™å¼ å¡ç‰‡å—ï¼Ÿ")){i.value=!0,n.value="";try{console.log("[å»é‡ç®¡ç†] åˆ é™¤å•ä¸ªå¡ç‰‡:",S);const c=yield Ce([S]);console.log("[å»é‡ç®¡ç†] åˆ é™¤å“åº”:",c.data),c.data.success?(console.log("[å»é‡ç®¡ç†] åˆ é™¤æˆåŠŸï¼Œé‡æ–°æ£€æµ‹..."),yield u()):n.value="åˆ é™¤å¤±è´¥ï¼š"+(c.data.message||"æœªçŸ¥é”™è¯¯")}catch(c){console.error("[å»é‡ç®¡ç†] åˆ é™¤å¡ç‰‡å¤±è´¥:",c),console.error("[å»é‡ç®¡ç†] é”™è¯¯è¯¦æƒ…:",(b=c.response)==null?void 0:b.data),n.value=((m=(p=c.response)==null?void 0:p.data)==null?void 0:m.error)||c.message||"åˆ é™¤å¤±è´¥"}finally{i.value=!1}}})}function _(S){return A(this,null,function*(){var p,m,c;const b=S.duplicates.length;if(confirm(`ç¡®å®šè¦åˆ é™¤è¿™ ${b} å¼ é‡å¤å¡ç‰‡å—ï¼Ÿ

å°†ä¿ç•™ï¼š${S.original.title}`)){i.value=!0,n.value="";try{const T=S.duplicates.map(V=>V.id);console.log("[å»é‡ç®¡ç†] åˆ é™¤ä¸€ç»„é‡å¤å¡ç‰‡:",T);const x=yield Ce(T);console.log("[å»é‡ç®¡ç†] åˆ é™¤å“åº”:",x.data),x.data.success?(console.log("[å»é‡ç®¡ç†] åˆ é™¤æˆåŠŸï¼Œé‡æ–°æ£€æµ‹..."),yield u()):n.value="åˆ é™¤å¤±è´¥ï¼š"+(x.data.message||"æœªçŸ¥é”™è¯¯")}catch(T){console.error("[å»é‡ç®¡ç†] åˆ é™¤é‡å¤å¡ç‰‡å¤±è´¥:",T),console.error("[å»é‡ç®¡ç†] é”™è¯¯è¯¦æƒ…:",(p=T.response)==null?void 0:p.data),n.value=((c=(m=T.response)==null?void 0:m.data)==null?void 0:c.error)||T.message||"åˆ é™¤å¤±è´¥"}finally{i.value=!1}}})}function k(){return A(this,null,function*(){var b,p,m;const S=P.value;if(confirm(`ç¡®å®šè¦åˆ é™¤æ‰€æœ‰ ${S} å¼ é‡å¤å¡ç‰‡å—ï¼Ÿ

æ­¤æ“ä½œä¸å¯æ’¤é”€ï¼`)){i.value=!0,n.value="";try{const c=t.value.flatMap(x=>x.duplicates.map(V=>V.id));console.log("[å»é‡ç®¡ç†] åˆ é™¤æ‰€æœ‰é‡å¤å¡ç‰‡:",c);const T=yield Ce(c);console.log("[å»é‡ç®¡ç†] åˆ é™¤å“åº”:",T.data),T.data.success?(console.log("[å»é‡ç®¡ç†] åˆ é™¤æˆåŠŸï¼Œé‡æ–°æ£€æµ‹..."),yield u()):n.value="åˆ é™¤å¤±è´¥ï¼š"+(T.data.message||"æœªçŸ¥é”™è¯¯")}catch(c){console.error("[å»é‡ç®¡ç†] åˆ é™¤æ‰€æœ‰é‡å¤å¤±è´¥:",c),console.error("[å»é‡ç®¡ç†] é”™è¯¯è¯¦æƒ…:",(b=c.response)==null?void 0:b.data),n.value=((m=(p=c.response)==null?void 0:p.data)==null?void 0:m.error)||c.message||"åˆ é™¤å¤±è´¥"}finally{i.value=!1}}})}return(S,b)=>(o(),a("div",pl,[e("div",ml,[b[0]||(b[0]=e("h3",null,"å¡ç‰‡å»é‡ç®¡ç†",-1)),e("button",{onClick:u,class:"btn btn-primary",disabled:s.value},r(s.value?"æ£€æµ‹ä¸­...":"ğŸ” ä¸€é”®æ£€æµ‹é‡å¤"),9,fl)]),t.value.length>0?(o(),a("div",gl,[e("div",hl,[e("div",bl,[b[1]||(b[1]=e("div",{class:"summary-label"},"æ€»å¡ç‰‡æ•°",-1)),e("div",kl,r(f.value),1)]),e("div",yl,[b[2]||(b[2]=e("div",{class:"summary-label"},"é‡å¤ç»„æ•°",-1)),e("div",wl,r(t.value.length),1)]),e("div",_l,[b[3]||(b[3]=e("div",{class:"summary-label"},"é‡å¤å¡ç‰‡",-1)),e("div",Cl,r(P.value),1)])]),e("div",$l,[(o(!0),a(N,null,F(t.value,(p,m)=>(o(),a("div",{key:m,class:"duplicate-group"},[e("div",Ml,[e("h4",null,"é‡å¤ç»„ "+r(m+1),1),e("span",xl,r(p.totalCount)+" å¼ å¡ç‰‡",1)]),e("div",Ul,[b[4]||(b[4]=e("div",{class:"card-badge"},"ä¿ç•™",-1)),e("div",Sl,[e("div",Vl,r(p.original.title),1),e("div",Al,r(p.original.url),1),p.original.desc?(o(),a("div",Tl,r(p.original.desc),1)):B("",!0)]),e("div",Bl,"ID: "+r(p.original.id),1)]),e("div",Il,[(o(!0),a(N,null,F(p.duplicates,c=>(o(),a("div",{key:c.id,class:"card-item duplicate"},[b[5]||(b[5]=e("div",{class:"card-badge danger"},"é‡å¤",-1)),e("div",Dl,[e("div",Pl,r(c.title),1),e("div",Ll,r(c.url),1),c.desc?(o(),a("div",Kl,r(c.desc),1)):B("",!0)]),e("div",El,[e("span",Wl,"ID: "+r(c.id),1),e("button",{onClick:T=>h(c.id),class:"btn-remove",disabled:i.value,title:"åˆ é™¤æ­¤å¡ç‰‡"}," åˆ é™¤ ",8,zl)])]))),128))]),e("div",Rl,[e("button",{onClick:c=>_(p),class:"btn btn-danger",disabled:i.value}," åˆ é™¤æ­¤ç»„æ‰€æœ‰é‡å¤å¡ç‰‡ ("+r(p.duplicates.length)+" å¼ ) ",9,Nl)])]))),128))]),e("div",Fl,[e("button",{onClick:k,class:"btn btn-danger btn-large",disabled:i.value},r(i.value?"åˆ é™¤ä¸­...":`åˆ é™¤æ‰€æœ‰é‡å¤å¡ç‰‡ (${P.value} å¼ )`),9,Ol)])])):U.value&&t.value.length===0?(o(),a("div",Hl,[...b[6]||(b[6]=[e("svg",{width:"80",height:"80",viewBox:"0 0 24 24",fill:"none",stroke:"#1abc9c","stroke-width":"2"},[e("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e("polyline",{points:"22 4 12 14.01 9 11.01"})],-1),e("h3",null,"å¤ªæ£’äº†ï¼æ²¡æœ‰å‘ç°é‡å¤å¡ç‰‡",-1),e("p",null,"æ‚¨çš„å¯¼èˆªå¡ç‰‡éƒ½æ˜¯å”¯ä¸€çš„",-1)])])):U.value?B("",!0):(o(),a("div",ql,[...b[7]||(b[7]=[ie('<svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="#666" stroke-width="2" data-v-62bbc778><circle cx="12" cy="12" r="10" data-v-62bbc778></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" data-v-62bbc778></path><line x1="12" y1="17" x2="12.01" y2="17" data-v-62bbc778></line></svg><h3 data-v-62bbc778>ç‚¹å‡»&quot;ä¸€é”®æ£€æµ‹é‡å¤&quot;å¼€å§‹æ‰«æ</h3><p data-v-62bbc778>ç³»ç»Ÿå°†æ£€æµ‹æ‰€æœ‰é‡å¤çš„å¯¼èˆªå¡ç‰‡</p><ul class="hint-list" data-v-62bbc778><li data-v-62bbc778>ğŸ“Œ URL ç›¸åŒçš„å¡ç‰‡</li><li data-v-62bbc778>ğŸ“Œ æ ‡é¢˜ç›¸åŒä¸”åŸŸåç›¸åŒçš„å¡ç‰‡</li></ul>',4)])])),n.value?(o(),a("p",jl,r(n.value),1)):B("",!0)]))}},Jl=X(Gl,[["__scopeId","data-v-62bbc778"]]),Ql={class:"tag-manage"},Xl={class:"tag-header"},Yl={class:"tag-add"},Zl={class:"tag-content"},en={key:0,class:"empty-state"},sn={key:1,class:"tag-list"},tn={class:"tag-info"},ln=["onUpdate:modelValue","onBlur"],nn={class:"tag-stats"},on={class:"card-count"},an={class:"tag-controls"},rn=["onUpdate:modelValue","onChange"],dn={class:"tag-order"},un=["onUpdate:modelValue","onBlur"],cn={class:"tag-actions"},vn=["onClick"],pn={__name:"TagManage",setup(d){const s=$([]),i=$(""),U=$("#2566d8");ne(t);function t(){return A(this,null,function*(){const u=yield Ue();s.value=u.data;for(const h of s.value)try{const _=yield ds(h.id);h.cardCount=_.data.count}catch(_){h.cardCount=0}})}function f(){return A(this,null,function*(){var S,b;if(!i.value.trim())return;const u=s.value.length?Math.max(...s.value.map(p=>p.order||0)):0,h=i.value.trim(),_=U.value,k={id:Date.now(),name:h,color:_,order:u+1,cardCount:0,_temp:!0};s.value.push(k),i.value="",U.value="#2566d8";try{const p=yield us({name:h,color:_,order:u+1}),m=s.value.findIndex(c=>c.id===k.id);m>-1&&(s.value[m]=re(le({},p.data),{cardCount:0}))}catch(p){const m=s.value.findIndex(c=>c.id===k.id);m>-1&&s.value.splice(m,1),alert("æ·»åŠ æ ‡ç­¾å¤±è´¥ï¼š"+(((b=(S=p.response)==null?void 0:S.data)==null?void 0:b.error)||p.message))}})}function P(u){return A(this,null,function*(){var h,_;if(!u._temp)try{yield cs(u.id,{name:u.name,color:u.color,order:u.order})}catch(k){alert("æ›´æ–°æ ‡ç­¾å¤±è´¥ï¼š"+(((_=(h=k.response)==null?void 0:h.data)==null?void 0:_.error)||k.message)),t()}})}function n(u){return A(this,null,function*(){var S,b;const h=s.value.find(p=>p.id===u);if(!h)return;const _=h.cardCount>0?`ç¡®å®šè¦åˆ é™¤æ ‡ç­¾"${h.name}"å—ï¼Ÿè¿™å°†å–æ¶ˆ ${h.cardCount} å¼ å¡ç‰‡çš„å…³è”ã€‚`:`ç¡®å®šè¦åˆ é™¤æ ‡ç­¾"${h.name}"å—ï¼Ÿ`;if(!confirm(_))return;const k=s.value.findIndex(p=>p.id===u);k>-1&&s.value.splice(k,1);try{yield vs(u)}catch(p){alert("åˆ é™¤æ ‡ç­¾å¤±è´¥ï¼š"+(((b=(S=p.response)==null?void 0:S.data)==null?void 0:b.error)||p.message)),t()}})}return(u,h)=>(o(),a("div",Ql,[e("div",Xl,[h[3]||(h[3]=e("div",{class:"header-content"},[e("h2",{class:"page-title"},"ç®¡ç†æ ‡ç­¾"),e("p",{class:"page-desc"},"ä¸ºå¡ç‰‡åˆ›å»ºå¤šç»´åº¦åˆ†ç±»æ ‡ç­¾")],-1)),e("div",Yl,[C(e("input",{"onUpdate:modelValue":h[0]||(h[0]=_=>i.value=_),placeholder:"æ ‡ç­¾åç§°",class:"input",maxlength:"20"},null,512),[[K,i.value]]),C(e("input",{"onUpdate:modelValue":h[1]||(h[1]=_=>U.value=_),type:"color",class:"color-input",title:"é€‰æ‹©æ ‡ç­¾é¢œè‰²"},null,512),[[K,U.value]]),e("button",{class:"btn btn-primary",onClick:f},[...h[2]||(h[2]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),W(" æ·»åŠ æ ‡ç­¾ ",-1)])])])]),e("div",Zl,[s.value.length===0?(o(),a("div",en,[...h[4]||(h[4]=[e("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1"},[e("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"}),e("line",{x1:"7",y1:"7",x2:"7.01",y2:"7"})],-1),e("p",null,"æš‚æ— æ ‡ç­¾",-1),e("p",{class:"hint"},"åˆ›å»ºç¬¬ä¸€ä¸ªæ ‡ç­¾ï¼Œå¼€å§‹ä¸ºå¡ç‰‡æ·»åŠ å¤šç»´åº¦åˆ†ç±»",-1)])])):(o(),a("div",sn,[(o(!0),a(N,null,F(s.value,_=>(o(),a("div",{key:_.id,class:"tag-item"},[e("div",{class:"tag-preview",style:pe({backgroundColor:_.color})},[...h[5]||(h[5]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"}),e("line",{x1:"7",y1:"7",x2:"7.01",y2:"7"})],-1)])],4),e("div",tn,[C(e("input",{"onUpdate:modelValue":k=>_.name=k,onBlur:k=>P(_),class:"tag-name-input",maxlength:"20"},null,40,ln),[[K,_.name]]),e("div",nn,[e("span",on,r(_.cardCount||0)+" å¼ å¡ç‰‡",1)])]),e("div",an,[C(e("input",{"onUpdate:modelValue":k=>_.color=k,type:"color",onChange:k=>P(_),class:"color-picker",title:"æ›´æ”¹é¢œè‰²"},null,40,rn),[[K,_.color]]),e("div",dn,[h[6]||(h[6]=e("span",{class:"order-label"},"æ’åº",-1)),C(e("input",{"onUpdate:modelValue":k=>_.order=k,type:"number",onBlur:k=>P(_),class:"order-input"},null,40,un),[[K,_.order,void 0,{number:!0}]])])]),e("div",cn,[e("button",{class:"btn btn-danger btn-icon",onClick:k=>n(_.id),title:"åˆ é™¤æ ‡ç­¾"},[...h[7]||(h[7]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)])],8,vn)])]))),128))]))])]))}},mn=X(pn,[["__scopeId","data-v-56efcb56"]]),fn={class:"promo-manage"},gn={key:0,class:"loading-overlay"},hn={class:"promo-header"},bn={class:"promo-form"},kn=["disabled"],yn={class:"promo-section"},wn={class:"promo-list"},_n={key:0,class:"empty-state"},Cn={class:"promo-preview"},$n=["src"],Mn={class:"promo-info"},xn={class:"promo-field"},Un=["onUpdate:modelValue","onBlur"],Sn={class:"promo-field"},Vn=["onUpdate:modelValue","onBlur"],An={class:"promo-actions"},Tn=["onClick"],Bn={class:"promo-section"},In={class:"promo-list"},Dn={key:0,class:"empty-state"},Pn={class:"promo-preview"},Ln=["src"],Kn={class:"promo-info"},En={class:"promo-field"},Wn=["onUpdate:modelValue","onBlur"],zn={class:"promo-field"},Rn=["onUpdate:modelValue","onBlur"],Nn={class:"promo-actions"},Fn=["onClick"],ye="/api",On={__name:"PromoManage",setup(d){const s=()=>localStorage.getItem("token")||"",i=()=>({Authorization:`Bearer ${s()}`}),U=$([]),t=$(!1),f=$("åŠ è½½ä¸­..."),P=$({img:"",url:"",position:"left"}),n=ce(()=>U.value.filter(p=>p.position==="left")),u=ce(()=>U.value.filter(p=>p.position==="right"));ne(()=>{h()});function h(){return A(this,null,function*(){var p,m;t.value=!0,f.value="åŠ è½½ä¸­...";try{const c=yield ue.get(`${ye}/promos`);let T=[];Array.isArray(c.data)?T=c.data:c.data&&Array.isArray(c.data.data)&&(T=c.data.data),U.value=T}catch(c){console.error("åŠ è½½å®£ä¼ å¤±è´¥:",c),alert("åŠ è½½å®£ä¼ å¤±è´¥: "+(((m=(p=c.response)==null?void 0:p.data)==null?void 0:m.error)||c.message))}finally{t.value=!1}})}function _(){return A(this,null,function*(){var p,m;if(!P.value.img||!P.value.url){alert("è¯·å¡«å†™å®£ä¼ å›¾ç‰‡é“¾æ¥å’Œè·³è½¬é“¾æ¥");return}t.value=!0,f.value="æ·»åŠ ä¸­...";try{yield ue.post(`${ye}/promos`,P.value,{headers:i()}),P.value={img:"",url:"",position:"left"},yield h()}catch(c){alert("æ·»åŠ å¤±è´¥: "+(((m=(p=c.response)==null?void 0:p.data)==null?void 0:m.error)||c.message)),t.value=!1}})}function k(p){return A(this,null,function*(){var m,c;try{yield ue.put(`${ye}/promos/${p.id}`,{img:p.img,url:p.url},{headers:i()})}catch(T){alert("æ›´æ–°å¤±è´¥: "+(((c=(m=T.response)==null?void 0:m.data)==null?void 0:c.error)||T.message)),yield h()}})}function S(p){return A(this,null,function*(){var m,c;if(confirm("ç¡®å®šåˆ é™¤è¿™ä¸ªå®£ä¼ å—ï¼Ÿ")){t.value=!0,f.value="åˆ é™¤ä¸­...";try{yield ue.delete(`${ye}/promos/${p.id}`,{headers:i()}),yield h()}catch(T){alert("åˆ é™¤å¤±è´¥: "+(((c=(m=T.response)==null?void 0:m.data)==null?void 0:c.error)||T.message)),t.value=!1}}})}function b(p){p.target.src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="60"><rect fill="%23f0f0f0" width="100" height="60"/><text x="50" y="35" text-anchor="middle" fill="%23999" font-size="12">å›¾ç‰‡åŠ è½½å¤±è´¥</text></svg>'}return(p,m)=>(o(),a("div",fn,[t.value?(o(),a("div",gn,[m[3]||(m[3]=e("div",{class:"loading-spinner"},null,-1)),e("span",null,r(f.value),1)])):B("",!0),e("div",hn,[m[5]||(m[5]=e("h2",{class:"page-title"},"å®£ä¼ ç®¡ç†",-1)),e("div",bn,[C(e("input",{"onUpdate:modelValue":m[0]||(m[0]=c=>P.value.img=c),placeholder:"å®£ä¼ å›¾ç‰‡é“¾æ¥",class:"input"},null,512),[[K,P.value.img]]),C(e("input",{"onUpdate:modelValue":m[1]||(m[1]=c=>P.value.url=c),placeholder:"å®£ä¼ è·³è½¬é“¾æ¥",class:"input"},null,512),[[K,P.value.url]]),C(e("select",{"onUpdate:modelValue":m[2]||(m[2]=c=>P.value.position=c),class:"input select"},[...m[4]||(m[4]=[e("option",{value:"left"},"å·¦ä¾§å®£ä¼ ",-1),e("option",{value:"right"},"å³ä¾§å®£ä¼ ",-1)])],512),[[ae,P.value.position]]),e("button",{class:"btn btn-primary",onClick:_,disabled:!P.value.img||!P.value.url}," + æ·»åŠ å®£ä¼  ",8,kn)])]),e("div",yn,[m[8]||(m[8]=e("h3",{class:"section-title"},"ğŸ“ å·¦ä¾§å®£ä¼ ",-1)),e("div",wn,[n.value.length===0?(o(),a("div",_n,"æš‚æ— å·¦ä¾§å®£ä¼ ")):B("",!0),(o(!0),a(N,null,F(n.value,c=>(o(),a("div",{key:c.id,class:"promo-card"},[e("div",Cn,[e("img",{src:c.img,alt:"å®£ä¼ å›¾ç‰‡",onError:b},null,40,$n)]),e("div",Mn,[e("div",xn,[m[6]||(m[6]=e("label",null,"å›¾ç‰‡é“¾æ¥",-1)),C(e("input",{"onUpdate:modelValue":T=>c.img=T,class:"input",onBlur:T=>k(c)},null,40,Un),[[K,c.img]])]),e("div",Sn,[m[7]||(m[7]=e("label",null,"è·³è½¬é“¾æ¥",-1)),C(e("input",{"onUpdate:modelValue":T=>c.url=T,class:"input",onBlur:T=>k(c)},null,40,Vn),[[K,c.url]])])]),e("div",An,[e("button",{class:"btn btn-danger",onClick:T=>S(c)},"åˆ é™¤",8,Tn)])]))),128))])]),e("div",Bn,[m[11]||(m[11]=e("h3",{class:"section-title"},"ğŸ“ å³ä¾§å®£ä¼ ",-1)),e("div",In,[u.value.length===0?(o(),a("div",Dn,"æš‚æ— å³ä¾§å®£ä¼ ")):B("",!0),(o(!0),a(N,null,F(u.value,c=>(o(),a("div",{key:c.id,class:"promo-card"},[e("div",Pn,[e("img",{src:c.img,alt:"å®£ä¼ å›¾ç‰‡",onError:b},null,40,Ln)]),e("div",Kn,[e("div",En,[m[9]||(m[9]=e("label",null,"å›¾ç‰‡é“¾æ¥",-1)),C(e("input",{"onUpdate:modelValue":T=>c.img=T,class:"input",onBlur:T=>k(c)},null,40,Wn),[[K,c.img]])]),e("div",zn,[m[10]||(m[10]=e("label",null,"è·³è½¬é“¾æ¥",-1)),C(e("input",{"onUpdate:modelValue":T=>c.url=T,class:"input",onBlur:T=>k(c)},null,40,Rn),[[K,c.url]])])]),e("div",Nn,[e("button",{class:"btn btn-danger",onClick:T=>S(c)},"åˆ é™¤",8,Fn)])]))),128))])])]))}},Hn=X(On,[["__scopeId","data-v-0221fbc3"]]),qn={class:"friend-manage"},jn={class:"friend-add"},Gn={class:"friend-card"},Jn={class:"friend-table"},Qn=["onUpdate:modelValue","onBlur"],Xn=["onUpdate:modelValue","onBlur"],Yn=["onUpdate:modelValue","onBlur"],Zn=["onClick"],eo={__name:"FriendLinkManage",setup(d){const s=$([]),i=$(""),U=$(""),t=$("");ne(f);function f(){return A(this,null,function*(){const h=yield ps();s.value=h.data})}function P(){return A(this,null,function*(){!i.value||!U.value||(yield ms({title:i.value,url:U.value,logo:t.value}),i.value="",U.value="",t.value="",f())})}function n(h){return A(this,null,function*(){yield fs(h.id,{title:h.title,url:h.url,logo:h.logo}),f()})}function u(h){return A(this,null,function*(){if(!confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå‹é“¾å—ï¼Ÿ"))return;const _=s.value.findIndex(k=>k.id===h);_>-1&&s.value.splice(_,1);try{yield gs(h)}catch(k){console.error("åˆ é™¤å‹é“¾å¤±è´¥:",k),yield f()}})}return(h,_)=>(o(),a("div",qn,[_[4]||(_[4]=e("div",{class:"friend-header"},null,-1)),e("div",jn,[C(e("input",{"onUpdate:modelValue":_[0]||(_[0]=k=>i.value=k),placeholder:"ç½‘ç«™å",class:"input"},null,512),[[K,i.value]]),C(e("input",{"onUpdate:modelValue":_[1]||(_[1]=k=>U.value=k),placeholder:"ç½‘ç«™é“¾æ¥",class:"input"},null,512),[[K,U.value]]),C(e("input",{"onUpdate:modelValue":_[2]||(_[2]=k=>t.value=k),placeholder:"logoé“¾æ¥(å¯é€‰)",class:"input"},null,512),[[K,t.value]]),e("button",{class:"btn",onClick:P},"æ·»åŠ å‹é“¾")]),e("div",Gn,[e("table",Jn,[_[3]||(_[3]=e("thead",null,[e("tr",null,[e("th",null,"ç½‘ç«™å"),e("th",null,"é“¾æ¥"),e("th",null,"Logo"),e("th",null,"æ“ä½œ")])],-1)),e("tbody",null,[(o(!0),a(N,null,F(s.value,k=>(o(),a("tr",{key:k.id},[e("td",null,[C(e("input",{"onUpdate:modelValue":S=>k.title=S,onBlur:S=>n(k),class:"input"},null,40,Qn),[[K,k.title]])]),e("td",null,[C(e("input",{"onUpdate:modelValue":S=>k.url=S,onBlur:S=>n(k),class:"input"},null,40,Xn),[[K,k.url]])]),e("td",null,[C(e("input",{"onUpdate:modelValue":S=>k.logo=S,onBlur:S=>n(k),class:"input",placeholder:"logoé“¾æ¥(å¯é€‰)"},null,40,Yn),[[K,k.logo]])]),e("td",null,[e("button",{class:"btn btn-danger",onClick:S=>u(k.id)},"åˆ é™¤",8,Zn)])]))),128))])])])]))}},so=X(eo,[["__scopeId","data-v-c25e838c"]]),to={class:"user-manage"},lo={class:"user-card"},no={class:"username-section"},oo={class:"username-form"},ao={class:"current-username"},io={class:"username-display"},ro={class:"form-group"},uo={class:"form-actions"},co=["disabled"],vo={class:"password-section"},po={class:"password-form"},mo={class:"form-group"},fo={class:"form-group"},go={class:"form-group"},ho={class:"form-actions"},bo=["disabled"],ko={__name:"UserManage",setup(d){const s=$(""),i=$(""),U=$(""),t=$(!1),f=$(""),P=$("success"),n=$({}),u=$(""),h=$(!1),_=$(""),k=$("success");ne(()=>A(null,null,function*(){yield S()}));function S(){return A(this,null,function*(){try{const T=yield hs();n.value=T.data.data||T.data}catch(T){console.error("è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:",T)}})}function b(){return A(this,null,function*(){var T,x;if(!u.value){p("è¯·è¾“å…¥æ–°ç”¨æˆ·å","error");return}if(u.value.length<3||u.value.length>20){p("ç”¨æˆ·åé•¿åº¦åº”ä¸º3-20ä½","error");return}if(u.value===n.value.username){p("æ–°ç”¨æˆ·åä¸èƒ½ä¸å½“å‰ç”¨æˆ·åç›¸åŒ","error");return}h.value=!0,_.value="";try{yield bs(u.value),p("ç”¨æˆ·åä¿®æ”¹æˆåŠŸï¼2ç§’åè‡ªåŠ¨é€€å‡ºï¼Œè¯·ä½¿ç”¨æ–°ç”¨æˆ·åé‡æ–°ç™»å½•...","success"),u.value="",setTimeout(()=>{localStorage.removeItem("token"),window.location.href="/admin"},2e3)}catch(V){p(((x=(T=V.response)==null?void 0:T.data)==null?void 0:x.message)||"ç”¨æˆ·åä¿®æ”¹å¤±è´¥","error")}finally{h.value=!1}})}function p(T,x){_.value=T,k.value=x,setTimeout(()=>{_.value=""},3e3)}function m(){return A(this,null,function*(){var T,x;if(!s.value||!i.value||!U.value){c("è¯·å¡«å†™æ‰€æœ‰å¯†ç å­—æ®µ","error");return}if(i.value!==U.value){c("ä¸¤æ¬¡è¾“å…¥çš„æ–°å¯†ç ä¸ä¸€è‡´","error");return}if(i.value.length<6){c("æ–°å¯†ç é•¿åº¦è‡³å°‘6ä½","error");return}t.value=!0,f.value="";try{yield ks(s.value,i.value),c("å¯†ç ä¿®æ”¹æˆåŠŸ","success"),s.value="",i.value="",U.value=""}catch(V){c(((x=(T=V.response)==null?void 0:T.data)==null?void 0:x.message)||"å¯†ç ä¿®æ”¹å¤±è´¥","error")}finally{t.value=!1}})}function c(T,x){f.value=T,P.value=x,T==="å¯†ç ä¿®æ”¹æˆåŠŸ"&&x==="success"?setTimeout(()=>{f.value="2ç§’åè‡ªåŠ¨é€€å‡ºç™»å½•,è¯·ä½¿ç”¨æ–°å¯†ç é‡æ–°ç™»å½•...",setTimeout(()=>{localStorage.removeItem("token"),window.location.reload()},2e3)},500):setTimeout(()=>{f.value=""},3e3)}return(T,x)=>(o(),a("div",to,[x[11]||(x[11]=e("div",{class:"user-header"},null,-1)),e("div",lo,[e("div",no,[x[6]||(x[6]=e("h3",{class:"section-title"},"ä¿®æ”¹ç”¨æˆ·å",-1)),e("div",oo,[e("div",ao,[x[4]||(x[4]=e("label",null,"å½“å‰ç”¨æˆ·åï¼š",-1)),e("span",io,r(n.value.username||"admin"),1)]),e("div",ro,[x[5]||(x[5]=e("label",null,"æ–°ç”¨æˆ·åï¼š",-1)),C(e("input",{"onUpdate:modelValue":x[0]||(x[0]=V=>u.value=V),type:"text",placeholder:"è¯·è¾“å…¥æ–°ç”¨æˆ·åï¼ˆ3-20ä½ï¼‰",class:"input"},null,512),[[K,u.value]])]),e("div",uo,[e("button",{onClick:b,class:"btn",disabled:h.value},r(h.value?"ä¿®æ”¹ä¸­...":"ä¿®æ”¹ç”¨æˆ·å"),9,co)]),_.value?(o(),a("p",{key:0,class:z(["message",k.value])},r(_.value),3)):B("",!0)])]),e("div",vo,[x[10]||(x[10]=e("h3",{class:"section-title"},"ä¿®æ”¹å¯†ç ",-1)),e("div",po,[e("div",mo,[x[7]||(x[7]=e("label",null,"å½“å‰å¯†ç ï¼š",-1)),C(e("input",{"onUpdate:modelValue":x[1]||(x[1]=V=>s.value=V),type:"password",placeholder:"è¯·è¾“å…¥å½“å‰å¯†ç ",class:"input"},null,512),[[K,s.value]])]),e("div",fo,[x[8]||(x[8]=e("label",null,"æ–°å¯†ç ï¼š",-1)),C(e("input",{"onUpdate:modelValue":x[2]||(x[2]=V=>i.value=V),type:"password",placeholder:"è¯·è¾“å…¥æ–°å¯†ç ",class:"input"},null,512),[[K,i.value]])]),e("div",go,[x[9]||(x[9]=e("label",null,"ç¡®è®¤æ–°å¯†ç ï¼š",-1)),C(e("input",{"onUpdate:modelValue":x[3]||(x[3]=V=>U.value=V),type:"password",placeholder:"è¯·å†æ¬¡è¾“å…¥æ–°å¯†ç ",class:"input"},null,512),[[K,U.value]])]),e("div",ho,[e("button",{onClick:m,class:"btn",disabled:t.value},r(t.value?"ä¿®æ”¹ä¸­...":"ä¿®æ”¹å¯†ç "),9,bo)]),f.value?(o(),a("p",{key:0,class:z(["message",P.value])},r(f.value),3)):B("",!0)])])])]))}},yo=X(ko,[["__scopeId","data-v-40392133"]]),wo={class:"backup-manage"},_o={class:"tabs"},Co={class:"tab-content"},$o={class:"toolbar"},Mo=["disabled"],xo=["disabled"],Uo=["disabled"],So={class:"backup-list"},Vo={key:0,class:"empty-state"},Ao={key:1,class:"backup-grid"},To={class:"backup-info"},Bo={class:"backup-name"},Io={class:"backup-meta"},Do={class:"backup-size"},Po={class:"backup-date"},Lo={key:0,class:"backup-signed",title:"å·²ç­¾åéªŒè¯"},Ko={key:1,class:"backup-unsigned",title:"æœªç­¾åï¼ˆå¤–éƒ¨ä¸Šä¼ ï¼‰"},Eo={class:"backup-actions"},Wo=["onClick"],zo=["onClick"],Ro=["onClick"],No=["onClick"],Fo={class:"tab-content"},Oo={class:"toolbar"},Ho=["disabled"],qo=["disabled"],jo={key:1,class:"info-box"},Go={class:"backup-list"},Jo={key:0,class:"empty-state"},Qo={key:1,class:"backup-grid"},Xo={class:"backup-info"},Yo={class:"backup-name"},Zo={class:"backup-meta"},ea={class:"backup-size"},sa={class:"backup-date"},ta={class:"backup-actions"},la=["onClick"],na=["onClick"],oa={class:"tab-content"},aa={class:"config-section"},ia={class:"config-card"},ra={class:"config-header"},da={class:"switch"},ua={key:0,class:"config-fields"},ca={class:"field-row"},va={class:"field-row"},pa={class:"config-card"},ma={class:"config-header"},fa={class:"switch"},ga={key:0,class:"config-fields"},ha={class:"field-row"},ba={class:"time-input"},ka={class:"field-row"},ya={class:"field-row checkbox-row"},wa={class:"checkbox-label"},_a={class:"config-card"},Ca={class:"config-header"},$a={class:"switch"},Ma={class:"config-info"},xa={key:0,class:"warning-text"},Ua={key:0,class:"config-fields"},Sa={class:"field-row checkbox-row"},Va={class:"checkbox-label"},Aa={class:"field-row checkbox-row"},Ta={class:"checkbox-label"},Ba={class:"config-card"},Ia={class:"config-header"},Da={class:"switch"},Pa={key:0,class:"stats-card"},La={class:"stats-grid"},Ka={class:"stat-item"},Ea={class:"stat-value"},Wa={class:"stat-item"},za={class:"stat-value"},Ra={class:"stat-item"},Na={class:"stat-value"},Fa={class:"stat-item"},Oa={class:"stat-value"},Ha={class:"config-actions"},qa=["disabled"],ja={key:0,class:"modal-overlay"},Ga={class:"modal-content config-modal"},Ja={class:"form-group"},Qa={class:"form-group"},Xa={class:"form-group"},Ya=["placeholder"],Za={key:0},ei={key:1},si={class:"modal-actions"},ti=["disabled"],li={key:1,class:"modal-overlay"},ni={class:"modal-content"},oi={style:{"white-space":"pre-line"}},ai={class:"modal-actions"},ii=["disabled"],ri=["disabled"],di={key:2,class:"modal-overlay"},ui={class:"modal-content config-modal"},ci={class:"form-group"},vi={class:"form-group"},pi={class:"modal-actions"},mi=["disabled"],fi={key:3,class:"modal-overlay"},gi={class:"modal-content config-modal"},hi={class:"form-group"},bi={class:"modal-actions"},ki=["disabled"],yi={__name:"BackupManage",setup(d){const s=$("local"),i=$([]),U=$([]),t=$(!1),f=$(!1),P=$(!1),n=$(null),u=oe({create:!1,list:!1,delete:!1,restore:!1,upload:!1,rename:!1,webdavConfig:!1,webdavBackup:!1,webdavList:!1,webdavRestore:!1,webdavDelete:!1,autoBackupConfig:!1}),h=oe({name:"",description:""}),_=oe({oldName:"",newName:""}),k=$({text:"",type:""}),S=oe({show:!1,filename:"",action:null,title:"",message:"",confirmClass:"",signed:!0,processing:!1}),b=oe({configured:!1,url:"",username:""}),p=oe({url:"",username:"",password:""}),m=oe({debounce:{enabled:!0,delay:5,keep:5},scheduled:{enabled:!0,hour:2,minute:0,keep:7,onlyIfModified:!0},webdav:{enabled:!1,syncDaily:!0,syncIncremental:!0},autoClean:!0}),c=$(null),T=localStorage.getItem("token");function x(q){return A(this,arguments,function*(y,l={}){return(yield fetch(y,re(le({},l),{headers:le({Authorization:`Bearer ${T}`,"Content-Type":"application/json"},l.headers)}))).json()})}const V=(y,l="success",q=4e3)=>{k.value={text:y,type:l},setTimeout(()=>{k.value={text:"",type:""}},l==="error"?6e3:q)};function H(){try{window.dispatchEvent(new CustomEvent("nav-menus-updated")),console.log("[å¤‡ä»½ç®¡ç†] å·²é€šçŸ¥æ‰©å±•åˆ·æ–°å³é”®èœå•")}catch(y){console.warn("[å¤‡ä»½ç®¡ç†] é€šçŸ¥æ‰©å±•å¤±è´¥:",y)}}function Q(){return A(this,null,function*(){try{const y=yield x("/api/ai/config/verify");y.success&&(y.status==="decrypt_failed"?(V("âš ï¸ AI é…ç½®æ¢å¤å¼‚å¸¸ï¼šAPI Key è§£å¯†å¤±è´¥ï¼Œè¯·å‰å¾€ AI è®¾ç½®é‡æ–°é…ç½®","warning",8e3),setTimeout(()=>{confirm(`AI é…ç½®çš„ API Key è§£å¯†å¤±è´¥ï¼Œå¯èƒ½æ˜¯å› ä¸ºå¤‡ä»½æ¥è‡ªä¸åŒçš„æœåŠ¡å™¨ã€‚

æ˜¯å¦ç°åœ¨å‰å¾€ AI è®¾ç½®é¡µé¢é‡æ–°é…ç½®ï¼Ÿ`)&&(window.location.href="/admin/ai-settings")},1e3)):y.status==="ok"&&console.log("[å¤‡ä»½ç®¡ç†] AI é…ç½®éªŒè¯é€šè¿‡"))}catch(y){console.warn("[å¤‡ä»½ç®¡ç†] AI é…ç½®éªŒè¯å¤±è´¥:",y)}})}const Z=()=>{h.name="",h.description="",f.value=!0},ee=()=>A(null,null,function*(){u.create=!0;const y=yield x("/api/backup/create",{method:"POST",body:JSON.stringify({name:h.name||null,description:h.description||null})});y.success?(V("å¤‡ä»½åˆ›å»ºæˆåŠŸï¼"),f.value=!1,yield R()):V(y.message||"å¤‡ä»½åˆ›å»ºå¤±è´¥","error"),u.create=!1}),te=y=>{_.oldName=y,_.newName=y.replace(".zip",""),P.value=!0},se=()=>A(null,null,function*(){if(!_.newName.trim()){V("è¯·è¾“å…¥æ–°åç§°","error");return}u.rename=!0;const y=yield x(`/api/backup/rename/${_.oldName}`,{method:"PUT",body:JSON.stringify({newName:_.newName})});y.success?(V("é‡å‘½åæˆåŠŸï¼"),P.value=!1,yield R()):V(y.message||"é‡å‘½åå¤±è´¥","error"),u.rename=!1}),R=()=>A(null,null,function*(){u.list=!0;const y=yield x("/api/backup/list");y.success?i.value=y.backups:V("è·å–å¤‡ä»½åˆ—è¡¨å¤±è´¥","error"),u.list=!1}),E=y=>{window.open(`/api/backup/download/${y}?token=${T}`,"_blank")},w=(y,l)=>{const q=typeof l=="object"?l:{name:l},M=q.name;S.show=!0,S.filename=M,S.action=y,S.signed=q.signed,S.processing=!1,y==="delete"?(S.title="åˆ é™¤",S.message=`ç¡®å®šè¦åˆ é™¤å¤‡ä»½æ–‡ä»¶ ${M} å—ï¼Ÿ`,S.confirmClass="btn-danger"):y==="restore"?(S.title="æ¢å¤",q.signed?S.message=`ç¡®å®šè¦æ¢å¤å¤‡ä»½æ–‡ä»¶ ${M} å—ï¼Ÿ`:S.message=`âš ï¸ è­¦å‘Šï¼šæ­¤å¤‡ä»½æ–‡ä»¶æœªç­¾åï¼ˆå¯èƒ½æ˜¯å¤–éƒ¨ä¸Šä¼ çš„ï¼‰ï¼Œæ— æ³•éªŒè¯å…¶å®Œæ•´æ€§ã€‚

ç¡®å®šè¦æ¢å¤å¤‡ä»½æ–‡ä»¶ ${M} å—ï¼Ÿ`,S.confirmClass="btn-restore"):y==="webdav-restore"?(S.title="ä»WebDAVæ¢å¤",S.message=`ç¡®å®šè¦ä»WebDAVæ¢å¤å¤‡ä»½ ${M} å—ï¼Ÿè¿™å°†è¦†ç›–å½“å‰æ•°æ®ã€‚`,S.confirmClass="btn-restore"):y==="webdav-delete"&&(S.title="åˆ é™¤WebDAVå¤‡ä»½",S.message=`ç¡®å®šè¦åˆ é™¤WebDAVå¤‡ä»½ ${M} å—ï¼Ÿ`,S.confirmClass="btn-danger")},I=()=>A(null,null,function*(){const{action:y,filename:l,signed:q}=S;S.show=!1,S.processing=!1;try{if(y==="delete"){V("æ­£åœ¨åˆ é™¤å¤‡ä»½...");const M=yield x(`/api/backup/delete/${l}`,{method:"DELETE"});M.success?(V("âœ“ åˆ é™¤æˆåŠŸ"),yield R()):V("âœ— "+(M.message||"åˆ é™¤å¤±è´¥"),"error")}else if(y==="restore"){V("æ­£åœ¨æ¢å¤å¤‡ä»½ï¼Œè¯·ç¨å€™...");const M=q?{}:{forceRestore:!0},j=yield x(`/api/backup/restore/${l}`,{method:"POST",body:JSON.stringify(M)});if(j.success)V("âœ“ å¤‡ä»½å·²æ¢å¤ï¼Œæ­£åœ¨é‡æ–°åŠ è½½æ•°æ®..."),yield new Promise(ve=>setTimeout(ve,2e3)),yield Promise.all([R(),J(),Y(),L()]),H(),j.checkAIConfig&&(yield Q()),V("âœ“ æ¢å¤å®Œæˆï¼æ•°æ®å·²æ›´æ–°","success",5e3);else if(j.requireConfirm&&j.code==="NO_SIGNATURE"){if(confirm(j.message+`

ç‚¹å‡»"ç¡®å®š"ç»§ç»­æ¢å¤ï¼Œç‚¹å‡»"å–æ¶ˆ"æ”¾å¼ƒæ“ä½œã€‚`)){const ve=yield x(`/api/backup/restore/${l}`,{method:"POST",body:JSON.stringify({forceRestore:!0})});ve.success?(V("âœ“ å¤‡ä»½å·²æ¢å¤ï¼Œæ­£åœ¨é‡æ–°åŠ è½½æ•°æ®..."),yield new Promise(ze=>setTimeout(ze,2e3)),yield Promise.all([R(),J(),Y(),L()]),H(),ve.checkAIConfig&&(yield Q()),V("âœ“ æ¢å¤å®Œæˆï¼æ•°æ®å·²æ›´æ–°","success",5e3)):V("âœ— "+(ve.message||"æ¢å¤å¤±è´¥"),"error")}}else V("âœ— "+(j.message||"æ¢å¤å¤±è´¥"),"error")}else y==="webdav-restore"?yield be(l):y==="webdav-delete"&&(yield ke(l))}catch(M){V("âœ— æ“ä½œå¤±è´¥: "+M.message,"error")}}),D=y=>y?new Date(y).toLocaleString("zh-CN",{hour12:!1}):"--",g=()=>{n.value.click()},v=y=>A(null,null,function*(){const l=y.target.files[0];if(l){if(!l.name.endsWith(".zip")){V("åªæ”¯æŒ.zipæ ¼å¼çš„å¤‡ä»½æ–‡ä»¶","error"),y.target.value="";return}if(l.size>500*1024*1024){V("å¤‡ä»½æ–‡ä»¶è¿‡å¤§ï¼Œæœ€å¤§æ”¯æŒ500MB","error"),y.target.value="";return}u.upload=!0;try{const q=new FormData;q.append("backup",l);const j=yield(yield fetch("/api/backup/upload",{method:"POST",headers:{Authorization:`Bearer ${T}`},body:q})).json();j.success?(V("å¤‡ä»½æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼"),yield R()):V(j.message||"å¤‡ä»½æ–‡ä»¶ä¸Šä¼ å¤±è´¥","error")}catch(q){console.error("ä¸Šä¼ å¤±è´¥:",q),V("å¤‡ä»½æ–‡ä»¶ä¸Šä¼ å¤±è´¥","error")}finally{u.upload=!1,y.target.value=""}}}),J=()=>A(null,null,function*(){const y=yield x("/api/backup/webdav/config");y.success&&y.config&&(b.configured=y.config.configured,b.url=y.config.url||"",b.username=y.config.username||"")}),me=()=>A(null,null,function*(){yield J(),p.url=b.url,p.username=b.username,p.password="",t.value=!0}),fe=()=>A(null,null,function*(){if(!p.url||!p.username){V("è¯·å¡«å†™URLå’Œç”¨æˆ·å","error");return}if(!b.configured&&!p.password){V("é¦–æ¬¡é…ç½®æ—¶å¯†ç ä¸èƒ½ä¸ºç©º","error");return}u.webdavConfig=!0;const y=yield x("/api/backup/webdav/config",{method:"POST",body:JSON.stringify(p)});y.success?(t.value=!1,yield J(),b.configured?(yield Y(),yield L(),m.webdav.enabled?V("WebDAVé…ç½®ä¿å­˜æˆåŠŸï¼"):(m.webdav.enabled=!0,(yield x("/api/backup/auto/config",{method:"POST",body:JSON.stringify(m)})).success?V("WebDAVé…ç½®ä¿å­˜æˆåŠŸï¼Œå·²è‡ªåŠ¨å¼€å¯WebDAVè‡ªåŠ¨åŒæ­¥ï¼"):V("WebDAVé…ç½®ä¿å­˜æˆåŠŸï¼Œä½†è‡ªåŠ¨åŒæ­¥å¼€å¯å¤±è´¥","error"))):V("WebDAVé…ç½®ä¿å­˜æˆåŠŸï¼")):V(y.message||"WebDAVé…ç½®ä¿å­˜å¤±è´¥","error"),u.webdavConfig=!1}),ge=()=>A(null,null,function*(){u.webdavBackup=!0;const y=yield x("/api/backup/webdav/backup",{method:"POST"});y.success?(V("å¤‡ä»½åˆ°WebDAVæˆåŠŸï¼"),yield Y()):(V(y.message||"å¤‡ä»½åˆ°WebDAVå¤±è´¥","error"),y.needReconfigure&&(b.configured=!1,b.url="",b.username="")),u.webdavBackup=!1}),he=y=>{y.target.checked&&!b.configured&&(m.webdav.enabled=!1,V('è¯·å…ˆåœ¨"WebDAVå¤‡ä»½"æ ‡ç­¾é¡µé…ç½®WebDAVè¿æ¥',"error"),s.value="webdav")},Y=()=>A(null,null,function*(){u.webdavList=!0;const y=yield x("/api/backup/webdav/list");y.success?(U.value=y.backups||[],y.configured===!1&&(b.configured=!1,b.url="",b.username="",y.message&&V(y.message,"error"))):V(y.message||"è·å–WebDAVå¤‡ä»½åˆ—è¡¨å¤±è´¥","error"),u.webdavList=!1}),be=y=>A(null,null,function*(){V("æ­£åœ¨ä» WebDAV æ¢å¤å¤‡ä»½ï¼Œè¯·ç¨å€™..."),u.webdavRestore=!0;try{const l=yield x("/api/backup/webdav/restore",{method:"POST",body:JSON.stringify({filename:y})});l.success?(V("âœ“ å¤‡ä»½å·²æ¢å¤ï¼Œæ­£åœ¨é‡æ–°åŠ è½½æ•°æ®..."),yield new Promise(q=>setTimeout(q,2e3)),yield Promise.all([R(),J(),Y(),L()]),H(),l.checkAIConfig&&(yield Q()),V("âœ“ æ¢å¤å®Œæˆï¼æ•°æ®å·²æ›´æ–°","success",5e3)):(V("âœ— "+(l.message||"ä» WebDAV æ¢å¤å¤±è´¥"),"error"),l.needReconfigure&&(b.configured=!1,b.url="",b.username=""))}catch(l){V("âœ— æ¢å¤å¤±è´¥: "+l.message,"error")}finally{u.webdavRestore=!1}}),ke=y=>A(null,null,function*(){V("æ­£åœ¨åˆ é™¤ WebDAV å¤‡ä»½..."),u.webdavDelete=!0;try{const l=yield x(`/api/backup/webdav/delete/${y}`,{method:"DELETE"});l.success?(V("âœ“ åˆ é™¤æˆåŠŸ"),yield Y()):(V("âœ— "+(l.message||"åˆ é™¤å¤±è´¥"),"error"),l.needReconfigure&&(b.configured=!1,b.url="",b.username=""))}catch(l){V("âœ— åˆ é™¤å¤±è´¥: "+l.message,"error")}finally{u.webdavDelete=!1}}),L=()=>A(null,null,function*(){const y=yield x("/api/backup/auto/config");y.success&&y.config?(Object.assign(m,y.config),c.value=y.stats||null):V("åŠ è½½è‡ªåŠ¨å¤‡ä»½é…ç½®å¤±è´¥","error")}),O=()=>A(null,null,function*(){u.autoBackupConfig=!0;const y=yield x("/api/backup/auto/config",{method:"POST",body:JSON.stringify(m)});y.success?(V("è‡ªåŠ¨å¤‡ä»½é…ç½®ä¿å­˜æˆåŠŸï¼"),yield L()):V(y.message||"è‡ªåŠ¨å¤‡ä»½é…ç½®ä¿å­˜å¤±è´¥","error"),u.autoBackupConfig=!1}),Ee=()=>{if(!m.scheduled.enabled)return"æœªå¯ç”¨";const y=String(m.scheduled.hour).padStart(2,"0"),l=String(m.scheduled.minute).padStart(2,"0");return`æ¯å¤© ${y}:${l}`},We=()=>{confirm("ç¡®å®šè¦æ¢å¤ä¸ºé»˜è®¤é…ç½®å—ï¼Ÿè¿™å°†é‡ç½®æ‰€æœ‰è‡ªåŠ¨å¤‡ä»½è®¾ç½®ã€‚")&&(m.debounce={enabled:!0,delay:5,keep:5},m.scheduled={enabled:!0,hour:2,minute:0,keep:7,onlyIfModified:!0},m.webdav={enabled:!1,syncDaily:!0,syncIncremental:!0},m.autoClean=!0,V('å·²æ¢å¤é»˜è®¤é…ç½®ï¼Œè¯·ç‚¹å‡»"ä¿å­˜é…ç½®"ä»¥ç”Ÿæ•ˆ'))};return ne(()=>A(null,null,function*(){yield R(),yield J(),b.configured&&(yield Y()),yield L()})),(y,l)=>{var q;return o(),a("div",wo,[e("div",_o,[e("button",{class:z(["tab",{active:s.value==="local"}]),onClick:l[0]||(l[0]=M=>s.value="local")}," ğŸ“¦ æœ¬åœ°å¤‡ä»½ ",2),e("button",{class:z(["tab",{active:s.value==="webdav"}]),onClick:l[1]||(l[1]=M=>s.value="webdav")}," â˜ï¸ WebDAVå¤‡ä»½ ",2),e("button",{class:z(["tab",{active:s.value==="auto"}]),onClick:l[2]||(l[2]=M=>s.value="auto")}," âš™ï¸ è‡ªåŠ¨å¤‡ä»½é…ç½® ",2)]),C(e("div",Co,[e("div",$o,[e("button",{class:"btn btn-primary",onClick:Z,disabled:u.create},[l[25]||(l[25]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"})],-1)),W(" "+r(u.create?"å¤‡ä»½ä¸­...":"åˆ›å»ºå¤‡ä»½"),1)],8,Mo),e("button",{class:"btn btn-success",onClick:g,disabled:u.upload},[l[26]||(l[26]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5-5 5 5M12 15V3"})],-1)),W(" "+r(u.upload?"ä¸Šä¼ ä¸­...":"ä¸Šä¼ å¤‡ä»½"),1)],8,xo),e("button",{class:"btn btn-secondary",onClick:R,disabled:u.list},[l[27]||(l[27]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)),W(" "+r(u.list?"åˆ·æ–°ä¸­...":"åˆ·æ–°åˆ—è¡¨"),1)],8,Uo),e("input",{ref_key:"fileInput",ref:n,type:"file",accept:".zip",onChange:v,style:{display:"none"}},null,544)]),k.value.text?(o(),a("div",{key:0,class:z(["message",k.value.type])},r(k.value.text),3)):B("",!0),e("div",So,[i.value.length===0&&!u.list?(o(),a("div",Vo,[...l[28]||(l[28]=[e("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"#ccc","stroke-width":"1.5"},[e("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e("circle",{cx:"12",cy:"7",r:"4"})],-1),e("p",null,"æš‚æ— å¤‡ä»½æ–‡ä»¶",-1)])])):(o(),a("div",Ao,[(o(!0),a(N,null,F(i.value,M=>(o(),a("div",{key:M.name,class:"backup-card"},[l[33]||(l[33]=e("div",{class:"backup-icon"},[e("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2"},[e("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e("polyline",{points:"14 2 14 8 20 8"})])],-1)),e("div",To,[e("div",Bo,r(M.name),1),e("div",Io,[e("span",Do,r(M.size),1),e("span",Po,r(D(M.created)),1),M.signed?(o(),a("span",Lo,"ğŸ”’")):(o(),a("span",Ko,"âš ï¸"))])]),e("div",Eo,[e("button",{class:"btn-icon btn-restore",onClick:j=>w("restore",M),title:"æ¢å¤å¤‡ä»½"},[...l[29]||(l[29]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)])],8,Wo),e("button",{class:"btn-icon btn-rename",onClick:j=>te(M.name),title:"é‡å‘½å"},[...l[30]||(l[30]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,zo),e("button",{class:"btn-icon",onClick:j=>E(M.name),title:"ä¸‹è½½å¤‡ä»½"},[...l[31]||(l[31]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"})],-1)])],8,Ro),e("button",{class:"btn-icon btn-danger",onClick:j=>w("delete",M.name),title:"åˆ é™¤å¤‡ä»½"},[...l[32]||(l[32]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"3 6 5 6 21 6"}),e("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})],-1)])],8,No)])]))),128))]))])],512),[[_e,s.value==="local"]]),C(e("div",Fo,[e("div",Oo,[e("button",{class:"btn btn-primary",onClick:me},[...l[34]||(l[34]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"3"}),e("path",{d:"M12 1v6m0 6v6M5.64 5.64l4.24 4.24m4.24 4.24l4.24 4.24M1 12h6m6 0h6M5.64 18.36l4.24-4.24m4.24-4.24l4.24-4.24"})],-1),W(" WebDAVé…ç½® ",-1)])]),e("button",{class:"btn btn-primary",onClick:ge,disabled:u.webdavBackup||!b.configured},[l[35]||(l[35]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"})],-1)),W(" "+r(u.webdavBackup?"å¤‡ä»½ä¸­...":"å¤‡ä»½åˆ°WebDAV"),1)],8,Ho),e("button",{class:"btn btn-secondary",onClick:Y,disabled:u.webdavList||!b.configured},[l[36]||(l[36]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)),W(" "+r(u.webdavList?"åˆ·æ–°ä¸­...":"åˆ·æ–°åˆ—è¡¨"),1)],8,qo)]),k.value.text?(o(),a("div",{key:0,class:z(["message",k.value.type])},r(k.value.text),3)):B("",!0),b.configured?B("",!0):(o(),a("div",jo,[...l[37]||(l[37]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),e("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})],-1),e("p",null,"è¯·å…ˆé…ç½®WebDAVè¿æ¥ä¿¡æ¯ï¼ˆæ”¯æŒï¼šåšæœäº‘ã€Nextcloudã€é˜¿é‡Œäº‘ç›˜WebDAVã€Dropboxç­‰ï¼‰",-1)])])),e("div",Go,[U.value.length===0&&!u.webdavList?(o(),a("div",Jo,[...l[38]||(l[38]=[e("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"#ccc","stroke-width":"1.5"},[e("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e("circle",{cx:"12",cy:"7",r:"4"})],-1),e("p",null,"æš‚æ— WebDAVå¤‡ä»½",-1)])])):(o(),a("div",Qo,[(o(!0),a(N,null,F(U.value,M=>(o(),a("div",{key:M.name,class:"backup-card"},[l[41]||(l[41]=ie('<div class="backup-icon" data-v-19fdb4a7><svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#16a34a" stroke-width="2" data-v-19fdb4a7><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" data-v-19fdb4a7></path><polyline points="14 2 14 8 20 8" data-v-19fdb4a7></polyline><path d="M12 18v-6M9 15l3 3 3-3" data-v-19fdb4a7></path></svg></div>',1)),e("div",Xo,[e("div",Yo,r(M.name),1),e("div",Zo,[e("span",ea,r(M.size),1),e("span",sa,r(D(M.created)),1)])]),e("div",ta,[e("button",{class:"btn-icon btn-restore",onClick:j=>w("webdav-restore",M.name),title:"ä»WebDAVæ¢å¤"},[...l[39]||(l[39]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)])],8,la),e("button",{class:"btn-icon btn-danger",onClick:j=>w("webdav-delete",M.name),title:"åˆ é™¤WebDAVå¤‡ä»½"},[...l[40]||(l[40]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"3 6 5 6 21 6"}),e("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})],-1)])],8,na)])]))),128))]))])],512),[[_e,s.value==="webdav"]]),C(e("div",oa,[k.value.text?(o(),a("div",{key:0,class:z(["message",k.value.type])},r(k.value.text),3)):B("",!0),e("div",aa,[l[76]||(l[76]=e("h3",null,"âš¡ è‡ªåŠ¨å¤‡ä»½é…ç½®",-1)),l[77]||(l[77]=e("p",{class:"config-description"},"é…ç½®ç³»ç»Ÿè‡ªåŠ¨å¤‡ä»½ç­–ç•¥ï¼ŒåŒ…æ‹¬å¢é‡å¤‡ä»½å’Œå®šæ—¶å¤‡ä»½ã€‚",-1)),e("div",ia,[e("div",ra,[l[43]||(l[43]=e("h4",null,"å¢é‡å¤‡ä»½ï¼ˆé˜²æŠ–ï¼‰",-1)),e("label",da,[C(e("input",{type:"checkbox","onUpdate:modelValue":l[3]||(l[3]=M=>m.debounce.enabled=M)},null,512),[[G,m.debounce.enabled]]),l[42]||(l[42]=e("span",{class:"slider"},null,-1))])]),l[48]||(l[48]=e("p",{class:"config-info"},"å½“æ•°æ®å˜æ›´æ—¶ï¼Œå»¶è¿Ÿä¸€æ®µæ—¶é—´åè‡ªåŠ¨å¤‡ä»½ã€‚é€‚åˆé¢‘ç¹ä¿®æ”¹çš„åœºæ™¯ã€‚",-1)),m.debounce.enabled?(o(),a("div",ua,[e("div",ca,[l[44]||(l[44]=e("label",null,"å»¶è¿Ÿæ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰",-1)),C(e("input",{type:"number","onUpdate:modelValue":l[4]||(l[4]=M=>m.debounce.delay=M),min:"5",max:"1440",class:"form-input"},null,512),[[K,m.debounce.delay,void 0,{number:!0}]]),l[45]||(l[45]=e("small",null,"æ•°æ®ä¿®æ”¹åå»¶è¿Ÿå¤šä¹…è§¦å‘å¤‡ä»½ï¼ŒèŒƒå›´ï¼š5-1440åˆ†é’Ÿ",-1))]),e("div",va,[l[46]||(l[46]=e("label",null,"ä¿ç•™å¤‡ä»½æ•°é‡",-1)),C(e("input",{type:"number","onUpdate:modelValue":l[5]||(l[5]=M=>m.debounce.keep=M),min:"1",max:"30",class:"form-input"},null,512),[[K,m.debounce.keep,void 0,{number:!0}]]),l[47]||(l[47]=e("small",null,"è‡ªåŠ¨æ¸…ç†æ—¶ä¿ç•™æœ€æ–°çš„Nä¸ªå¤‡ä»½ï¼ŒèŒƒå›´ï¼š1-30ä¸ª",-1))])])):B("",!0)]),e("div",pa,[e("div",ma,[l[50]||(l[50]=e("h4",null,"å®šæ—¶å¤‡ä»½ï¼ˆæ¯æ—¥ï¼‰",-1)),e("label",fa,[C(e("input",{type:"checkbox","onUpdate:modelValue":l[6]||(l[6]=M=>m.scheduled.enabled=M)},null,512),[[G,m.scheduled.enabled]]),l[49]||(l[49]=e("span",{class:"slider"},null,-1))])]),l[58]||(l[58]=e("p",{class:"config-info"},"æ¯å¤©åœ¨å›ºå®šæ—¶é—´è‡ªåŠ¨æ‰§è¡Œå¤‡ä»½ã€‚",-1)),m.scheduled.enabled?(o(),a("div",ga,[e("div",ha,[l[52]||(l[52]=e("label",null,"å¤‡ä»½æ—¶é—´",-1)),e("div",ba,[C(e("input",{type:"number","onUpdate:modelValue":l[7]||(l[7]=M=>m.scheduled.hour=M),min:"0",max:"23",class:"form-input time-field",placeholder:"æ—¶"},null,512),[[K,m.scheduled.hour,void 0,{number:!0}]]),l[51]||(l[51]=e("span",null,":",-1)),C(e("input",{type:"number","onUpdate:modelValue":l[8]||(l[8]=M=>m.scheduled.minute=M),min:"0",max:"59",class:"form-input time-field",placeholder:"åˆ†"},null,512),[[K,m.scheduled.minute,void 0,{number:!0}]])]),l[53]||(l[53]=e("small",null,"æ ¼å¼ï¼š24å°æ—¶åˆ¶ï¼Œå¦‚ 02:00",-1))]),e("div",ka,[l[54]||(l[54]=e("label",null,"ä¿ç•™å¤‡ä»½æ•°é‡",-1)),C(e("input",{type:"number","onUpdate:modelValue":l[9]||(l[9]=M=>m.scheduled.keep=M),min:"1",max:"30",class:"form-input"},null,512),[[K,m.scheduled.keep,void 0,{number:!0}]]),l[55]||(l[55]=e("small",null,"è‡ªåŠ¨æ¸…ç†æ—¶ä¿ç•™æœ€æ–°çš„Nä¸ªå¤‡ä»½ï¼ŒèŒƒå›´ï¼š1-30ä¸ª",-1))]),e("div",ya,[e("label",wa,[C(e("input",{type:"checkbox","onUpdate:modelValue":l[10]||(l[10]=M=>m.scheduled.onlyIfModified=M)},null,512),[[G,m.scheduled.onlyIfModified]]),l[56]||(l[56]=e("span",null,"ä»…åœ¨æœ‰ä¿®æ”¹æ—¶å¤‡ä»½",-1))]),l[57]||(l[57]=e("small",null,"å¦‚æœ24å°æ—¶å†…å·²æœ‰å¢é‡å¤‡ä»½ï¼Œè·³è¿‡å®šæ—¶å¤‡ä»½ï¼ˆé¿å…é‡å¤ï¼‰",-1))])])):B("",!0)]),e("div",_a,[e("div",Ca,[l[60]||(l[60]=e("h4",null,"â˜ï¸ WebDAV è‡ªåŠ¨åŒæ­¥",-1)),e("label",$a,[C(e("input",{type:"checkbox","onUpdate:modelValue":l[11]||(l[11]=M=>m.webdav.enabled=M),onChange:he},null,544),[[G,m.webdav.enabled]]),l[59]||(l[59]=e("span",{class:"slider"},null,-1))])]),e("p",Ma,[l[61]||(l[61]=W(" è‡ªåŠ¨å°†æœ¬åœ°å¤‡ä»½åŒæ­¥åˆ° WebDAV äº‘ç«¯ã€‚ ",-1)),b.configured?B("",!0):(o(),a("span",xa,'âš ï¸ è¯·å…ˆåœ¨"WebDAVå¤‡ä»½"æ ‡ç­¾é¡µé…ç½®è¿æ¥'))]),m.webdav.enabled?(o(),a("div",Ua,[e("div",Sa,[e("label",Va,[C(e("input",{type:"checkbox","onUpdate:modelValue":l[12]||(l[12]=M=>m.webdav.syncDaily=M)},null,512),[[G,m.webdav.syncDaily]]),l[62]||(l[62]=e("span",null,"åŒæ­¥æ¯æ—¥å®šæ—¶å¤‡ä»½",-1))]),l[63]||(l[63]=e("small",null,"æ¯å¤©å®šæ—¶å¤‡ä»½åè‡ªåŠ¨ä¸Šä¼ åˆ° WebDAV",-1))]),e("div",Aa,[e("label",Ta,[C(e("input",{type:"checkbox","onUpdate:modelValue":l[13]||(l[13]=M=>m.webdav.syncIncremental=M)},null,512),[[G,m.webdav.syncIncremental]]),l[64]||(l[64]=e("span",null,"åŒæ­¥å¢é‡å¤‡ä»½",-1))]),l[65]||(l[65]=e("small",null,"å¢é‡å¤‡ä»½åè‡ªåŠ¨ä¸Šä¼ åˆ° WebDAV",-1))])])):B("",!0)]),e("div",Ba,[e("div",Ia,[l[67]||(l[67]=e("h4",null,"è‡ªåŠ¨æ¸…ç†",-1)),e("label",Da,[C(e("input",{type:"checkbox","onUpdate:modelValue":l[14]||(l[14]=M=>m.autoClean=M)},null,512),[[G,m.autoClean]]),l[66]||(l[66]=e("span",{class:"slider"},null,-1))])]),l[68]||(l[68]=e("p",{class:"config-info"},"è‡ªåŠ¨åˆ é™¤è¶…å‡ºä¿ç•™æ•°é‡çš„æ—§å¤‡ä»½æ–‡ä»¶ï¼ˆæŒ‰æ—¶é—´æ’åºï¼Œä¿ç•™æœ€æ–°çš„ï¼‰ã€‚",-1))]),c.value?(o(),a("div",Pa,[l[73]||(l[73]=e("h4",null,"ğŸ“Š å¤‡ä»½ç»Ÿè®¡",-1)),e("div",La,[e("div",Ka,[l[69]||(l[69]=e("span",{class:"stat-label"},"å¢é‡å¤‡ä»½æ•°é‡",-1)),e("span",Ea,r(((q=c.value.incremental)==null?void 0:q.count)||0)+" ä¸ª",1)]),e("div",Wa,[l[70]||(l[70]=e("span",{class:"stat-label"},"æœ€åå¢é‡å¤‡ä»½",-1)),e("span",za,r(D(c.value.lastDebounce)||"æ— "),1)]),e("div",Ra,[l[71]||(l[71]=e("span",{class:"stat-label"},"æœ€åå®šæ—¶å¤‡ä»½",-1)),e("span",Na,r(D(c.value.lastScheduled)||"æ— "),1)]),e("div",Fa,[l[72]||(l[72]=e("span",{class:"stat-label"},"ä¸‹æ¬¡å®šæ—¶å¤‡ä»½",-1)),e("span",Oa,r(Ee()),1)])])])):B("",!0),e("div",Ha,[e("button",{class:"btn btn-secondary",onClick:We},[...l[74]||(l[74]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M1 4v6h6M23 20v-6h-6"}),e("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1),W(" æ¢å¤é»˜è®¤ ",-1)])]),e("button",{class:"btn btn-primary",onClick:O,disabled:u.autoBackupConfig},[l[75]||(l[75]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),e("polyline",{points:"17 21 17 13 7 13 7 21"}),e("polyline",{points:"7 3 7 8 15 8"})],-1)),W(" "+r(u.autoBackupConfig?"ä¿å­˜ä¸­...":"ä¿å­˜é…ç½®"),1)],8,qa)])])],512),[[_e,s.value==="auto"]]),t.value?(o(),a("div",ja,[e("div",Ga,[l[82]||(l[82]=e("h3",null,"WebDAVé…ç½®",-1)),e("div",Ja,[l[78]||(l[78]=e("label",null,[W("WebDAV URL "),e("span",{class:"required"},"*")],-1)),C(e("input",{type:"text","onUpdate:modelValue":l[15]||(l[15]=M=>p.url=M),placeholder:"https://dav.jianguoyun.com/dav/",class:"form-input"},null,512),[[K,p.url]]),l[79]||(l[79]=e("small",null,"ä¾‹ï¼šåšæœäº‘ https://dav.jianguoyun.com/dav/",-1))]),e("div",Qa,[l[80]||(l[80]=e("label",null,[W("ç”¨æˆ·å "),e("span",{class:"required"},"*")],-1)),C(e("input",{type:"text","onUpdate:modelValue":l[16]||(l[16]=M=>p.username=M),placeholder:"é‚®ç®±æˆ–ç”¨æˆ·å",class:"form-input"},null,512),[[K,p.username]])]),e("div",Xa,[l[81]||(l[81]=e("label",null,[W("å¯†ç  "),e("span",{class:"required"},"*")],-1)),C(e("input",{type:"password","onUpdate:modelValue":l[17]||(l[17]=M=>p.password=M),placeholder:b.configured?"ç•™ç©ºåˆ™ä¿æŒåŸå¯†ç ä¸å˜":"åº”ç”¨å¯†ç æˆ–è®¿é—®ä»¤ç‰Œ",class:"form-input"},null,8,Ya),[[K,p.password]]),b.configured?(o(),a("small",ei,"å¦‚éœ€ä¿®æ”¹å¯†ç è¯·è¾“å…¥æ–°å¯†ç ï¼Œç•™ç©ºåˆ™ä¿æŒåŸå¯†ç ä¸å˜")):(o(),a("small",Za,"æ³¨æ„ï¼šæŸäº›æœåŠ¡éœ€è¦ä½¿ç”¨åº”ç”¨ä¸“ç”¨å¯†ç ï¼Œè€Œä¸æ˜¯ç™»å½•å¯†ç "))]),e("div",si,[e("button",{class:"btn btn-secondary",onClick:l[18]||(l[18]=M=>t.value=!1)},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:fe,disabled:u.webdavConfig},r(u.webdavConfig?"æµ‹è¯•è¿æ¥ä¸­...":"ä¿å­˜"),9,ti)])])])):B("",!0),S.show?(o(),a("div",li,[e("div",ni,[e("h3",null,"ç¡®è®¤"+r(S.title),1),e("p",oi,r(S.message),1),e("div",ai,[e("button",{class:"btn btn-secondary",onClick:l[19]||(l[19]=M=>S.show=!1),disabled:S.processing},"å–æ¶ˆ",8,ii),e("button",{class:z(["btn",S.confirmClass]),onClick:I,disabled:S.processing},r(S.processing?"å¤„ç†ä¸­...":"ç¡®è®¤"),11,ri)])])])):B("",!0),f.value?(o(),a("div",di,[e("div",ui,[l[86]||(l[86]=e("h3",null,"åˆ›å»ºå¤‡ä»½",-1)),e("div",ci,[l[83]||(l[83]=e("label",null,"å¤‡ä»½åç§°ï¼ˆå¯é€‰ï¼‰",-1)),C(e("input",{type:"text","onUpdate:modelValue":l[20]||(l[20]=M=>h.name=M),placeholder:"ä¾‹å¦‚ï¼šæ·»åŠ ä¹¦ç­¾åçš„å¤‡ä»½",class:"form-input",maxlength:"50"},null,512),[[K,h.name]]),l[84]||(l[84]=e("small",null,"ç•™ç©ºåˆ™ä½¿ç”¨é»˜è®¤åç§°ï¼ˆbackup-æ—¶é—´æˆ³ï¼‰",-1))]),e("div",vi,[l[85]||(l[85]=e("label",null,"å¤‡ä»½æè¿°ï¼ˆå¯é€‰ï¼‰",-1)),C(e("textarea",{"onUpdate:modelValue":l[21]||(l[21]=M=>h.description=M),placeholder:"æè¿°è¿™æ¬¡å¤‡ä»½çš„å†…å®¹æˆ–ç›®çš„...",class:"form-input",rows:"3"},null,512),[[K,h.description]])]),e("div",pi,[e("button",{class:"btn btn-secondary",onClick:l[22]||(l[22]=M=>f.value=!1)},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:ee,disabled:u.create},r(u.create?"å¤‡ä»½ä¸­...":"åˆ›å»ºå¤‡ä»½"),9,mi)])])])):B("",!0),P.value?(o(),a("div",fi,[e("div",gi,[l[88]||(l[88]=e("h3",null,"é‡å‘½åå¤‡ä»½",-1)),e("div",hi,[l[87]||(l[87]=e("label",null,[W("æ–°åç§° "),e("span",{class:"required"},"*")],-1)),C(e("input",{type:"text","onUpdate:modelValue":l[23]||(l[23]=M=>_.newName=M),placeholder:"è¾“å…¥æ–°çš„å¤‡ä»½åç§°",class:"form-input",maxlength:"50"},null,512),[[K,_.newName]]),e("small",null,"åŸåç§°ï¼š"+r(_.oldName),1)]),e("div",bi,[e("button",{class:"btn btn-secondary",onClick:l[24]||(l[24]=M=>P.value=!1)},"å–æ¶ˆ"),e("button",{class:"btn btn-primary",onClick:se,disabled:u.rename||!_.newName.trim()},r(u.rename?"é‡å‘½åä¸­...":"ç¡®è®¤é‡å‘½å"),9,ki)])])])):B("",!0)])}}},wi=X(yi,[["__scopeId","data-v-19fdb4a7"]]),_i={name:"AIBatchWizard",props:{visible:Boolean},emits:["close"],data(){return{step:0,stepNames:["é€‰æ‹©èŒƒå›´","ç”Ÿæˆç­–ç•¥","æ•ˆæœé¢„è§ˆ","æ‰§è¡Œä»»åŠ¡"],fieldLabels:{name:"åç§°",description:"æè¿°",tags:"æ ‡ç­¾"},menus:[],subMenus:[],tags:[],filters:{status:["empty_name","empty_desc"],menuId:"",subMenuId:""},filteredCards:[],filtering:!1,strategy:{types:["name","description"],mode:"fill",style:"default",customPrompt:""},previews:[],previewing:!1,taskRunning:!1,taskDone:!1,taskStatus:{current:0,total:0,successCount:0,failCount:0,currentCard:"",errors:[]},starting:!1,stopping:!1,eventSource:null}},computed:{canNext(){return this.step===0?this.filteredCards.length>0:this.step===1?this.strategy.types.length>0:!0},progressPercent(){return this.taskStatus.total?Math.round(this.taskStatus.current/this.taskStatus.total*100):0}},watch:{visible(d){d?this.init():this.cleanup()}},beforeUnmount(){this.cleanup()},methods:{init(){return A(this,null,function*(){this.step=0,this.previews=[],this.taskRunning=!1,this.taskDone=!1,this.taskStatus={current:0,total:0,successCount:0,failCount:0,currentCard:"",errors:[]};try{const[d,s]=yield Promise.all([xe(),Ue()]);this.menus=d.data||[],this.tags=s.data||[]}catch(d){}this.applyFilter()})},cleanup(){this.closeEventSource()},onMenuChange(){return A(this,null,function*(){this.filters.subMenuId="";const d=this.menus.find(s=>s.id===this.filters.menuId);this.subMenus=(d==null?void 0:d.subMenus)||[],this.applyFilter()})},applyFilter(){return A(this,null,function*(){this.filtering=!0;try{const d={status:this.filters.status};this.filters.menuId&&(d.menuIds=[this.filters.menuId]),this.filters.subMenuId&&(d.subMenuIds=[this.filters.subMenuId]);const{data:s}=yield Cs(d);this.filteredCards=s.cards||[]}catch(d){this.filteredCards=[]}this.filtering=!1})},nextStep(){this.step<3&&this.step++},runPreview(){return A(this,null,function*(){var d,s;this.previewing=!0,this.previews=[];try{const i=this.filteredCards.slice(0,3).map(t=>t.id),{data:U}=yield _s({cardIds:i,types:this.strategy.types,strategy:{mode:this.strategy.mode,style:this.strategy.style,customPrompt:this.strategy.customPrompt}});this.previews=U.previews||[]}catch(i){alert("é¢„è§ˆå¤±è´¥: "+(((s=(d=i.response)==null?void 0:d.data)==null?void 0:s.message)||i.message))}this.previewing=!1})},initRealtimeUpdates(){this.closeEventSource();const d=localStorage.getItem("token"),s=`/api/ai/batch-task/stream${d?"?token="+encodeURIComponent(d):""}`;this.eventSource=new EventSource(s),this.eventSource.onmessage=i=>{try{const U=JSON.parse(i.data);this.updateTaskState(U)}catch(U){console.error("Failed to parse SSE data:",U)}},this.eventSource.onerror=()=>{this.closeEventSource()}},closeEventSource(){this.eventSource&&(this.eventSource.close(),this.eventSource=null)},updateTaskState(d){if(!d)return;const s=le({},d);if(s.startTime&&s.current>1){const U=(Date.now()-s.startTime)/s.current,t=(s.total-s.current)*U;s.eta=t<6e4?`${Math.round(t/1e3)}ç§’`:`${Math.round(t/6e4)}åˆ†é’Ÿ`}if(this.taskRunning&&!s.running){this.taskStatus=re(le({},s),{current:s.total}),setTimeout(()=>{this.taskRunning=!1,this.taskDone=!0,this.closeEventSource()},1500);return}s.running?(this.taskStatus=s,this.taskRunning=!0):this.taskRunning||(this.taskStatus=s)},startTask(){return A(this,null,function*(){var d,s;this.starting=!0;try{this.taskRunning=!0,this.taskDone=!1,this.taskStatus={current:0,total:this.filteredCards.length,successCount:0,failCount:0,currentCard:"å‡†å¤‡å¯åŠ¨...",errors:[]};const{data:i}=yield ws({cardIds:this.filteredCards.map(U=>U.id),types:this.strategy.types,strategy:{mode:this.strategy.mode,style:this.strategy.style,customPrompt:this.strategy.customPrompt}});i.success&&i.total>0?this.initRealtimeUpdates():(this.taskRunning=!1,alert(i.message||"æ²¡æœ‰éœ€è¦å¤„ç†çš„å¡ç‰‡"))}catch(i){this.taskRunning=!1,alert("å¯åŠ¨å¤±è´¥: "+(((s=(d=i.response)==null?void 0:d.data)==null?void 0:s.message)||i.message))}this.starting=!1})},stopTask(){return A(this,null,function*(){this.stopping=!0;try{yield ys()}catch(d){}setTimeout(()=>{this.stopping=!1},2e3)})},extractDomain(d){try{return new URL(d).hostname.replace("www.","")}catch(s){return d}}}},Ci={class:"wizard-modal"},$i={class:"wizard-header"},Mi={class:"steps"},xi={class:"step-num"},Ui={class:"step-name"},Si={class:"wizard-body"},Vi={key:0,class:"step-content"},Ai={class:"filter-section"},Ti={class:"checkbox-group"},Bi={class:"filter-section"},Ii=["value"],Di=["value"],Pi={class:"filter-result"},Li={class:"result-count"},Ki=["disabled"],Ei={key:0,class:"card-preview-list"},Wi={class:"card-title"},zi={class:"card-url"},Ri={key:0,class:"more-hint"},Ni={key:1,class:"step-content"},Fi={class:"filter-section"},Oi={class:"checkbox-group"},Hi={class:"filter-section"},qi={class:"radio-group"},ji={class:"filter-section"},Gi={class:"filter-section"},Ji={key:2,class:"step-content"},Qi={class:"preview-actions"},Xi=["disabled"],Yi={key:0,class:"preview-list"},Zi={class:"preview-title"},er={class:"field-label"},sr={class:"diff-view"},tr={class:"diff-old"},lr={key:1,class:"preview-hint"},nr={key:3,class:"step-content"},or={key:0,class:"execute-confirm"},ar=["disabled"],ir={key:1,class:"task-progress"},rr={class:"progress-header"},dr={class:"progress-bar"},ur={class:"progress-info"},cr={key:0},vr={key:1},pr={class:"task-stats"},mr={class:"stat success"},fr={class:"stat fail"},gr={key:0,class:"error-log"},hr={key:1,class:"task-actions"},br=["disabled"],kr={class:"wizard-footer"},yr={class:"footer-right"},wr=["disabled"];function _r(d,s,i,U,t,f){var P;return i.visible?(o(),a("div",{key:0,class:"wizard-overlay",onClick:s[26]||(s[26]=we(n=>d.$emit("close"),["self"]))},[e("div",Ci,[e("div",$i,[s[27]||(s[27]=e("h3",null,"ğŸ¤– AI æ‰¹é‡ç”Ÿæˆå‘å¯¼",-1)),e("button",{class:"close-btn",onClick:s[0]||(s[0]=n=>d.$emit("close"))},"âœ•")]),e("div",Mi,[(o(!0),a(N,null,F(t.stepNames,(n,u)=>(o(),a("div",{key:u,class:z(["step",{active:t.step===u,done:t.step>u}])},[e("span",xi,r(t.step>u?"âœ“":u+1),1),e("span",Ui,r(n),1)],2))),128))]),e("div",Si,[t.step===0?(o(),a("div",Vi,[e("div",Ai,[s[31]||(s[31]=e("h4",null,"çŠ¶æ€ç­›é€‰",-1)),e("div",Ti,[e("label",null,[C(e("input",{type:"checkbox","onUpdate:modelValue":s[1]||(s[1]=n=>t.filters.status=n),value:"empty_name",onChange:s[2]||(s[2]=(...n)=>f.applyFilter&&f.applyFilter(...n))},null,544),[[G,t.filters.status]]),s[28]||(s[28]=W(" ç¼ºåç§°",-1))]),e("label",null,[C(e("input",{type:"checkbox","onUpdate:modelValue":s[3]||(s[3]=n=>t.filters.status=n),value:"empty_desc",onChange:s[4]||(s[4]=(...n)=>f.applyFilter&&f.applyFilter(...n))},null,544),[[G,t.filters.status]]),s[29]||(s[29]=W(" ç¼ºæè¿°",-1))]),e("label",null,[C(e("input",{type:"checkbox","onUpdate:modelValue":s[5]||(s[5]=n=>t.filters.status=n),value:"empty_tags",onChange:s[6]||(s[6]=(...n)=>f.applyFilter&&f.applyFilter(...n))},null,544),[[G,t.filters.status]]),s[30]||(s[30]=W(" ç¼ºæ ‡ç­¾",-1))])])]),e("div",Bi,[s[34]||(s[34]=e("h4",null,"èœå•ç­›é€‰",-1)),C(e("select",{"onUpdate:modelValue":s[7]||(s[7]=n=>t.filters.menuId=n),onChange:s[8]||(s[8]=(...n)=>f.onMenuChange&&f.onMenuChange(...n)),class:"input"},[s[32]||(s[32]=e("option",{value:""},"å…¨éƒ¨èœå•",-1)),(o(!0),a(N,null,F(t.menus,n=>(o(),a("option",{key:n.id,value:n.id},r(n.name),9,Ii))),128))],544),[[ae,t.filters.menuId]]),t.subMenus.length?C((o(),a("select",{key:0,"onUpdate:modelValue":s[9]||(s[9]=n=>t.filters.subMenuId=n),onChange:s[10]||(s[10]=(...n)=>f.applyFilter&&f.applyFilter(...n)),class:"input",style:{"margin-top":"8px"}},[s[33]||(s[33]=e("option",{value:""},"å…¨éƒ¨å­èœå•",-1)),(o(!0),a(N,null,F(t.subMenus,n=>(o(),a("option",{key:n.id,value:n.id},r(n.name),9,Di))),128))],544)),[[ae,t.filters.subMenuId]]):B("",!0)]),e("div",Pi,[e("span",Li,[s[35]||(s[35]=W("å·²é€‰ä¸­ ",-1)),e("strong",null,r(t.filteredCards.length),1),s[36]||(s[36]=W(" ä¸ªå¡ç‰‡",-1))]),e("button",{class:"btn sm",onClick:s[11]||(s[11]=(...n)=>f.applyFilter&&f.applyFilter(...n)),disabled:t.filtering},r(t.filtering?"ç­›é€‰ä¸­...":"ğŸ”„ åˆ·æ–°"),9,Ki)]),t.filteredCards.length?(o(),a("div",Ei,[(o(!0),a(N,null,F(t.filteredCards.slice(0,10),n=>(o(),a("div",{key:n.id,class:"card-preview-item"},[e("span",Wi,r(n.title||f.extractDomain(n.url)),1),e("span",zi,r(n.url),1)]))),128)),t.filteredCards.length>10?(o(),a("div",Ri,"è¿˜æœ‰ "+r(t.filteredCards.length-10)+" ä¸ª...",1)):B("",!0)])):B("",!0)])):B("",!0),t.step===1?(o(),a("div",Ni,[e("div",Fi,[s[40]||(s[40]=e("h4",null,"ç”Ÿæˆå­—æ®µ",-1)),e("div",Oi,[e("label",null,[C(e("input",{type:"checkbox","onUpdate:modelValue":s[12]||(s[12]=n=>t.strategy.types=n),value:"name"},null,512),[[G,t.strategy.types]]),s[37]||(s[37]=W(" åç§°",-1))]),e("label",null,[C(e("input",{type:"checkbox","onUpdate:modelValue":s[13]||(s[13]=n=>t.strategy.types=n),value:"description"},null,512),[[G,t.strategy.types]]),s[38]||(s[38]=W(" æè¿°",-1))]),e("label",null,[C(e("input",{type:"checkbox","onUpdate:modelValue":s[14]||(s[14]=n=>t.strategy.types=n),value:"tags"},null,512),[[G,t.strategy.types]]),s[39]||(s[39]=W(" æ ‡ç­¾",-1))])])]),e("div",Hi,[s[43]||(s[43]=e("h4",null,"ç”Ÿæˆæ¨¡å¼",-1)),e("div",qi,[e("label",null,[C(e("input",{type:"radio","onUpdate:modelValue":s[15]||(s[15]=n=>t.strategy.mode=n),value:"fill"},null,512),[[Te,t.strategy.mode]]),s[41]||(s[41]=W(" è¡¥å…¨æ¨¡å¼ï¼ˆä»…å¡«å……ç©ºå­—æ®µï¼‰",-1))]),e("label",null,[C(e("input",{type:"radio","onUpdate:modelValue":s[16]||(s[16]=n=>t.strategy.mode=n),value:"overwrite"},null,512),[[Te,t.strategy.mode]]),s[42]||(s[42]=W(" è¦†ç›–æ¨¡å¼ï¼ˆé‡æ–°ç”Ÿæˆæ‰€æœ‰ï¼‰",-1))])])]),e("div",ji,[s[45]||(s[45]=e("h4",null,"ç”Ÿæˆé£æ ¼",-1)),C(e("select",{"onUpdate:modelValue":s[17]||(s[17]=n=>t.strategy.style=n),class:"input"},[...s[44]||(s[44]=[ie('<option value="default" data-v-b6315f63>é»˜è®¤</option><option value="concise" data-v-b6315f63>ç®€æ´æœ‰åŠ›</option><option value="professional" data-v-b6315f63>ä¸“ä¸šæ­£å¼</option><option value="friendly" data-v-b6315f63>å‹å¥½è½»æ¾</option><option value="seo" data-v-b6315f63>SEO ä¼˜åŒ–</option>',5)])],512),[[ae,t.strategy.style]])]),e("div",Gi,[s[46]||(s[46]=e("h4",null,"è‡ªå®šä¹‰æç¤ºï¼ˆå¯é€‰ï¼‰",-1)),C(e("textarea",{"onUpdate:modelValue":s[18]||(s[18]=n=>t.strategy.customPrompt=n),class:"input",rows:"2",placeholder:"ä¾‹å¦‚ï¼šè¯·ä½¿ç”¨ä¸­æ–‡ï¼Œæè¿°æ§åˆ¶åœ¨30å­—ä»¥å†…"},null,512),[[K,t.strategy.customPrompt]])])])):B("",!0),t.step===2?(o(),a("div",Ji,[e("div",Qi,[e("button",{class:"btn primary",onClick:s[19]||(s[19]=(...n)=>f.runPreview&&f.runPreview(...n)),disabled:t.previewing},r(t.previewing?"â³ ç”Ÿæˆé¢„è§ˆä¸­...":"ğŸ”® è¯•è¿è¡Œï¼ˆéšæœº3ä¸ªï¼‰"),9,Xi)]),t.previews.length?(o(),a("div",Yi,[(o(!0),a(N,null,F(t.previews,n=>(o(),a("div",{key:n.cardId,class:"preview-card"},[e("div",Zi,r(n.title||f.extractDomain(n.url)),1),(o(!0),a(N,null,F(n.fields,(u,h)=>(o(),a("div",{key:h,class:"preview-field"},[e("span",er,r(t.fieldLabels[h]),1),e("div",sr,[e("div",tr,r(u.original||"(ç©º)"),1),s[47]||(s[47]=e("div",{class:"diff-arrow"},"â†’",-1)),e("div",{class:z(["diff-new",{error:u.error}])},r(u.error||u.generated||"(ç©º)"),3)])]))),128))]))),128))])):t.previewing?B("",!0):(o(),a("div",lr,' ç‚¹å‡»"è¯•è¿è¡Œ"é¢„è§ˆ AI ç”Ÿæˆæ•ˆæœï¼Œä¸æ»¡æ„å¯è¿”å›è°ƒæ•´ç­–ç•¥ '))])):B("",!0),t.step===3?(o(),a("div",nr,[!t.taskRunning&&!t.taskDone?(o(),a("div",or,[e("p",null,[s[48]||(s[48]=W("å³å°†å¤„ç† ",-1)),e("strong",null,r(t.filteredCards.length),1),s[49]||(s[49]=W(" ä¸ªå¡ç‰‡",-1))]),e("p",null,"ç”Ÿæˆå­—æ®µï¼š"+r(t.strategy.types.map(n=>t.fieldLabels[n]).join("ã€")),1),e("p",null,"ç”Ÿæˆæ¨¡å¼ï¼š"+r(t.strategy.mode==="fill"?"è¡¥å…¨æ¨¡å¼":"è¦†ç›–æ¨¡å¼"),1),e("button",{class:"btn primary lg",onClick:s[20]||(s[20]=(...n)=>f.startTask&&f.startTask(...n)),disabled:t.starting},r(t.starting?"å¯åŠ¨ä¸­...":"ğŸš€ å¼€å§‹æ‰§è¡Œ"),9,ar)])):B("",!0),t.taskRunning||t.taskDone?(o(),a("div",ir,[e("div",rr,[e("span",null,r(t.taskDone?"âœ… ä»»åŠ¡å®Œæˆ":"â³ æ­£åœ¨å¤„ç†..."),1),e("span",null,r(t.taskStatus.current)+" / "+r(t.taskStatus.total),1)]),e("div",dr,[e("div",{class:"progress-fill",style:pe({width:f.progressPercent+"%"})},null,4)]),e("div",ur,[t.taskStatus.currentCard?(o(),a("span",cr,"å½“å‰ï¼š"+r(t.taskStatus.currentCard),1)):B("",!0),t.taskStatus.eta?(o(),a("span",vr,"é¢„è®¡å‰©ä½™ï¼š"+r(t.taskStatus.eta),1)):B("",!0)]),e("div",pr,[e("span",mr,"âœ“ æˆåŠŸ "+r(t.taskStatus.successCount||0),1),e("span",fr,"âœ— å¤±è´¥ "+r(t.taskStatus.failCount||0),1)]),(P=t.taskStatus.errors)!=null&&P.length?(o(),a("div",gr,[(o(!0),a(N,null,F(t.taskStatus.errors.slice(-5),(n,u)=>(o(),a("div",{key:u,class:"error-item"}," [å¤±è´¥] "+r(n.cardTitle)+": "+r(n.error),1))),128))])):B("",!0),t.taskRunning?(o(),a("div",hr,[e("button",{class:"btn danger",onClick:s[21]||(s[21]=(...n)=>f.stopTask&&f.stopTask(...n)),disabled:t.stopping},r(t.stopping?"åœæ­¢ä¸­...":"â¹ï¸ åœæ­¢ä»»åŠ¡"),9,br)])):B("",!0)])):B("",!0)])):B("",!0)]),e("div",kr,[e("button",{class:"btn",onClick:s[22]||(s[22]=n=>d.$emit("close"))},"å–æ¶ˆ"),e("div",yr,[t.step>0&&!t.taskRunning?(o(),a("button",{key:0,class:"btn",onClick:s[23]||(s[23]=n=>t.step--)},"ä¸Šä¸€æ­¥")):B("",!0),t.step<3?(o(),a("button",{key:1,class:"btn primary",onClick:s[24]||(s[24]=(...n)=>f.nextStep&&f.nextStep(...n)),disabled:!f.canNext},r(t.step===2?"ä¸‹ä¸€æ­¥ï¼šæ‰§è¡Œ":"ä¸‹ä¸€æ­¥"),9,wr)):B("",!0),t.step===3&&t.taskDone?(o(),a("button",{key:2,class:"btn primary",onClick:s[25]||(s[25]=n=>d.$emit("close"))},"å®Œæˆ")):B("",!0)])])])])):B("",!0)}const Cr=X(_i,[["render",_r],["__scopeId","data-v-b6315f63"]]),De=()=>{const d=localStorage.getItem("token");return d?{Authorization:`Bearer ${d}`}:{}},de={get:d=>ue.get(d,{headers:De()}),post:(d,s)=>ue.post(d,s,{headers:De()})},$e={deepseek:{name:"DeepSeek",icon:"ğŸ”®",recommended:!0,needsApiKey:!0,needsBaseUrl:!1,defaultModel:"deepseek-chat",models:["deepseek-chat","deepseek-coder"],defaultBaseUrl:"https://api.deepseek.com",docsUrl:"https://platform.deepseek.com/api_keys"},openai:{name:"OpenAI",icon:"ğŸ¤–",needsApiKey:!0,needsBaseUrl:!1,defaultModel:"gpt-4o-mini",models:["gpt-4o-mini","gpt-4o","gpt-4-turbo","gpt-3.5-turbo"],defaultBaseUrl:"https://api.openai.com",docsUrl:"https://platform.openai.com/api-keys"},anthropic:{name:"Claude",icon:"ğŸ§ ",needsApiKey:!0,needsBaseUrl:!1,defaultModel:"claude-3-haiku-20240307",models:["claude-3-5-sonnet-20241022","claude-3-haiku-20240307"],docsUrl:"https://console.anthropic.com/settings/keys"},gemini:{name:"Gemini",icon:"ğŸ’",needsApiKey:!0,needsBaseUrl:!1,defaultModel:"gemini-1.5-flash",models:["gemini-1.5-flash","gemini-1.5-pro","gemini-2.0-flash-exp"],docsUrl:"https://aistudio.google.com/app/apikey"},zhipu:{name:"æ™ºè°± GLM",icon:"ğŸ‡¨ğŸ‡³",needsApiKey:!0,needsBaseUrl:!1,defaultModel:"glm-4-flash",models:["glm-4-flash","glm-4-air","glm-4"],docsUrl:"https://open.bigmodel.cn/usercenter/apikeys"},qwen:{name:"é€šä¹‰åƒé—®",icon:"â˜ï¸",needsApiKey:!0,needsBaseUrl:!1,defaultModel:"qwen-turbo",models:["qwen-turbo","qwen-plus","qwen-max"],docsUrl:"https://dashscope.console.aliyun.com/apiKey"},moonshot:{name:"Kimi",icon:"ğŸŒ™",needsApiKey:!0,needsBaseUrl:!1,defaultModel:"moonshot-v1-8k",models:["moonshot-v1-8k","moonshot-v1-32k","moonshot-v1-128k"],docsUrl:"https://platform.moonshot.cn/console/api-keys"},groq:{name:"Groq",icon:"âš¡",needsApiKey:!0,needsBaseUrl:!1,defaultModel:"llama-3.1-8b-instant",models:["llama-3.1-8b-instant","llama-3.1-70b-versatile","mixtral-8x7b-32768"],docsUrl:"https://console.groq.com/keys"},doubao:{name:"è±†åŒ…",icon:"ğŸ«˜",needsApiKey:!0,needsBaseUrl:!1,defaultModel:"doubao-lite-4k",models:["doubao-lite-4k","doubao-pro-4k"],docsUrl:"https://console.volcengine.com/ark"},ollama:{name:"Ollama",icon:"ğŸ¦™",local:!0,needsApiKey:!1,needsBaseUrl:!0,defaultModel:"llama3.2",models:["llama3.2","llama3.1","mistral","qwen2.5"],defaultBaseUrl:"http://localhost:11434",docsUrl:"https://ollama.com/"},custom:{name:"è‡ªå®šä¹‰",icon:"âš™ï¸",needsApiKey:!0,needsBaseUrl:!0,defaultModel:"",models:[],defaultBaseUrl:""}},$r={name:"AISettings",components:{AIBatchWizard:Cr},data(){return{providers:$e,config:{provider:"deepseek",apiKey:"",baseUrl:"",model:"deepseek-chat",autoGenerate:!1,hasApiKey:!1},modelSelect:"deepseek-chat",showApiKey:!1,testing:!1,saving:!1,refreshing:!1,starting:!1,stopping:!1,connectionTested:!1,connectionOk:!1,stats:null,task:{running:!1,type:"",mode:"",current:0,total:0,currentCard:"",startTime:0,errors:[],successCount:0,failCount:0},eventSource:null,toast:{show:!1,msg:"",type:"info"},showWizard:!1}},computed:{currentProvider(){return $e[this.config.provider]||$e.deepseek},canTest(){return!(this.currentProvider.needsApiKey&&!this.config.apiKey&&!this.config.hasApiKey||this.currentProvider.needsBaseUrl&&!this.config.baseUrl)},connectionStatus(){return!this.config.hasApiKey&&!this.config.apiKey?"none":this.connectionTested?this.connectionOk?"ok":"err":"pending"},statusText(){return{none:"æœªé…ç½®",ok:"å·²è¿æ¥",err:"è¿æ¥å¤±è´¥",pending:"å¾…æµ‹è¯•"}[this.connectionStatus]},totalMissing(){return this.stats?this.stats.emptyName+this.stats.emptyDesc+this.stats.emptyTags:0},taskPercent(){return this.task.total?Math.round(this.task.current/this.task.total*100):0},taskTitle(){const d={name:"åç§°",description:"æè¿°",tags:"æ ‡ç­¾"},s=this.task.types||[this.task.type];return Array.isArray(s)&&s.length>0?`æ­£åœ¨ç”Ÿæˆ${s.map(i=>d[i]||i).join("ã€")}`:"æ­£åœ¨ç”Ÿæˆå†…å®¹"},taskEta(){if(!this.task.startTime||this.task.current<2)return"";const s=(Date.now()-this.task.startTime)/this.task.current,i=(this.task.total-this.task.current)*s;return i<6e4?`${Math.round(i/1e3)}ç§’`:`${Math.round(i/6e4)}åˆ†é’Ÿ`},actionItems(){var d,s,i;return[{type:"name",label:"åç§°",icon:"ğŸ“",emptyCount:((d=this.stats)==null?void 0:d.emptyName)||0},{type:"description",label:"æè¿°",icon:"ğŸ“„",emptyCount:((s=this.stats)==null?void 0:s.emptyDesc)||0},{type:"tags",label:"æ ‡ç­¾",icon:"ğŸ·ï¸",emptyCount:((i=this.stats)==null?void 0:i.emptyTags)||0}]}},mounted(){return A(this,null,function*(){yield this.loadConfig(),yield this.refreshStats(),yield this.initRealtimeUpdates()})},beforeUnmount(){this.closeEventSource()},methods:{selectProvider(d){var s;this.config.provider=d,this.config.model=this.currentProvider.defaultModel,this.modelSelect=(s=this.currentProvider.models)!=null&&s.includes(this.config.model)?this.config.model:"",this.config.baseUrl=this.currentProvider.defaultBaseUrl||"",this.config.apiKey="",this.config.hasApiKey=!1,this.connectionTested=!1},onModelChange(){this.modelSelect&&(this.config.model=this.modelSelect)},loadConfig(){return A(this,null,function*(){var d;try{const{data:s}=yield de.get("/api/ai/config");if(s.success){const i=s.config;this.config.provider=i.provider||"deepseek",this.config.hasApiKey=i.hasApiKey,this.config.baseUrl=i.baseUrl||"",this.config.model=i.model||this.currentProvider.defaultModel,this.modelSelect=(d=this.currentProvider.models)!=null&&d.includes(this.config.model)?this.config.model:"",this.config.autoGenerate=i.autoGenerate||!1}}catch(s){}})},saveConfig(){return A(this,null,function*(){var d,s;this.saving=!0;try{const{data:i}=yield de.post("/api/ai/config",{provider:this.config.provider,apiKey:this.config.apiKey||void 0,baseUrl:this.config.baseUrl||this.currentProvider.defaultBaseUrl,model:this.config.model,autoGenerate:this.config.autoGenerate});i.success?(this.showToast("é…ç½®å·²ä¿å­˜","success"),this.config.hasApiKey=!0,this.config.apiKey="",this.testConnection()):this.showToast(i.message,"error")}catch(i){this.showToast(((s=(d=i.response)==null?void 0:d.data)==null?void 0:s.message)||"ä¿å­˜å¤±è´¥","error")}this.saving=!1})},testConnection(){return A(this,null,function*(){this.testing=!0;try{const{data:d}=yield de.post("/api/ai/test");this.connectionTested=!0,this.connectionOk=d.success,this.showToast(d.success?"è¿æ¥æˆåŠŸ":d.message,d.success?"success":"error")}catch(d){this.connectionTested=!0,this.connectionOk=!1,this.showToast("è¿æ¥å¤±è´¥","error")}this.testing=!1})},refreshStats(){return A(this,null,function*(){this.refreshing=!0;try{const{data:d}=yield de.get("/api/ai/stats");d.success&&(this.stats=d.stats)}catch(d){console.error("Failed to refresh stats:",d)}this.refreshing=!1})},initRealtimeUpdates(){return A(this,null,function*(){this.closeEventSource();const d=localStorage.getItem("token"),s=`/api/ai/batch-task/stream${d?"?token="+encodeURIComponent(d):""}`;this.eventSource=new EventSource(s),this.eventSource.onmessage=i=>{try{const U=JSON.parse(i.data);this.updateTaskState(U)}catch(U){console.error("Failed to parse SSE data:",U)}},this.eventSource.onerror=i=>{console.warn("SSE connection error, falling back to polling...",i),this.closeEventSource()}})},closeEventSource(){this.eventSource&&(this.eventSource.close(),this.eventSource=null)},updateTaskState(d){if(d){if(this.task.running&&!d.running){this.task.current=this.task.total,this.task.total>0&&this.showToast(`ä»»åŠ¡ç»“æŸï¼æˆåŠŸ ${d.successCount||0}ï¼Œå¤±è´¥ ${d.failCount||0}`,d.failCount>0?"info":"success"),setTimeout(()=>{this.task.running=!1,this.refreshStats()},1500);return}d.running?this.task=re(le({},this.task),{running:!0,types:d.types||[],current:d.current||0,total:d.total||0,successCount:d.successCount||0,failCount:d.failCount||0,currentCard:d.currentCard||"",errors:d.errors||[],concurrency:d.concurrency,isRateLimited:d.isRateLimited,startTime:d.startTime||this.task.startTime||Date.now()}):this.task.running||Object.assign(this.task,re(le({},d),{running:!1}))}},startTask(d,s){return A(this,null,function*(){var i,U;if(!(this.starting||this.task.running)&&!(s==="all"&&!confirm(`ç¡®å®šè¦é‡æ–°ç”Ÿæˆæ‰€æœ‰å¡ç‰‡çš„${d==="name"?"åç§°":d==="description"?"æè¿°":"æ ‡ç­¾"}å—ï¼Ÿ`))){this.starting=!0;try{this.task={running:!0,type:d,mode:s,current:0,total:0,successCount:0,failCount:0,currentCard:"å‡†å¤‡ä¸­...",startTime:Date.now(),errors:[],types:d==="all"?["name","description","tags"]:[d]};const{data:t}=yield de.post("/api/ai/batch-task/start",{type:d,mode:s});if(!t.success){this.showToast(t.message||"å¯åŠ¨å¤±è´¥","error"),this.task.running=!1;return}if(t.total===0){this.showToast("æ²¡æœ‰éœ€è¦å¤„ç†çš„å¡ç‰‡","info"),this.task.running=!1;return}this.task.total=t.total,this.showToast(`ä»»åŠ¡å·²å¯åŠ¨ï¼Œæ­£åœ¨å¤„ç† ${t.total} ä¸ªå¡ç‰‡`,"success"),this.initRealtimeUpdates()}catch(t){this.showToast(((U=(i=t.response)==null?void 0:i.data)==null?void 0:U.message)||"å¯åŠ¨å¤±è´¥","error"),this.task.running=!1}finally{this.starting=!1}}})},stopTask(){return A(this,null,function*(){this.stopping=!0;try{yield de.post("/api/ai/batch-task/stop"),this.showToast("æ­£åœ¨åœæ­¢...","info")}catch(d){}setTimeout(()=>{this.stopping=!1},2e3)})},showToast(d,s="info"){this.toast={show:!0,msg:d,type:s},setTimeout(()=>{this.toast.show=!1},3e3)},onWizardClose(){this.showWizard=!1,this.refreshStats(),this.initRealtimeUpdates()}}},Mr={class:"ai-settings"},xr={class:"page-header"},Ur={key:0,class:"quick-start"},Sr={class:"section"},Vr={class:"provider-grid"},Ar=["onClick"],Tr={class:"provider-icon"},Br={class:"provider-info"},Ir={class:"provider-name"},Dr={key:0,class:"provider-tag"},Pr={key:1,class:"provider-tag local"},Lr={class:"section"},Kr={class:"section-header"},Er=["href"],Wr={class:"config-form"},zr={key:0,class:"form-item"},Rr={class:"input-group"},Nr=["type","placeholder"],Fr={key:1,class:"form-item"},Or=["placeholder"],Hr={class:"form-item"},qr={class:"model-select"},jr=["value"],Gr=["placeholder"],Jr={class:"form-item switch-item"},Qr={class:"switch"},Xr={class:"form-actions"},Yr=["disabled"],Zr=["disabled"],ed={class:"section"},sd={class:"section-header"},td=["disabled"],ld={key:0,class:"stats"},nd={class:"stat"},od={key:1,class:"task-panel"},ad={class:"task-header"},id={class:"task-title"},rd={class:"task-counts"},dd={class:"count-item success"},ud={key:0,class:"count-item fail"},cd={class:"count-item total"},vd={class:"progress-wrap"},pd={class:"progress-bar"},md={class:"progress-text"},fd={class:"task-info"},gd=["title"],hd={key:1,class:"task-eta"},bd={key:0,class:"task-errors"},kd={class:"error-list"},yd={class:"err-title"},wd={class:"err-msg"},_d={class:"task-actions"},Cd={key:0,class:"task-concurrency"},$d={key:0,class:"rate-limit-tag"},Md=["disabled"],xd={key:2,class:"batch-actions"},Ud=["disabled"],Sd={class:"quick-actions"},Vd=["disabled"],Ad={class:"action-grid"},Td={class:"action-header"},Bd={class:"action-btns"},Id=["onClick","disabled"],Dd=["onClick","disabled"];function Pd(d,s,i,U,t,f){const P=qe("AIBatchWizard");return o(),a("div",Mr,[e("div",xr,[s[14]||(s[14]=e("h2",null,"ğŸ¤– AI æ™ºèƒ½ç”Ÿæˆ",-1)),e("div",{class:z(["connection-status",f.connectionStatus])},[s[13]||(s[13]=e("span",{class:"status-dot"},null,-1)),e("span",null,r(f.statusText),1)],2)]),!t.config.hasApiKey&&!t.config.apiKey?(o(),a("div",Ur,[...s[15]||(s[15]=[ie('<div class="quick-start-icon" data-v-2eee7aab>ğŸš€</div><div class="quick-start-content" data-v-2eee7aab><h4 data-v-2eee7aab>å¿«é€Ÿå¼€å§‹</h4><p data-v-2eee7aab>é…ç½® AI æœåŠ¡åï¼Œå¯è‡ªåŠ¨ä¸ºå¡ç‰‡ç”Ÿæˆåç§°ã€æè¿°å’Œæ ‡ç­¾</p><div class="quick-start-steps" data-v-2eee7aab><span class="step" data-v-2eee7aab>1. é€‰æ‹©æä¾›å•†</span><span class="step" data-v-2eee7aab>2. å¡«å†™ API Key</span><span class="step" data-v-2eee7aab>3. æµ‹è¯•è¿æ¥</span></div></div>',2)])])):B("",!0),e("div",Sr,[s[16]||(s[16]=e("div",{class:"section-header"},[e("h3",null,"é€‰æ‹© AI æä¾›å•†"),e("span",{class:"section-hint"},"æ¨èä½¿ç”¨ DeepSeekï¼Œæ€§ä»·æ¯”é«˜")],-1)),e("div",Vr,[(o(!0),a(N,null,F(t.providers,(n,u)=>(o(),a("div",{key:u,class:z(["provider-card",{active:t.config.provider===u}]),onClick:h=>f.selectProvider(u)},[e("div",Tr,r(n.icon),1),e("div",Br,[e("span",Ir,r(n.name),1),n.recommended?(o(),a("span",Dr,"æ¨è")):B("",!0),n.local?(o(),a("span",Pr,"æœ¬åœ°")):B("",!0)])],10,Ar))),128))])]),e("div",Lr,[e("div",Kr,[s[17]||(s[17]=e("h3",null,"API é…ç½®",-1)),f.currentProvider.docsUrl?(o(),a("a",{key:0,href:f.currentProvider.docsUrl,target:"_blank",class:"docs-link"}," ğŸ“– è·å– API Key ",8,Er)):B("",!0)]),e("div",Wr,[f.currentProvider.needsApiKey?(o(),a("div",zr,[e("label",null,[s[18]||(s[18]=e("span",null,"API Key",-1)),e("span",{class:z(["label-status",{ok:t.config.hasApiKey}])},r(t.config.hasApiKey?"âœ“ å·²é…ç½®":"æœªé…ç½®"),3)]),e("div",Rr,[C(e("input",{type:t.showApiKey?"text":"password","onUpdate:modelValue":s[0]||(s[0]=n=>t.config.apiKey=n),placeholder:t.config.hasApiKey?"å·²é…ç½®ï¼ˆç•™ç©ºä¿æŒä¸å˜ï¼‰":"è¯·è¾“å…¥ API Key",class:"input"},null,8,Nr),[[Ke,t.config.apiKey]]),e("button",{type:"button",class:"input-btn",onClick:s[1]||(s[1]=n=>t.showApiKey=!t.showApiKey)},r(t.showApiKey?"ğŸ™ˆ":"ğŸ‘ï¸"),1)])])):B("",!0),f.currentProvider.needsBaseUrl?(o(),a("div",Fr,[s[19]||(s[19]=e("label",null,"Base URL",-1)),C(e("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=n=>t.config.baseUrl=n),placeholder:f.currentProvider.defaultBaseUrl,class:"input"},null,8,Or),[[K,t.config.baseUrl]])])):B("",!0),e("div",Hr,[s[21]||(s[21]=e("label",null,"æ¨¡å‹",-1)),e("div",qr,[C(e("select",{"onUpdate:modelValue":s[3]||(s[3]=n=>t.modelSelect=n),class:"input",onChange:s[4]||(s[4]=(...n)=>f.onModelChange&&f.onModelChange(...n))},[s[20]||(s[20]=e("option",{value:""},"è‡ªå®šä¹‰æ¨¡å‹",-1)),(o(!0),a(N,null,F(f.currentProvider.models,n=>(o(),a("option",{key:n,value:n},r(n),9,jr))),128))],544),[[ae,t.modelSelect]]),t.modelSelect===""?C((o(),a("input",{key:0,type:"text","onUpdate:modelValue":s[5]||(s[5]=n=>t.config.model=n),placeholder:f.currentProvider.defaultModel||"è¾“å…¥æ¨¡å‹åç§°",class:"input"},null,8,Gr)),[[K,t.config.model]]):B("",!0)])]),e("div",Jr,[s[23]||(s[23]=e("span",null,[e("strong",null,"è‡ªåŠ¨ç”Ÿæˆ"),e("small",null,"æ·»åŠ å¡ç‰‡æ—¶è‡ªåŠ¨ç”Ÿæˆåç§°ã€æè¿°å’Œæ ‡ç­¾")],-1)),e("label",Qr,[C(e("input",{type:"checkbox","onUpdate:modelValue":s[6]||(s[6]=n=>t.config.autoGenerate=n)},null,512),[[G,t.config.autoGenerate]]),s[22]||(s[22]=e("span",{class:"slider"},null,-1))])]),e("div",Xr,[e("button",{class:"btn",onClick:s[7]||(s[7]=(...n)=>f.testConnection&&f.testConnection(...n)),disabled:t.testing||!f.canTest},r(t.testing?"â³ æµ‹è¯•ä¸­...":"ğŸ”— æµ‹è¯•è¿æ¥"),9,Yr),e("button",{class:"btn primary",onClick:s[8]||(s[8]=(...n)=>f.saveConfig&&f.saveConfig(...n)),disabled:t.saving},r(t.saving?"â³ ä¿å­˜ä¸­...":"ğŸ’¾ ä¿å­˜é…ç½®"),9,Zr)])])]),e("div",ed,[e("div",sd,[s[24]||(s[24]=e("h3",null,"æ‰¹é‡ç”Ÿæˆ",-1)),e("button",{class:"icon-btn",onClick:s[9]||(s[9]=(...n)=>f.refreshStats&&f.refreshStats(...n)),disabled:t.refreshing},r(t.refreshing?"â³":"ğŸ”„"),9,td)]),t.stats?(o(),a("div",ld,[e("div",nd,[e("span",null,r(t.stats.total),1),s[25]||(s[25]=W("æ€»æ•°",-1))]),e("div",{class:z(["stat",{warn:t.stats.emptyName}])},[e("span",null,r(t.stats.emptyName),1),s[26]||(s[26]=W("ç¼ºåç§°",-1))],2),e("div",{class:z(["stat",{warn:t.stats.emptyDesc}])},[e("span",null,r(t.stats.emptyDesc),1),s[27]||(s[27]=W("ç¼ºæè¿°",-1))],2),e("div",{class:z(["stat",{warn:t.stats.emptyTags}])},[e("span",null,r(t.stats.emptyTags),1),s[28]||(s[28]=W("ç¼ºæ ‡ç­¾",-1))],2)])):B("",!0),t.task.running?(o(),a("div",od,[e("div",ad,[e("span",id,r(f.taskTitle),1),e("div",rd,[e("span",dd,"æˆåŠŸ: "+r(t.task.successCount||0),1),t.task.failCount?(o(),a("span",ud,"å¤±è´¥: "+r(t.task.failCount),1)):B("",!0),e("span",cd,r(t.task.current)+" / "+r(t.task.total),1)])]),e("div",vd,[e("div",pd,[e("div",{class:"progress-fill",style:pe({width:f.taskPercent+"%"})},null,4)]),e("span",md,r(f.taskPercent)+"%",1)]),e("div",fd,[t.task.currentCard?(o(),a("span",{key:0,class:"task-current",title:t.task.currentCard},"æ­£åœ¨å¤„ç†: "+r(t.task.currentCard),9,gd)):B("",!0),f.taskEta?(o(),a("span",hd,"å‰©ä½™çº¦ "+r(f.taskEta),1)):B("",!0)]),t.task.errors&&t.task.errors.length>0?(o(),a("div",bd,[s[29]||(s[29]=e("div",{class:"error-header"},"æœ€è¿‘é”™è¯¯:",-1)),e("div",kd,[(o(!0),a(N,null,F(t.task.errors.slice(-3),(n,u)=>(o(),a("div",{key:u,class:"error-item"},[e("span",yd,r(n.cardTitle)+":",1),e("span",wd,r(n.error),1)]))),128))])])):B("",!0),e("div",_d,[t.task.concurrency?(o(),a("div",Cd,[W(" å¹¶å‘æ•°: "+r(t.task.concurrency)+" ",1),t.task.isRateLimited?(o(),a("span",$d,"é™æµä¸­")):B("",!0)])):B("",!0),e("button",{class:"btn danger sm",onClick:s[10]||(s[10]=(...n)=>f.stopTask&&f.stopTask(...n)),disabled:t.stopping},r(t.stopping?"åœæ­¢ä¸­...":"â¹ï¸ åœæ­¢ä»»åŠ¡"),9,Md)])])):(o(),a("div",xd,[e("button",{class:"btn primary lg wizard-btn",onClick:s[11]||(s[11]=n=>t.showWizard=!0),disabled:!t.config.hasApiKey}," ğŸ¯ é«˜çº§æ‰¹é‡ç”Ÿæˆå‘å¯¼ ",8,Ud),e("div",Sd,[s[30]||(s[30]=e("span",{class:"quick-label"},"å¿«æ·æ“ä½œï¼š",-1)),f.totalMissing>0?(o(),a("button",{key:0,class:"btn",onClick:s[12]||(s[12]=n=>f.startTask("all","empty")),disabled:!t.config.hasApiKey||t.starting}," âœ¨ ä¸€é”®è¡¥å…¨ ("+r(f.totalMissing)+") ",9,Vd)):B("",!0)]),e("div",Ad,[(o(!0),a(N,null,F(f.actionItems,n=>{var u;return o(),a("div",{class:"action-card",key:n.type},[e("div",Td,[e("span",null,r(n.icon)+" "+r(n.label),1)]),e("div",Bd,[e("button",{class:"btn sm",onClick:h=>f.startTask(n.type,"empty"),disabled:!n.emptyCount||!t.config.hasApiKey||t.starting}," è¡¥å…… ("+r(n.emptyCount)+") ",9,Id),e("button",{class:"btn sm outline",onClick:h=>f.startTask(n.type,"all"),disabled:!((u=t.stats)!=null&&u.total)||!t.config.hasApiKey||t.starting}," å…¨éƒ¨é‡ç”Ÿæˆ ",8,Dd)])])}),128))])]))]),Le(P,{visible:t.showWizard,onClose:f.onWizardClose},null,8,["visible","onClose"]),e("div",{class:z(["toast",[t.toast.type,{show:t.toast.show}]])},r(t.toast.msg),3)])}const Ld=X($r,[["render",Pd],["__scopeId","data-v-2eee7aab"]]),Kd={key:0,class:"login-container"},Ed={class:"login-card"},Wd={class:"login-form"},zd={class:"password-input-wrapper"},Rd=["type"],Nd={key:0,width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},Fd={key:1,width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},Od={class:"login-buttons"},Hd=["disabled"],qd={key:0,class:"login-error"},jd={key:1,class:"admin-layout"},Gd={class:"menu-list"},Jd={class:"admin-main"},Qd={class:"admin-header"},Xd={class:"header-title"},Yd={class:"admin-content"},Pe=1800*1e3,Zd={__name:"Admin",setup(d){const s=$("welcome");let i=null,U=Date.now();function t(){U=Date.now(),localStorage.setItem("lastActivityTime",U.toString()),i&&clearTimeout(i),c.value&&(i=setTimeout(()=>{f()},Pe))}function f(){c.value&&(alert("ç”±äºé•¿æ—¶é—´æœªæ“ä½œï¼Œå·²è‡ªåŠ¨é€€å‡ºç™»å½•"),R())}function P(){const D=localStorage.getItem("lastActivityTime");return D&&Date.now()-parseInt(D)>=Pe?(localStorage.removeItem("token"),localStorage.removeItem("lastActivityTime"),!0):!1}const n=["mousedown","mousemove","keydown","scroll","touchstart","click"];function u(){n.forEach(D=>{document.addEventListener(D,t,{passive:!0})})}function h(){n.forEach(D=>{document.removeEventListener(D,t)})}je(()=>{i&&clearTimeout(i),h()});const _={welcome:Is,menu:xt,card:vl,duplicate:Jl,tag:mn,promo:Hn,friend:so,user:yo,backup:wi,ai:Ld},k=ce(()=>_[s.value]),S=ce(()=>s.value==="welcome"?{lastLoginTime:b.value,lastLoginIp:p.value,currentUsername:m.value}:{}),b=$(""),p=$(""),m=$("admin"),c=$(!1),T=$(""),x=$(""),V=$(!1),H=$(""),Q=$(!1),Z=$(!1),ee=ce(()=>{switch(s.value){case"menu":return"æ ç›®ç®¡ç†";case"card":return"å¡ç‰‡ç®¡ç†";case"duplicate":return"å»é‡ç®¡ç†";case"tag":return"æ ‡ç­¾ç®¡ç†";case"promo":return"å®£ä¼ ç®¡ç†";case"friend":return"å‹é“¾ç®¡ç†";case"user":return"ç”¨æˆ·ç®¡ç†";case"backup":return"å¤‡ä»½ç®¡ç†";case"ai":return"AI è®¾ç½®";default:return""}});ne(()=>A(null,null,function*(){if(P()){c.value=!1;return}localStorage.getItem("token")?(c.value=!0,yield te(),c.value&&(t(),u())):c.value=!1}));function te(){return A(this,null,function*(){try{const D=yield fetch("/api/users/me",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(D.ok){const g=yield D.json();b.value=g.last_login_time||"",p.value=g.last_login_ip||"",m.value=g.username||"admin"}else D.status===401&&(console.warn("TokenéªŒè¯å¤±è´¥ï¼Œè‡ªåŠ¨é€€å‡ºç™»å½•"),R())}catch(D){console.error("è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:",D)}})}function se(){return A(this,null,function*(){var D,g;if(!T.value||!x.value){H.value="è¯·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ";return}V.value=!0,H.value="";try{const v=yield $s(T.value,x.value);v.data.token&&(localStorage.setItem("token",v.data.token),c.value=!0,b.value=v.data.lastLoginTime||"",p.value=v.data.lastLoginIp||"",yield te(),t(),u())}catch(v){H.value=((g=(D=v.response)==null?void 0:D.data)==null?void 0:g.message)||"ç™»å½•å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç”¨æˆ·åå’Œå¯†ç "}finally{V.value=!1}})}function R(){i&&(clearTimeout(i),i=null),h(),localStorage.removeItem("token"),localStorage.removeItem("lastActivityTime"),c.value=!1,T.value="",x.value="",H.value=""}function E(){window.open("/","_blank")}function w(){Z.value=!Z.value}function I(){Z.value=!1}return(D,g)=>c.value?(o(),a("div",jd,[e("aside",{class:z(["admin-sider",{open:Z.value}]),onClick:we(I,["self"])},[e("div",{class:"logo clickable",onClick:g[3]||(g[3]=v=>{s.value="welcome",I()})},"Admin"),e("ul",Gd,[e("li",{class:z({active:s.value==="menu"}),onClick:g[4]||(g[4]=v=>{s.value="menu",I()})},"æ ç›®ç®¡ç†",2),e("li",{class:z({active:s.value==="card"}),onClick:g[5]||(g[5]=v=>{s.value="card",I()})},"å¡ç‰‡ç®¡ç†",2),e("li",{class:z({active:s.value==="duplicate"}),onClick:g[6]||(g[6]=v=>{s.value="duplicate",I()})},"å»é‡ç®¡ç†",2),e("li",{class:z({active:s.value==="tag"}),onClick:g[7]||(g[7]=v=>{s.value="tag",I()})},"æ ‡ç­¾ç®¡ç†",2),e("li",{class:z({active:s.value==="promo"}),onClick:g[8]||(g[8]=v=>{s.value="promo",I()})},"å®£ä¼ ç®¡ç†",2),e("li",{class:z({active:s.value==="friend"}),onClick:g[9]||(g[9]=v=>{s.value="friend",I()})},"å‹é“¾ç®¡ç†",2),e("li",{class:z({active:s.value==="user"}),onClick:g[10]||(g[10]=v=>{s.value="user",I()})},"ç”¨æˆ·ç®¡ç†",2),e("li",{class:z({active:s.value==="backup"}),onClick:g[11]||(g[11]=v=>{s.value="backup",I()})},"å¤‡ä»½ç®¡ç†",2),e("li",{class:z({active:s.value==="ai"}),onClick:g[12]||(g[12]=v=>{s.value="ai",I()})},"AI è®¾ç½®",2)])],2),e("main",Jd,[e("div",Qd,[e("button",{class:"menu-toggle",onClick:w}," â˜° "),e("div",Xd,r(ee.value),1),e("div",{class:"header-actions"},[e("span",{class:"home-icon",onClick:E,title:"è¿›å…¥ä¸»é¡µ"},[...g[17]||(g[17]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},[e("path",{d:"M3 10.5L12 4l9 6.5V20a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1v-4h-4v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V10.5z",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])]),e("button",{class:"btn logout-btn",onClick:R},"é€€å‡ºç™»å½•")])]),e("div",Yd,[Le(Je,{name:"fade",mode:"out-in"},{default:Ge(()=>[(o(),Qe(Xe(k.value),Ye({key:s.value},S.value),null,16))]),_:1})]),g[18]||(g[18]=e("footer",{class:"admin-footer"},[e("p",{class:"admin-copyright"},[W("Copyright Â© 2025 Con-Nav-Item | "),e("a",{href:"https://github.com/zczy-k/Con-Nav-Item",target:"_blank",class:"footer-link"},"Powered by zczy-k")])],-1))])])):(o(),a("div",Kd,[e("div",Ed,[g[16]||(g[16]=e("h2",{class:"login-title"},"åå°ç®¡ç†ç™»å½•",-1)),e("div",Wd,[C(e("input",{"onUpdate:modelValue":g[0]||(g[0]=v=>T.value=v),type:"text",placeholder:"ç”¨æˆ·åï¼ˆé»˜è®¤ï¼šadminï¼‰",class:"login-input",onKeyup:Me(se,["enter"])},null,544),[[K,T.value]]),e("div",zd,[C(e("input",{"onUpdate:modelValue":g[1]||(g[1]=v=>x.value=v),type:Q.value?"text":"password",placeholder:"å¯†ç ï¼ˆé»˜è®¤ï¼š123456ï¼‰",class:"login-input password-input",onKeyup:Me(se,["enter"])},null,40,Rd),[[Ke,x.value]]),e("span",{class:"toggle-password",onClick:g[2]||(g[2]=v=>Q.value=!Q.value)},[Q.value?(o(),a("svg",Nd,[...g[13]||(g[13]=[e("path",{d:"M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12z"},null,-1),e("circle",{cx:"12",cy:"12",r:"3"},null,-1)])])):(o(),a("svg",Fd,[...g[14]||(g[14]=[e("path",{d:"M17.94 17.94A10.94 10.94 0 0 1 12 19c-7 0-11-7-11-7a21.77 21.77 0 0 1 5.06-6.06"},null,-1),e("path",{d:"M1 1l22 22"},null,-1),e("path",{d:"M9.53 9.53A3 3 0 0 0 12 15a3 3 0 0 0 2.47-5.47"},null,-1)])]))])]),e("div",Od,[e("button",{onClick:E,class:"back-btn"},[...g[15]||(g[15]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1),W(" è¿”å›é¦–é¡µ ",-1)])]),e("button",{onClick:se,class:"login-btn",disabled:V.value},r(V.value?"ç™»å½•ä¸­...":"ç™»å½•"),9,Hd)]),H.value?(o(),a("p",qd,r(H.value),1)):B("",!0)])])]))}},lu=X(Zd,[["__scopeId","data-v-52d75759"]]);export{lu as default};
